# 前端开发规范文档

## 文档信息
- **文档版本**：v1.0
- **创建日期**：2025-10-24
- **适用项目**：知识星球训练营自动押金退款系统
- **技术栈**：Vue 3 + Vite + Vant/Element Plus

---

## 一、项目结构规范

### H5会员端目录结构

```
frontend/h5-member/
├── public/                     # 静态资源
│   └── favicon.ico
├── src/
│   ├── api/                    # API接口定义
│   │   ├── camp.js            # 训练营相关接口
│   │   ├── payment.js         # 支付相关接口
│   │   └── checkin.js         # 打卡相关接口
│   ├── assets/                 # 资源文件
│   │   ├── images/            # 图片
│   │   └── styles/            # 全局样式
│   │       ├── reset.css      # 样式重置
│   │       └── common.css     # 公共样式
│   ├── components/             # 公共组件
│   │   ├── Header.vue         # 页面头部
│   │   └── Loading.vue        # 加载组件
│   ├── composables/            # 组合式函数
│   │   ├── useAuth.js         # 认证相关
│   │   └── useRequest.js      # 请求相关
│   ├── router/                 # 路由配置
│   │   └── index.js
│   ├── store/                  # Pinia状态管理
│   │   ├── index.js           # store入口
│   │   └── modules/           # 模块化store
│   │       └── user.js
│   ├── utils/                  # 工具函数
│   │   ├── request.js         # Axios封装
│   │   ├── validate.js        # 表单验证
│   │   └── format.js          # 格式化工具
│   ├── views/                  # 页面组件
│   │   ├── camp/              # 训练营模块
│   │   │   ├── List.vue       # 列表页
│   │   │   └── Detail.vue     # 详情页
│   │   ├── checkin/           # 打卡模块
│   │   │   └── Progress.vue   # 进度查询
│   │   └── home/              # 首页
│   │       └── Index.vue
│   ├── App.vue                 # 根组件
│   └── main.js                 # 入口文件
├── .env.development            # 开发环境配置
├── .env.production             # 生产环境配置
├── .eslintrc.js                # ESLint配置
├── .prettierrc.js              # Prettier配置
├── index.html
├── package.json
└── vite.config.js              # Vite配置
```

### Web管理后台目录结构

```
frontend/admin-web/
├── src/
│   ├── api/                    # API接口定义
│   │   ├── camp.js
│   │   ├── member.js
│   │   ├── refund.js
│   │   └── system.js
│   ├── components/             # 公共组件
│   │   ├── Layout/            # 布局组件
│   │   │   ├── Sidebar.vue
│   │   │   └── Header.vue
│   │   └── Chart/             # 图表组件
│   │       └── LineChart.vue
│   ├── router/                 # 路由配置
│   │   └── index.js
│   ├── store/                  # Pinia状态管理
│   │   └── modules/
│   │       ├── user.js
│   │       └── app.js
│   ├── utils/                  # 工具函数
│   │   ├── request.js
│   │   └── permission.js
│   ├── views/                  # 页面组件
│   │   ├── camp/              # 训练营管理
│   │   │   ├── Index.vue      # 列表页
│   │   │   ├── Create.vue     # 创建页
│   │   │   └── Edit.vue       # 编辑页
│   │   ├── member/            # 会员管理
│   │   ├── refund/            # 退款管理
│   │   ├── system/            # 系统管理
│   │   └── login/             # 登录页
│   │       └── Index.vue
│   └── main.js
└── vite.config.js
```

---

## 二、命名规范

### 文件命名

**组件文件：PascalCase（大驼峰）**
```
CampList.vue         ✅ 推荐
campList.vue         ❌ 不推荐
camp-list.vue        ❌ 不推荐
```

**工具文件/API文件：kebab-case（短横线）**
```
src/utils/request.js        ✅
src/api/camp-service.js     ✅
src/utils/requestUtils.js   ❌
```

**页面文件：PascalCase**
```
views/camp/List.vue         ✅
views/camp/Detail.vue       ✅
views/camp/camp-list.vue    ❌
```

### 变量命名

**常量：UPPER_SNAKE_CASE（大写下划线）**
```javascript
const MAX_COUNT = 100
const API_BASE_URL = 'http://localhost:8080'
```

**变量和函数：camelCase（小驼峰）**
```javascript
const userName = 'admin'
const campList = []

function fetchCampList() {}
function handleSubmit() {}
```

**组件名：PascalCase**
```javascript
import CampList from './CampList.vue'
import UserHeader from './UserHeader.vue'
```

**事件处理函数：handle + 动作**
```javascript
function handleClick() {}
function handleSubmit() {}
function handleDelete() {}
```

---

## 三、Vue组件规范

### 单文件组件结构顺序

```vue
<script setup>
// 1. 导入依赖
import { ref, onMounted } from 'vue'
import { useRouter } from 'vue-router'

// 2. 定义Props（如果有）
const props = defineProps({
  campId: {
    type: Number,
    required: true
  }
})

// 3. 定义Emits（如果有）
const emit = defineEmits(['update', 'delete'])

// 4. 响应式数据
const loading = ref(false)
const list = ref([])

// 5. 计算属性
const filteredList = computed(() => {
  return list.value.filter(item => item.status === 'active')
})

// 6. 方法定义
async function fetchList() {
  // ...
}

// 7. 生命周期钩子
onMounted(() => {
  fetchList()
})
</script>

<template>
  <!-- 模板内容 -->
</template>

<style scoped>
/* 样式 */
</style>
```

### Props定义规范

```javascript
// ✅ 推荐：完整的Props定义
defineProps({
  campId: {
    type: Number,
    required: true
  },
  name: {
    type: String,
    default: ''
  },
  status: {
    type: String,
    default: 'pending',
    validator: (value) => ['pending', 'active', 'finished'].includes(value)
  }
})

// ❌ 不推荐：简写形式（仅用于快速原型）
defineProps(['campId', 'name'])
```

### 组件命名规范

**组件名必须是多个单词（避免与HTML标签冲突）**
```vue
<!-- ✅ 推荐 -->
<camp-list />
<user-header />

<!-- ❌ 不推荐 -->
<list />
<header />
```

**组件引用使用PascalCase或kebab-case**
```vue
<script setup>
import CampList from './CampList.vue'
</script>

<template>
  <!-- 两种写法都可以，推荐kebab-case -->
  <camp-list />
  <CampList />
</template>
```

---

## 四、JavaScript/TypeScript规范

### 变量声明

```javascript
// ✅ 推荐：优先使用const
const API_URL = '/api/camps'
const list = ref([])

// ✅ 需要重新赋值时使用let
let count = 0
count++

// ❌ 禁止：永远不要使用var
var name = 'admin'  // ❌
```

### 函数定义

```javascript
// ✅ 推荐：箭头函数（简洁）
const fetchData = async () => {
  const response = await api.getCamps()
  return response.data
}

// ✅ 推荐：async/await（可读性高）
async function loadCamps() {
  try {
    const data = await fetchData()
    camps.value = data
  } catch (error) {
    console.error(error)
  }
}

// ❌ 不推荐：Promise链式调用（不如async/await清晰）
function loadCamps() {
  fetchData()
    .then(data => {
      camps.value = data
    })
    .catch(error => {
      console.error(error)
    })
}
```

### 对象和数组操作

```javascript
// ✅ 推荐：使用展开运算符
const newUser = { ...user, age: 25 }
const newList = [...list, newItem]

// ✅ 推荐：解构赋值
const { id, name } = user
const [first, second] = list

// ❌ 不推荐：直接修改
user.age = 25  // 如果user是响应式对象，应该通过.value
```

---

## 五、CSS样式规范

### 样式组织

```vue
<style scoped>
/* 1. 布局相关 */
.container {
  display: flex;
  padding: 16px;
}

/* 2. 组件样式 */
.header {
  background: #fff;
  border-bottom: 1px solid #eee;
}

/* 3. 状态样式 */
.header.active {
  border-color: #1989fa;
}

/* 4. 响应式样式 */
@media (max-width: 768px) {
  .container {
    padding: 8px;
  }
}
</style>
```

### Class命名：BEM规范

```vue
<template>
  <!-- Block（块） -->
  <div class="camp-card">
    <!-- Element（元素） -->
    <div class="camp-card__header">
      <h3 class="camp-card__title">训练营名称</h3>
    </div>
    <div class="camp-card__body">
      <!-- Modifier（修饰符） -->
      <span class="camp-card__status camp-card__status--active">进行中</span>
    </div>
  </div>
</template>

<style scoped>
.camp-card { }
.camp-card__header { }
.camp-card__title { }
.camp-card__body { }
.camp-card__status { }
.camp-card__status--active { color: green; }
</style>
```

### 避免深层嵌套

```css
/* ❌ 不推荐：嵌套过深 */
.page .container .header .title .text {
  color: #333;
}

/* ✅ 推荐：扁平化 */
.page-header-text {
  color: #333;
}
```

---

## 六、API调用规范

### 统一封装Axios

**src/utils/request.js**
```javascript
import axios from 'axios'
import { showToast } from 'vant'
import router from '@/router'

const service = axios.create({
  baseURL: import.meta.env.VITE_API_BASE_URL,
  timeout: 10000
})

// 请求拦截器
service.interceptors.request.use(
  config => {
    const token = localStorage.getItem('token')
    if (token) {
      config.headers['Authorization'] = `Bearer ${token}`
    }
    return config
  },
  error => {
    return Promise.reject(error)
  }
)

// 响应拦截器
service.interceptors.response.use(
  response => {
    const res = response.data

    // 根据后端返回的统一格式处理
    if (res.code !== 200) {
      showToast(res.message || '请求失败')

      // Token过期，跳转登录
      if (res.code === 401) {
        router.push('/login')
      }

      return Promise.reject(new Error(res.message || 'Error'))
    }

    return res
  },
  error => {
    showToast(error.message || '网络错误')
    return Promise.reject(error)
  }
)

export default service
```

### API接口定义

**src/api/camp.js**
```javascript
import request from '@/utils/request'

/**
 * 获取训练营列表
 * @param {Object} params - 查询参数
 * @returns {Promise}
 */
export function getCampList(params) {
  return request({
    url: '/api/h5/camps',
    method: 'get',
    params
  })
}

/**
 * 获取训练营详情
 * @param {Number} id - 训练营ID
 * @returns {Promise}
 */
export function getCampDetail(id) {
  return request({
    url: `/api/h5/camps/${id}`,
    method: 'get'
  })
}

/**
 * 创建支付订单
 * @param {Object} data - 订单数据
 * @returns {Promise}
 */
export function createPayment(data) {
  return request({
    url: '/api/h5/payments',
    method: 'post',
    data
  })
}
```

### 组件中调用API

```vue
<script setup>
import { ref, onMounted } from 'vue'
import { getCampList } from '@/api/camp'
import { showToast } from 'vant'

const camps = ref([])
const loading = ref(false)

async function loadCamps() {
  try {
    loading.value = true
    const res = await getCampList()
    camps.value = res.data
  } catch (error) {
    showToast('加载失败')
    console.error(error)
  } finally {
    loading.value = false
  }
}

onMounted(() => {
  loadCamps()
})
</script>
```

---

## 七、状态管理规范（Pinia）

### Store定义

**src/store/modules/user.js**
```javascript
import { defineStore } from 'pinia'
import { ref, computed } from 'vue'

export const useUserStore = defineStore('user', () => {
  // 状态
  const token = ref(localStorage.getItem('token') || '')
  const userInfo = ref(null)

  // 计算属性
  const isLoggedIn = computed(() => !!token.value)

  // 方法
  function setToken(newToken) {
    token.value = newToken
    localStorage.setItem('token', newToken)
  }

  function setUserInfo(info) {
    userInfo.value = info
  }

  function logout() {
    token.value = ''
    userInfo.value = null
    localStorage.removeItem('token')
  }

  return {
    token,
    userInfo,
    isLoggedIn,
    setToken,
    setUserInfo,
    logout
  }
})
```

### 组件中使用Store

```vue
<script setup>
import { useUserStore } from '@/store/modules/user'

const userStore = useUserStore()

// 访问状态
console.log(userStore.token)
console.log(userStore.isLoggedIn)

// 调用方法
function handleLogout() {
  userStore.logout()
  router.push('/login')
}
</script>
```

---

## 八、路由规范

### 路由定义

**src/router/index.js**
```javascript
import { createRouter, createWebHistory } from 'vue-router'

const routes = [
  {
    path: '/',
    name: 'Home',
    component: () => import('@/views/home/Index.vue'),
    meta: {
      title: '首页',
      requiresAuth: false
    }
  },
  {
    path: '/camps',
    name: 'CampList',
    component: () => import('@/views/camp/List.vue'),
    meta: {
      title: '训练营列表',
      requiresAuth: false
    }
  },
  {
    path: '/camps/:id',
    name: 'CampDetail',
    component: () => import('@/views/camp/Detail.vue'),
    meta: {
      title: '训练营详情',
      requiresAuth: false
    }
  }
]

const router = createRouter({
  history: createWebHistory(),
  routes
})

// 路由守卫
router.beforeEach((to, from, next) => {
  // 设置页面标题
  document.title = to.meta.title || '训练营系统'

  // 权限验证
  if (to.meta.requiresAuth) {
    const token = localStorage.getItem('token')
    if (!token) {
      next('/login')
      return
    }
  }

  next()
})

export default router
```

### 路由跳转

```javascript
import { useRouter, useRoute } from 'vue-router'

const router = useRouter()
const route = useRoute()

// 编程式导航
router.push('/camps')
router.push({ name: 'CampDetail', params: { id: 1 } })
router.push({ path: '/camps', query: { status: 'active' } })

// 获取路由参数
const campId = route.params.id
const status = route.query.status
```

---

## 九、错误处理规范

### 异常捕获

```javascript
// ✅ 推荐：完整的错误处理
async function fetchData() {
  try {
    loading.value = true
    const res = await api.getCamps()
    camps.value = res.data
  } catch (error) {
    // 1. 用户友好的错误提示
    showToast('加载失败，请稍后重试')

    // 2. 开发环境输出详细错误
    if (import.meta.env.DEV) {
      console.error('API Error:', error)
    }

    // 3. 上报错误（生产环境）
    if (import.meta.env.PROD) {
      reportError(error)
    }
  } finally {
    loading.value = false
  }
}

// ❌ 不推荐：忽略错误
async function fetchData() {
  const res = await api.getCamps()  // 如果失败会直接报错
  camps.value = res.data
}
```

### 表单验证

```javascript
// 手动验证
function validateForm() {
  if (!form.value.name) {
    showToast('请输入姓名')
    return false
  }

  if (!form.value.phone) {
    showToast('请输入手机号')
    return false
  }

  if (!/^1[3-9]\d{9}$/.test(form.value.phone)) {
    showToast('手机号格式不正确')
    return false
  }

  return true
}

async function handleSubmit() {
  if (!validateForm()) {
    return
  }

  // 提交表单
  await submitForm()
}
```

---

## 十、性能优化规范

### 组件懒加载

```javascript
// ✅ 推荐：路由级别的代码分割
const routes = [
  {
    path: '/camps',
    component: () => import('@/views/camp/List.vue')  // 懒加载
  }
]

// ✅ 推荐：大组件懒加载
import { defineAsyncComponent } from 'vue'

const HeavyComponent = defineAsyncComponent(() =>
  import('./components/HeavyComponent.vue')
)
```

### 列表优化

```vue
<template>
  <!-- ✅ 推荐：使用虚拟列表（大数据量） -->
  <van-list
    v-model:loading="loading"
    :finished="finished"
    @load="onLoad"
  >
    <van-cell
      v-for="item in list"
      :key="item.id"
      :title="item.name"
    />
  </van-list>
</template>
```

### 避免不必要的响应式

```javascript
// ❌ 不推荐：大对象全部转为响应式
const bigData = reactive(hugeLargeObject)

// ✅ 推荐：只将需要响应式的部分转换
const displayData = ref(hugeLargeObject.slice(0, 20))
```

---

## 十一、代码注释规范

### 函数注释

```javascript
/**
 * 获取训练营列表
 * @param {Object} params - 查询参数
 * @param {String} params.status - 状态筛选
 * @param {Number} params.page - 页码
 * @returns {Promise<Object>} 返回训练营列表数据
 */
export async function getCampList(params) {
  return request.get('/api/camps', { params })
}
```

### 组件注释

```vue
<script setup>
/**
 * 训练营列表页面
 * 功能：
 * 1. 展示所有训练营
 * 2. 支持状态筛选
 * 3. 支持搜索
 */
import { ref } from 'vue'

// 响应式数据
const camps = ref([])  // 训练营列表
const loading = ref(false)  // 加载状态
</script>
```

### TODO注释

```javascript
// TODO: 优化加载性能（使用虚拟列表）
// FIXME: 修复在iOS上的样式问题
// HACK: 临时方案，等待后端API更新
```

---

## 十二、Git提交规范

### Commit Message格式

```
<type>(<scope>): <subject>

<body>

<footer>
```

**Type类型：**
- `feat`: 新功能
- `fix`: 修复Bug
- `docs`: 文档更新
- `style`: 代码格式调整（不影响功能）
- `refactor`: 重构
- `perf`: 性能优化
- `test`: 测试相关
- `chore`: 构建/工具链相关

**示例：**
```
feat(camp): 添加训练营详情页

- 实现详情页面布局
- 集成支付功能
- 添加表单验证

Closes #123
```

---

## 十三、代码审查清单

### 提交代码前检查

- [ ] 代码格式化（运行 `npm run lint`）
- [ ] 没有console.log（除了必要的日志）
- [ ] 没有debugger
- [ ] 变量命名规范
- [ ] 函数命名清晰
- [ ] 添加必要的注释
- [ ] 异常处理完整
- [ ] 响应式数据正确使用.value
- [ ] 组件Props定义完整
- [ ] API调用有错误处理
- [ ] 路由meta信息完整

---

## 附录：ESLint配置

**.eslintrc.js**
```javascript
module.exports = {
  root: true,
  env: {
    node: true,
    browser: true,
    es2021: true
  },
  extends: [
    'plugin:vue/vue3-recommended',
    'eslint:recommended',
    '@vue/prettier'
  ],
  parserOptions: {
    ecmaVersion: 2021
  },
  rules: {
    'vue/multi-word-component-names': 'off',
    'no-console': process.env.NODE_ENV === 'production' ? 'warn' : 'off',
    'no-debugger': process.env.NODE_ENV === 'production' ? 'warn' : 'off',
    'vue/no-v-html': 'off'
  }
}
```

**.prettierrc.js**
```javascript
module.exports = {
  semi: false,
  singleQuote: true,
  printWidth: 100,
  trailingComma: 'none',
  arrowParens: 'avoid'
}
```

---

**文档维护：** 本规范会随着项目开发不断完善，欢迎团队成员提出改进建议。

**参考资源：**
- Vue 3 风格指南：https://cn.vuejs.org/style-guide/
- Airbnb JavaScript 规范：https://github.com/airbnb/javascript
- BEM 命名规范：http://getbem.com/
