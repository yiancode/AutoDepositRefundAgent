---
description: 规划新任务，拆分为可执行步骤
---

# 任务规划

根据用户输入的任务描述，创建结构化的实施计划。

## 输入

```
/task-plan $ARGUMENTS
```

## 执行步骤

### 1. 分析任务

首先理解任务的：
- 核心目标是什么
- 涉及前端还是后端，还是全栈
- 预估复杂度（简单/中等/复杂）

### 2. 查阅现有代码

根据任务类型，读取相关参考文件：
- 后端功能 → 读 `zsxq-api/src/services/` 和 `zsxq-api/src/routes/`
- 前端功能 → 读 `zsxq-web/src/views/` 和 `zsxq-web/src/api/`
- 全栈功能 → 两边都读

### 3. 输出计划

按以下格式输出：

```markdown
## 任务：[任务名称]

**类型**：[前端/后端/全栈]
**复杂度**：[简单/中等/复杂]
**预估步骤**：[N] 步

---

### 步骤拆分

每步控制在 10-15 分钟可完成：

#### 1. [步骤名称]
- **目标**：具体要完成什么
- **涉及文件**：
  - `path/to/file1.js`
  - `path/to/file2.vue`
- **参考代码**：现有的 XXX 实现
- **验收标准**：如何验证这步完成了

#### 2. [步骤名称]
...

---

### 注意事项
- 需要先读的文件：[列出]
- 可能的风险点：[列出]
- 相关文档：[列出]

---

### 开始执行

确认计划无误后，说 "开始" 执行第一步。
```

## 示例

### 输入
```
/task-plan 实现批量导出退款名单为 Excel
```

### 输出
```markdown
## 任务：实现批量导出退款名单为 Excel

**类型**：全栈
**复杂度**：中等
**预估步骤**：5 步

---

### 步骤拆分

#### 1. 后端 - 安装 Excel 库
- **目标**：添加 xlsx 或 exceljs 依赖
- **涉及文件**：
  - `zsxq-api/package.json`
- **参考代码**：无（新功能）
- **验收标准**：`npm install` 成功，无报错

#### 2. 后端 - 实现 Excel 生成 service
- **目标**：创建 `export.service.js`，实现数据转 Excel
- **涉及文件**：
  - `zsxq-api/src/services/export.service.js`（新建）
  - `zsxq-api/src/__tests__/unit/export.service.unit.test.js`（新建）
- **参考代码**：`refund.service.js` 的结构
- **验收标准**：单元测试通过

#### 3. 后端 - 添加导出 API
- **目标**：在 camps 路由添加 `/export` 端点
- **涉及文件**：
  - `zsxq-api/src/routes/camps.js`
- **参考代码**：现有的 `/refund-list` 端点
- **验收标准**：curl 测试返回文件

#### 4. 前端 - 添加导出按钮
- **目标**：在退款列表页添加"导出 Excel"按钮
- **涉及文件**：
  - `zsxq-web/src/views/RefundList.vue`
  - `zsxq-web/src/api/camps.js`
- **参考代码**：现有的按钮样式
- **验收标准**：点击按钮能下载文件

#### 5. 联调测试
- **目标**：端到端测试完整流程
- **涉及文件**：无新文件
- **验收标准**：从界面操作到下载 Excel 全流程通过

---

### 注意事项
- 需要先读的文件：`refund.service.js`, `camps.js`, `RefundList.vue`
- 可能的风险点：大数据量时内存占用
- 相关文档：`docs/v0.2/混合方案技术设计.md`

---

### 开始执行

确认计划无误后，说 "开始" 执行第一步。
```

## 最佳实践

1. **粒度适中**：每步 10-15 分钟，太大要拆，太小可合并
2. **先后端后前端**：全栈任务建议先完成 API 再做界面
3. **测试同步**：每个 service 方法都要有对应测试
4. **及时保存**：每完成 2-3 步执行一次 `/progress-save`
