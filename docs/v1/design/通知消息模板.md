# é€šçŸ¥æ¶ˆæ¯æ¨¡æ¿å®šä¹‰

> **æ–‡æ¡£ç‰ˆæœ¬**: v1.0
> **åˆ›å»ºæ—¥æœŸ**: 2025-12-12
> **SSOTå¼•ç”¨**:
> - [çŠ¶æ€æšä¸¾å®šä¹‰.md](./çŠ¶æ€æšä¸¾å®šä¹‰.md) - çŠ¶æ€ç›¸å…³æ–‡æ¡ˆ
> - [æ•°æ®åº“è®¾è®¡.md](./æ•°æ®åº“è®¾è®¡.md) - notification_message è¡¨ç»“æ„

æœ¬æ–‡æ¡£å®šä¹‰ç³»ç»Ÿä¸­æ‰€æœ‰é€šçŸ¥æ¶ˆæ¯çš„æ¨¡æ¿ï¼ŒåŒ…æ‹¬å‘é€æ¸ é“ã€è§¦å‘æ—¶æœºã€æ¶ˆæ¯å†…å®¹å’Œå˜é‡è¯´æ˜ã€‚

---

## ä¸€ã€æ¶ˆæ¯ç±»å‹æ€»è§ˆ

| æ¶ˆæ¯ç±»å‹ | è¯´æ˜ | æ¥æ”¶è€… | æ¸ é“ | è§¦å‘æ—¶æœº |
|----------|------|--------|------|----------|
| `payment_success` | æ”¯ä»˜æˆåŠŸé€šçŸ¥ | ä¼šå‘˜ | wechat | æ”¯ä»˜å›è°ƒæˆåŠŸ |
| `bind_remind` | ç»‘å®šæé†’ | ä¼šå‘˜ | wechat | ç»‘å®šè¶…æ—¶æ£€æµ‹ |
| `bind_success` | ç»‘å®šæˆåŠŸé€šçŸ¥ | ä¼šå‘˜ | wechat | å®Œæˆæ˜Ÿçƒç»‘å®š |
| `checkin_remind` | æ‰“å¡æé†’ | ä¼šå‘˜ | wechat | æ¯æ—¥å®šæ—¶ |
| `camp_end_remind` | è®­ç»ƒè¥ç»“æŸæé†’ | ä¼šå‘˜ | wechat | è®­ç»ƒè¥ç»“æŸå‰1å¤© |
| `refund_success` | é€€æ¬¾æˆåŠŸé€šçŸ¥ | ä¼šå‘˜ | wechat | é€€æ¬¾åˆ°è´¦ |
| `refund_failed` | é€€æ¬¾å¤±è´¥é€šçŸ¥ | ä¼šå‘˜ | wechat | é€€æ¬¾å¤±è´¥ |
| `admin_bind_timeout` | ç»‘å®šè¶…æ—¶æ±‡æ€» | ç®¡ç†å‘˜ | wechat | æ¯æ—¥è¶…æ—¶æ£€æµ‹ |
| `admin_refund_pending` | å¾…å®¡æ ¸é€€æ¬¾æé†’ | ç®¡ç†å‘˜ | wechat | ç”Ÿæˆé€€æ¬¾åå• |
| `admin_token_expired` | Tokenè¿‡æœŸå‘Šè­¦ | ç®¡ç†å‘˜ | wechat | APIè°ƒç”¨å¤±è´¥ |
| `admin_sync_failed` | åŒæ­¥å¤±è´¥å‘Šè­¦ | ç®¡ç†å‘˜ | wechat | æ‰“å¡åŒæ­¥å¤±è´¥ |

---

## äºŒã€ä¼šå‘˜é€šçŸ¥æ¨¡æ¿

### 2.1 æ”¯ä»˜æˆåŠŸé€šçŸ¥ (`payment_success`)

**è§¦å‘æ—¶æœº**: å¾®ä¿¡æ”¯ä»˜å›è°ƒæˆåŠŸå
**å‘é€æ¸ é“**: ä¼ä¸šå¾®ä¿¡æœåŠ¡å·æ¨¡æ¿æ¶ˆæ¯

```
ã€æ”¯ä»˜æˆåŠŸã€‘

è®­ç»ƒè¥ï¼š{{camp_name}}
æŠ¼é‡‘é‡‘é¢ï¼š{{pay_amount}}å…ƒ
è®¢å•å·ï¼š{{order_no}}
æ”¯ä»˜æ—¶é—´ï¼š{{pay_time}}

{{#if need_bind}}
âš ï¸ è¯·åœ¨7å¤©å†…å®Œæˆæ˜Ÿçƒè´¦å·ç»‘å®šï¼Œå¦åˆ™å¯èƒ½å½±å“é€€æ¬¾ã€‚
ğŸ‘‰ ç‚¹å‡»ç»‘å®šï¼š{{bind_url}}
{{else}}
âœ… æ‚¨çš„æ˜Ÿçƒè´¦å·å·²ç»‘å®šæˆåŠŸï¼Œè¯·æ‰«æä¸‹æ–¹äºŒç»´ç è¿›ç¾¤å¼€å§‹å­¦ä¹ ã€‚
{{/if}}

ç¥æ‚¨å­¦ä¹ æ„‰å¿«ï¼
```

**å˜é‡è¯´æ˜**:

| å˜é‡ | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| `camp_name` | string | è®­ç»ƒè¥åç§° | "21å¤©Pythonå…¥é—¨è®­ç»ƒè¥" |
| `pay_amount` | decimal | æ”¯ä»˜é‡‘é¢ | "99.00" |
| `order_no` | string | è®¢å•å· | "ORD20251212123456" |
| `pay_time` | datetime | æ”¯ä»˜æ—¶é—´ | "2025-12-12 14:30:00" |
| `need_bind` | boolean | æ˜¯å¦éœ€è¦ç»‘å®š | true/false |
| `bind_url` | string | ç»‘å®šé¡µé¢é“¾æ¥ | "https://xxx/bindplanet?orderNo=xxx" |

---

### 2.2 ç»‘å®šæé†’ (`bind_remind`)

**è§¦å‘æ—¶æœº**:
- æ”¯ä»˜åç¬¬3å¤©æœªç»‘å®š
- æ”¯ä»˜åç¬¬6å¤©æœªç»‘å®šï¼ˆæœ€åæé†’ï¼‰
- ç»‘å®šè¶…æ—¶åï¼ˆå‚¬ä¿ƒè¡¥ç»‘å®šï¼‰

**å‘é€æ¸ é“**: ä¼ä¸šå¾®ä¿¡æœåŠ¡å·æ¨¡æ¿æ¶ˆæ¯

```
ã€ç»‘å®šæé†’ã€‘

æ‚¨åœ¨ã€Œ{{camp_name}}ã€è®­ç»ƒè¥çš„æŠ¼é‡‘ï¼ˆ{{pay_amount}}å…ƒï¼‰å°šæœªç»‘å®šæ˜Ÿçƒè´¦å·ã€‚

{{#if is_expired}}
âš ï¸ ç»‘å®šå·²è¶…æ—¶ï¼Œè¯·å°½å¿«å®Œæˆç»‘å®šï¼Œå¦åˆ™å¯èƒ½å½±å“é€€æ¬¾ã€‚
{{else}}
â° è·ç¦»ç»‘å®šæˆªæ­¢è¿˜å‰© {{days_left}} å¤©ï¼Œè¯·å°½å¿«å®Œæˆã€‚
{{/if}}

ğŸ‘‰ ç‚¹å‡»ç»‘å®šï¼š{{bind_url}}

å¦‚æœ‰ç–‘é—®ï¼Œè¯·è”ç³»ç®¡ç†å‘˜ã€‚
```

**å˜é‡è¯´æ˜**:

| å˜é‡ | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| `camp_name` | string | è®­ç»ƒè¥åç§° | "21å¤©Pythonå…¥é—¨è®­ç»ƒè¥" |
| `pay_amount` | decimal | æ”¯ä»˜é‡‘é¢ | "99.00" |
| `is_expired` | boolean | æ˜¯å¦å·²è¶…æ—¶ | true/false |
| `days_left` | integer | å‰©ä½™å¤©æ•° | 4 |
| `bind_url` | string | ç»‘å®šé¡µé¢é“¾æ¥ | "https://xxx/bindplanet?orderNo=xxx" |

---

### 2.3 ç»‘å®šæˆåŠŸé€šçŸ¥ (`bind_success`)

**è§¦å‘æ—¶æœº**: ç”¨æˆ·å®Œæˆæ˜Ÿçƒè´¦å·ç»‘å®šå
**å‘é€æ¸ é“**: ä¼ä¸šå¾®ä¿¡æœåŠ¡å·æ¨¡æ¿æ¶ˆæ¯

```
ã€ç»‘å®šæˆåŠŸã€‘

æ­å–œï¼æ‚¨çš„æ˜Ÿçƒè´¦å·å·²æˆåŠŸç»‘å®šã€‚

è®­ç»ƒè¥ï¼š{{camp_name}}
æ˜Ÿçƒæ˜µç§°ï¼š{{planet_nickname}}
æ˜Ÿçƒç¼–å·ï¼š{{planet_member_number}}

è¯·æ‰«æä¸‹æ–¹äºŒç»´ç è¿›ç¾¤ï¼Œå¼€å§‹æ‚¨çš„å­¦ä¹ ä¹‹æ—…ï¼

ğŸ“¢ æ¸©é¦¨æç¤ºï¼š
- è®­ç»ƒè¥æ—¶é—´ï¼š{{start_date}} è‡³ {{end_date}}
- æ‰“å¡è¦æ±‚ï¼š{{total_days}}å¤©å†…æ‰“å¡{{required_days}}å¤©
- å®Œæˆæ‰“å¡å³å¯è·å¾—å…¨é¢é€€æ¬¾

åŠ æ²¹ï¼
```

**å˜é‡è¯´æ˜**:

| å˜é‡ | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| `camp_name` | string | è®­ç»ƒè¥åç§° | "21å¤©Pythonå…¥é—¨è®­ç»ƒè¥" |
| `planet_nickname` | string | æ˜Ÿçƒæ˜µç§° | "å­¦ä¹ è€…å°æ˜" |
| `planet_member_number` | string | æ˜Ÿçƒæˆå‘˜ç¼–å· | "123456" |
| `start_date` | date | å¼€å§‹æ—¥æœŸ | "2025-12-15" |
| `end_date` | date | ç»“æŸæ—¥æœŸ | "2026-01-04" |
| `total_days` | integer | æ€»å¤©æ•° | 21 |
| `required_days` | integer | è¦æ±‚æ‰“å¡å¤©æ•° | 15 |

---

### 2.4 æ‰“å¡æé†’ (`checkin_remind`)

**è§¦å‘æ—¶æœº**: æ¯æ—¥ 20:00ï¼Œå‘å½“æ—¥æœªæ‰“å¡çš„ä¼šå‘˜å‘é€æé†’
**å‘é€æ¸ é“**: ä¼ä¸šå¾®ä¿¡æœåŠ¡å·æ¨¡æ¿æ¶ˆæ¯

```
ã€æ‰“å¡æé†’ã€‘

ã€Œ{{camp_name}}ã€ä»Šæ—¥æ‰“å¡è¿˜æ²¡å®Œæˆå“¦ï¼

ğŸ“Š å½“å‰è¿›åº¦ï¼š
- å·²æ‰“å¡ï¼š{{checkin_count}}/{{required_days}}å¤©
- å®Œæˆç‡ï¼š{{checkin_rate}}%
{{#if is_on_track}}
âœ… è¿›åº¦è‰¯å¥½ï¼Œç»§ç»­ä¿æŒï¼
{{else}}
âš ï¸ è¿›åº¦è½åï¼Œéœ€è¦åŠ æŠŠåŠ²äº†ï¼
{{/if}}

ğŸ‘‰ å‰å¾€çŸ¥è¯†æ˜Ÿçƒå®Œæˆä»Šæ—¥æ‰“å¡

åšæŒå°±æ˜¯èƒœåˆ©ï¼ŒåŠ æ²¹ï¼ğŸ’ª
```

**å˜é‡è¯´æ˜**:

| å˜é‡ | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| `camp_name` | string | è®­ç»ƒè¥åç§° | "21å¤©Pythonå…¥é—¨è®­ç»ƒè¥" |
| `checkin_count` | integer | å·²æ‰“å¡å¤©æ•° | 8 |
| `required_days` | integer | è¦æ±‚æ‰“å¡å¤©æ•° | 15 |
| `checkin_rate` | decimal | å®Œæˆç‡ | "53.33" |
| `is_on_track` | boolean | è¿›åº¦æ˜¯å¦æ­£å¸¸ | true/false |

---

### 2.5 è®­ç»ƒè¥ç»“æŸæé†’ (`camp_end_remind`)

**è§¦å‘æ—¶æœº**: è®­ç»ƒè¥ç»“æŸå‰1å¤©
**å‘é€æ¸ é“**: ä¼ä¸šå¾®ä¿¡æœåŠ¡å·æ¨¡æ¿æ¶ˆæ¯

```
ã€è®­ç»ƒè¥å³å°†ç»“æŸã€‘

ã€Œ{{camp_name}}ã€å°†äºæ˜å¤©ï¼ˆ{{end_date}}ï¼‰ç»“æŸã€‚

ğŸ“Š æ‚¨çš„æœ€ç»ˆæˆç»©ï¼š
- å·²æ‰“å¡ï¼š{{checkin_count}}/{{required_days}}å¤©
- å®Œæˆç‡ï¼š{{checkin_rate}}%

{{#if eligible_for_refund}}
ğŸ‰ æ­å–œï¼æ‚¨å·²è¾¾åˆ°é€€æ¬¾æ¡ä»¶ï¼ˆâ‰¥{{required_days}}å¤©ï¼‰
æŠ¼é‡‘å°†åœ¨è®­ç»ƒè¥ç»“æŸå5ä¸ªå·¥ä½œæ—¥å†…é€€è¿˜ã€‚
{{else}}
ğŸ˜¢ å¾ˆé—æ†¾ï¼Œæ‚¨æœªè¾¾åˆ°é€€æ¬¾æ¡ä»¶ã€‚
å·® {{days_needed}} å¤©æ‰“å¡ï¼Œè¯·æŠ“ç´§æœ€åæœºä¼šï¼
{{/if}}

æ„Ÿè°¢æ‚¨çš„å‚ä¸ï¼
```

**å˜é‡è¯´æ˜**:

| å˜é‡ | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| `camp_name` | string | è®­ç»ƒè¥åç§° | "21å¤©Pythonå…¥é—¨è®­ç»ƒè¥" |
| `end_date` | date | ç»“æŸæ—¥æœŸ | "2026-01-04" |
| `checkin_count` | integer | å·²æ‰“å¡å¤©æ•° | 14 |
| `required_days` | integer | è¦æ±‚æ‰“å¡å¤©æ•° | 15 |
| `checkin_rate` | decimal | å®Œæˆç‡ | "93.33" |
| `eligible_for_refund` | boolean | æ˜¯å¦ç¬¦åˆé€€æ¬¾æ¡ä»¶ | true/false |
| `days_needed` | integer | è¿˜éœ€æ‰“å¡å¤©æ•° | 1 |

---

### 2.6 é€€æ¬¾æˆåŠŸé€šçŸ¥ (`refund_success`)

**è§¦å‘æ—¶æœº**: é€€æ¬¾åˆ°è´¦ï¼ˆå¾®ä¿¡é€€æ¬¾å›è°ƒæˆåŠŸï¼‰
**å‘é€æ¸ é“**: ä¼ä¸šå¾®ä¿¡æœåŠ¡å·æ¨¡æ¿æ¶ˆæ¯

```
ã€é€€æ¬¾æˆåŠŸã€‘

ğŸ‰ æ­å–œï¼æ‚¨çš„æŠ¼é‡‘å·²æˆåŠŸé€€è¿˜ã€‚

è®­ç»ƒè¥ï¼š{{camp_name}}
é€€æ¬¾é‡‘é¢ï¼š{{refund_amount}}å…ƒ
é€€æ¬¾æ—¶é—´ï¼š{{refund_time}}

é€€æ¬¾å·²åŸè·¯è¿”å›è‡³æ‚¨çš„æ”¯ä»˜è´¦æˆ·ï¼Œè¯·æ³¨æ„æŸ¥æ”¶ã€‚

æ„Ÿè°¢æ‚¨çš„å‚ä¸ï¼ŒæœŸå¾…ä¸‹æ¬¡ç›¸è§ï¼ğŸ™Œ
```

**å˜é‡è¯´æ˜**:

| å˜é‡ | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| `camp_name` | string | è®­ç»ƒè¥åç§° | "21å¤©Pythonå…¥é—¨è®­ç»ƒè¥" |
| `refund_amount` | decimal | é€€æ¬¾é‡‘é¢ | "99.00" |
| `refund_time` | datetime | é€€æ¬¾æ—¶é—´ | "2025-12-20 10:30:00" |

---

### 2.7 é€€æ¬¾å¤±è´¥é€šçŸ¥ (`refund_failed`)

**è§¦å‘æ—¶æœº**: é€€æ¬¾æ‰§è¡Œå¤±è´¥ï¼ˆå¤šæ¬¡é‡è¯•åä»å¤±è´¥ï¼‰
**å‘é€æ¸ é“**: ä¼ä¸šå¾®ä¿¡æœåŠ¡å·æ¨¡æ¿æ¶ˆæ¯

```
ã€é€€æ¬¾å¤„ç†ä¸­ã€‘

æ‚¨åœ¨ã€Œ{{camp_name}}ã€è®­ç»ƒè¥çš„é€€æ¬¾æ­£åœ¨å¤„ç†ä¸­ã€‚

é€€æ¬¾é‡‘é¢ï¼š{{refund_amount}}å…ƒ
å½“å‰çŠ¶æ€ï¼šå¤„ç†ä¸­

ç”±äº {{failure_reason}}ï¼Œé€€æ¬¾æš‚æ—¶æ— æ³•å®Œæˆã€‚æˆ‘ä»¬çš„å·¥ä½œäººå‘˜ä¼šå°½å¿«å¤„ç†ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚

å¦‚æœ‰ç–‘é—®ï¼Œè¯·è”ç³»ç®¡ç†å‘˜ã€‚
```

**å˜é‡è¯´æ˜**:

| å˜é‡ | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| `camp_name` | string | è®­ç»ƒè¥åç§° | "21å¤©Pythonå…¥é—¨è®­ç»ƒè¥" |
| `refund_amount` | decimal | é€€æ¬¾é‡‘é¢ | "99.00" |
| `failure_reason` | string | å¤±è´¥åŸå› ï¼ˆç”¨æˆ·å‹å¥½ï¼‰ | "ç³»ç»Ÿç¹å¿™" |

---

## ä¸‰ã€ç®¡ç†å‘˜é€šçŸ¥æ¨¡æ¿

### 3.1 ç»‘å®šè¶…æ—¶æ±‡æ€» (`admin_bind_timeout`)

**è§¦å‘æ—¶æœº**: æ¯æ—¥ç»‘å®šè¶…æ—¶æ£€æµ‹ä»»åŠ¡å®Œæˆå
**å‘é€æ¸ é“**: ä¼ä¸šå¾®ä¿¡åº”ç”¨æ¶ˆæ¯

```
ã€ç»‘å®šè¶…æ—¶æé†’ã€‘

ä»Šæ—¥æ–°å¢ {{total_count}} ç¬”è¶…æ—¶æœªç»‘å®šè®¢å•ï¼š

{{#each camps}}
ğŸ“¦ {{camp_name}}ï¼š{{count}}ç¬”
{{/each}}

è¯·åŠæ—¶å¤„ç†ï¼Œé¿å…å½±å“ç”¨æˆ·é€€æ¬¾ã€‚

ğŸ‘‰ å¤„ç†å…¥å£ï¼š{{admin_url}}
```

**å˜é‡è¯´æ˜**:

| å˜é‡ | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| `total_count` | integer | è¶…æ—¶æ€»æ•° | 5 |
| `camps` | array | æŒ‰è®­ç»ƒè¥åˆ†ç»„ | [{camp_name: "xxx", count: 3}] |
| `admin_url` | string | ç®¡ç†åå°é“¾æ¥ | "https://admin.xxx.com/payments" |

---

### 3.2 å¾…å®¡æ ¸é€€æ¬¾æé†’ (`admin_refund_pending`)

**è§¦å‘æ—¶æœº**: ç”Ÿæˆé€€æ¬¾åå•å
**å‘é€æ¸ é“**: ä¼ä¸šå¾®ä¿¡åº”ç”¨æ¶ˆæ¯

```
ã€é€€æ¬¾å®¡æ ¸æé†’ã€‘

ã€Œ{{camp_name}}ã€è®­ç»ƒè¥å·²ç»“æŸï¼Œé€€æ¬¾åå•å·²ç”Ÿæˆã€‚

ğŸ“Š é€€æ¬¾ç»Ÿè®¡ï¼š
- ç¬¦åˆé€€æ¬¾ï¼š{{eligible_count}}äºº
- é€€æ¬¾æ€»é¢ï¼š{{total_amount}}å…ƒ
- å¾…äººå·¥å¤„ç†ï¼š{{manual_count}}äºº

è¯·åŠæ—¶å®¡æ ¸å¤„ç†ã€‚

ğŸ‘‰ å®¡æ ¸å…¥å£ï¼š{{admin_url}}
```

**å˜é‡è¯´æ˜**:

| å˜é‡ | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| `camp_name` | string | è®­ç»ƒè¥åç§° | "21å¤©Pythonå…¥é—¨è®­ç»ƒè¥" |
| `eligible_count` | integer | ç¬¦åˆé€€æ¬¾äººæ•° | 45 |
| `total_amount` | decimal | é€€æ¬¾æ€»é¢ | "4455.00" |
| `manual_count` | integer | å¾…äººå·¥å¤„ç†äººæ•° | 3 |
| `admin_url` | string | ç®¡ç†åå°é“¾æ¥ | "https://admin.xxx.com/refunds" |

---

### 3.3 Tokenè¿‡æœŸå‘Šè­¦ (`admin_token_expired`)

**è§¦å‘æ—¶æœº**: è°ƒç”¨çŸ¥è¯†æ˜ŸçƒAPIè¿”å›401/403é”™è¯¯
**å‘é€æ¸ é“**: ä¼ä¸šå¾®ä¿¡åº”ç”¨æ¶ˆæ¯
**ä¼˜å…ˆçº§**: é«˜ï¼ˆç«‹å³å‘é€ï¼‰

```
ğŸš¨ã€Tokenè¿‡æœŸå‘Šè­¦ã€‘

çŸ¥è¯†æ˜ŸçƒAPI Tokenå·²è¿‡æœŸæˆ–å¤±æ•ˆï¼

é”™è¯¯ä¿¡æ¯ï¼š{{error_message}}
å‘ç”Ÿæ—¶é—´ï¼š{{error_time}}
å½±å“èŒƒå›´ï¼šæ‰“å¡åŒæ­¥åŠŸèƒ½æš‚åœ

è¯·ç«‹å³æ›´æ–°Tokenï¼š
1. ç™»å½•çŸ¥è¯†æ˜Ÿçƒç½‘é¡µç‰ˆ
2. ä»æµè§ˆå™¨å¼€å‘è€…å·¥å…·è·å–æ–°Token
3. æ›´æ–°ç³»ç»Ÿé…ç½®

ğŸ‘‰ é…ç½®å…¥å£ï¼š{{config_url}}
```

**å˜é‡è¯´æ˜**:

| å˜é‡ | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| `error_message` | string | é”™è¯¯ä¿¡æ¯ | "401 Unauthorized" |
| `error_time` | datetime | å‘ç”Ÿæ—¶é—´ | "2025-12-12 01:30:00" |
| `config_url` | string | é…ç½®é¡µé¢é“¾æ¥ | "https://admin.xxx.com/config" |

---

### 3.4 åŒæ­¥å¤±è´¥å‘Šè­¦ (`admin_sync_failed`)

**è§¦å‘æ—¶æœº**: æ‰“å¡åŒæ­¥ä»»åŠ¡å¤±è´¥ï¼ˆé‡è¯•3æ¬¡åä»å¤±è´¥ï¼‰
**å‘é€æ¸ é“**: ä¼ä¸šå¾®ä¿¡åº”ç”¨æ¶ˆæ¯

```
âš ï¸ã€åŒæ­¥å¤±è´¥å‘Šè­¦ã€‘

æ‰“å¡æ•°æ®åŒæ­¥å¤±è´¥ï¼

è®­ç»ƒè¥ï¼š{{camp_name}}
å¤±è´¥æ—¶é—´ï¼š{{fail_time}}
é”™è¯¯åŸå› ï¼š{{error_message}}
é‡è¯•æ¬¡æ•°ï¼š{{retry_count}}

è¯·æ£€æŸ¥ï¼š
1. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
2. API Tokenæ˜¯å¦æœ‰æ•ˆ
3. çŸ¥è¯†æ˜ŸçƒæœåŠ¡æ˜¯å¦æ­£å¸¸

ğŸ‘‰ æ‰‹åŠ¨åŒæ­¥ï¼š{{sync_url}}
```

**å˜é‡è¯´æ˜**:

| å˜é‡ | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| `camp_name` | string | è®­ç»ƒè¥åç§° | "21å¤©Pythonå…¥é—¨è®­ç»ƒè¥" |
| `fail_time` | datetime | å¤±è´¥æ—¶é—´ | "2025-12-12 01:35:00" |
| `error_message` | string | é”™è¯¯ä¿¡æ¯ | "Connection timeout" |
| `retry_count` | integer | é‡è¯•æ¬¡æ•° | 3 |
| `sync_url` | string | æ‰‹åŠ¨åŒæ­¥é“¾æ¥ | "https://admin.xxx.com/camps/1/sync" |

---

## å››ã€æ¶ˆæ¯å‘é€é…ç½®

### 4.1 å‘é€é¢‘ç‡é™åˆ¶

| æ¶ˆæ¯ç±»å‹ | é¢‘ç‡é™åˆ¶ | è¯´æ˜ |
|----------|----------|------|
| `checkin_remind` | æ¯æ—¥æœ€å¤š1æ¬¡ | é¿å…æ‰“æ‰°ç”¨æˆ· |
| `bind_remind` | æ¯3å¤©æœ€å¤š1æ¬¡ | æ”¯ä»˜åç¬¬3ã€6å¤©å„1æ¬¡ |
| `admin_bind_timeout` | æ¯æ—¥æœ€å¤š1æ¬¡ | æ±‡æ€»å‘é€ |
| `admin_token_expired` | æ¯å°æ—¶æœ€å¤š1æ¬¡ | é¿å…å‘Šè­¦è½°ç‚¸ |

### 4.2 å‘é€æ—¶é—´æ®µ

| æ¶ˆæ¯ç±»å‹ | å‘é€æ—¶é—´ | è¯´æ˜ |
|----------|----------|------|
| ä¼šå‘˜é€šçŸ¥ï¼ˆéç´§æ€¥ï¼‰ | 09:00 - 21:00 | é¿å…æ·±å¤œæ‰“æ‰° |
| ç®¡ç†å‘˜å‘Šè­¦ | ä»»æ„æ—¶é—´ | ç´§æ€¥äº‹é¡¹ç«‹å³é€šçŸ¥ |
| æ‰“å¡æé†’ | 20:00 | å›ºå®šæ—¶é—´å‘é€ |

### 4.3 å¤±è´¥é‡è¯•ç­–ç•¥

| åœºæ™¯ | é‡è¯•æ¬¡æ•° | é‡è¯•é—´éš” | æœ€ç»ˆå¤„ç† |
|------|----------|----------|----------|
| ç½‘ç»œè¶…æ—¶ | 3æ¬¡ | 1s, 2s, 4s | è®°å½•æ—¥å¿—ï¼Œä¸‹æ¬¡ä»»åŠ¡é‡å‘ |
| æ¨¡æ¿æ¶ˆæ¯é™æµ | 3æ¬¡ | 60s | å»¶è¿Ÿé˜Ÿåˆ—é‡å‘ |
| ç”¨æˆ·å–æ¶ˆå…³æ³¨ | ä¸é‡è¯• | - | æ ‡è®°ä¸ºå‘é€å¤±è´¥ |

---

## äº”ã€ä¼ä¸šå¾®ä¿¡æ¨¡æ¿æ¶ˆæ¯é…ç½®

### 5.1 æ¨¡æ¿IDæ˜ å°„

| æ¶ˆæ¯ç±»å‹ | æ¨¡æ¿ID | å¤‡æ³¨ |
|----------|--------|------|
| `payment_success` | `TPL_PAYMENT_001` | éœ€åœ¨ä¼ä¸šå¾®ä¿¡åå°é…ç½® |
| `bind_remind` | `TPL_BIND_001` | |
| `bind_success` | `TPL_BIND_002` | |
| `checkin_remind` | `TPL_CHECKIN_001` | |
| `camp_end_remind` | `TPL_CAMP_001` | |
| `refund_success` | `TPL_REFUND_001` | |
| `refund_failed` | `TPL_REFUND_002` | |

### 5.2 å‘é€æ¥å£

```java
// NotificationService.java
public interface NotificationService {

    /**
     * å‘é€ä¼šå‘˜é€šçŸ¥
     * @param memberId ä¼šå‘˜ID
     * @param messageType æ¶ˆæ¯ç±»å‹
     * @param variables æ¨¡æ¿å˜é‡
     */
    void sendMemberNotification(Long memberId, String messageType, Map<String, Object> variables);

    /**
     * å‘é€ç®¡ç†å‘˜é€šçŸ¥
     * @param messageType æ¶ˆæ¯ç±»å‹
     * @param variables æ¨¡æ¿å˜é‡
     */
    void sendAdminNotification(String messageType, Map<String, Object> variables);

    /**
     * æ‰¹é‡å‘é€ä¼šå‘˜é€šçŸ¥
     * @param memberIds ä¼šå‘˜IDåˆ—è¡¨
     * @param messageType æ¶ˆæ¯ç±»å‹
     * @param variablesProvider å˜é‡æä¾›å™¨ï¼ˆæ ¹æ®memberIdè¿”å›å¯¹åº”å˜é‡ï¼‰
     */
    void batchSendMemberNotification(List<Long> memberIds, String messageType,
                                      Function<Long, Map<String, Object>> variablesProvider);
}
```

---

## å…­ã€å˜æ›´å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´å†…å®¹ |
|------|------|----------|
| v1.0 | 2025-12-12 | åˆå§‹ç‰ˆæœ¬ï¼Œå®šä¹‰11ç§æ¶ˆæ¯æ¨¡æ¿ |

---

## ç›¸å…³æ–‡æ¡£

- [æŠ€æœ¯æ–¹æ¡ˆ.md](./æŠ€æœ¯æ–¹æ¡ˆ.md) - 5.8 é€šçŸ¥åŠŸèƒ½è®¾è®¡
- [æ•°æ®åº“è®¾è®¡.md](./æ•°æ®åº“è®¾è®¡.md) - notification_message è¡¨
- [çŠ¶æ€æšä¸¾å®šä¹‰.md](./çŠ¶æ€æšä¸¾å®šä¹‰.md) - çŠ¶æ€ç›¸å…³æ–‡æ¡ˆ
