# 知识星球训练营退款系统 - v0 技术方案

## 文档信息
- **版本**：v0.1（简化版）
- **创建日期**：2025-10-26
- **适用范围**：最小可用版本（MVP）

---

## 一、技术架构

### 1.1 整体架构图

```
┌─────────────────────────────────────────────┐
│          管理后台（Web）                      │
│       Vue 3 + Element Plus                  │
│   ┌─────────┐  ┌─────────┐  ┌─────────┐   │
│   │训练营管理│  │打卡数据│  │批量退款  │   │
│   └─────────┘  └─────────┘  └─────────┘   │
└─────────────────────────────────────────────┘
                    ↓ HTTPS
┌─────────────────────────────────────────────┐
│              后端服务                         │
│          Spring Boot 3.2+                   │
│   ┌─────────────────────────────────────┐  │
│   │  RESTful API                        │  │
│   │  - 训练营CRUD                        │  │
│   │  - 知识星球API封装                   │  │
│   │  - 企业微信退款API封装               │  │
│   └─────────────────────────────────────┘  │
└─────────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────┐
│         PostgreSQL 15+                      │
│  - training_camp（训练营）                   │
│  - checkin_record（打卡记录）                │
│  - refund_record（退款记录）                 │
│  - system_config（系统配置）                 │
└─────────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────┐
│            外部服务                          │
│  ┌──────────────┐  ┌──────────────┐        │
│  │知识星球API    │  │企业微信退款API│        │
│  └──────────────┘  └──────────────┘        │
└─────────────────────────────────────────────┘
```

### 1.2 技术栈选型

#### 后端技术
| 技术 | 版本 | 用途 |
|------|------|------|
| Java | 17+ | 编程语言 |
| Spring Boot | 3.2+ | 应用框架 |
| Spring Security | 6.x | 登录认证（简单的账号密码） |
| MyBatis Plus | 3.5+ | ORM框架 |
| PostgreSQL | 15+ | 数据库 |
| OkHttp3 | 4.x | HTTP客户端（调用外部API） |
| Knife4j | 4.x | API文档 |

#### 前端技术
| 技术 | 版本 | 用途 |
|------|------|------|
| Vue | 3.3+ | 前端框架 |
| Vite | 5.x | 构建工具 |
| Element Plus | 2.4+ | UI组件库 |
| Axios | 1.x | HTTP客户端 |
| Pinia | 2.x | 状态管理 |

---

## 二、核心模块设计

### 2.1 后端分层架构

```
Controller（接口层）
    ↓ 参数校验、路由映射
Service（业务逻辑层）
    ↓ 事务管理、业务规则
Manager（第三方服务封装层）
    ↓ API调用、数据转换
Mapper（数据访问层）
    ↓ SQL操作
Database（数据库）
```

### 2.2 核心Service层

#### 2.2.1 CampService（训练营服务）
**职责**：训练营CRUD

**核心方法**：
```java
// 创建训练营
CampVO createCamp(CreateCampDTO dto);

// 训练营列表
PageResult<CampVO> listCamps(QueryCampDTO dto);

// 训练营详情
CampDetailVO getCampDetail(Long campId);

// 更新训练营
void updateCamp(Long campId, UpdateCampDTO dto);
```

#### 2.2.2 CheckinService（打卡服务）
**职责**：获取知识星球打卡数据

**核心方法**：
```java
// 从知识星球API获取打卡数据
List<CheckinRecordVO> syncCheckinData(Long campId);

// 保存打卡数据到数据库
void saveCheckinRecords(Long campId, List<CheckinRecordDTO> records);

// 查询训练营的打卡统计
CheckinStatisticsVO getCheckinStatistics(Long campId);
```

#### 2.2.3 RefundService（退款服务）
**职责**：生成退款名单、执行批量退款

**核心方法**：
```java
// 计算退款资格，生成退款名单
List<RefundRecordVO> generateRefundList(Long campId);

// 人工审核（允许/拒绝退款）
void auditRefund(Long refundId, boolean approved);

// 批量执行退款
RefundResultVO batchRefund(Long campId);

// 单个退款重试
void retryRefund(Long refundId);
```

### 2.3 Manager层（第三方API封装）

#### 2.3.1 PlanetApiManager（知识星球API）
**职责**：封装知识星球API调用

**核心方法**：
```java
/**
 * 获取项目打卡数据
 * @param projectId 知识星球项目ID
 * @return 打卡数据列表
 */
List<PlanetCheckinDTO> getProjectCheckins(String projectId);
```

**实现示例**：
```java
public List<PlanetCheckinDTO> getProjectCheckins(String projectId) {
    // 1. 从system_config表获取Cookie
    String cookie = configService.getConfig("planet_cookie");

    // 2. 构造请求
    Request request = new Request.Builder()
        .url("https://api.zsxq.com/v4/topics/" + projectId + "/checkins")
        .header("Cookie", cookie)
        .build();

    // 3. 发送请求
    Response response = okHttpClient.newCall(request).execute();

    // 4. 解析响应
    String json = response.body().string();
    PlanetApiResponse apiResponse = objectMapper.readValue(json, PlanetApiResponse.class);

    // 5. 返回数据
    return apiResponse.getUsers();
}
```

#### 2.3.2 WechatRefundManager（企业微信退款API）
**职责**：封装企业微信退款API调用

**核心方法**：
```java
/**
 * 执行退款
 * @param transactionId 微信支付订单号
 * @param refundAmount 退款金额（单位：分）
 * @return 退款结果
 */
WechatRefundResult executeRefund(String transactionId, Integer refundAmount);
```

**实现示例**：
```java
public WechatRefundResult executeRefund(String transactionId, Integer refundAmount) {
    // 1. 从system_config表获取企业微信配置
    String merchantId = configService.getConfig("wechat_merchant_id");
    String apiKey = configService.getConfig("wechat_api_key");

    // 2. 生成商户退款单号
    String outRefundNo = "REFUND_" + System.currentTimeMillis();

    // 3. 构造请求参数
    Map<String, Object> params = new HashMap<>();
    params.put("transaction_id", transactionId);
    params.put("out_refund_no", outRefundNo);
    params.put("refund", Map.of("amount", refundAmount));

    // 4. 签名（企业微信API需要）
    String signature = WechatSignUtil.sign(params, apiKey);

    // 5. 发送POST请求
    Request request = new Request.Builder()
        .url("https://api.mch.weixin.qq.com/v3/refund/domestic/refunds")
        .post(RequestBody.create(objectMapper.writeValueAsString(params), MediaType.JSON))
        .header("Authorization", "WECHATPAY2-SHA256-RSA2048 " + signature)
        .build();

    Response response = okHttpClient.newCall(request).execute();

    // 6. 解析响应
    String json = response.body().string();
    WechatRefundResponse apiResponse = objectMapper.readValue(json, WechatRefundResponse.class);

    // 7. 返回结果
    return WechatRefundResult.builder()
        .success("SUCCESS".equals(apiResponse.getStatus()))
        .refundId(apiResponse.getRefundId())
        .failureReason(apiResponse.getFailureReason())
        .build();
}
```

---

## 三、数据库设计

### 3.1 核心数据表

#### 3.1.1 training_camp（训练营表）
```sql
CREATE TABLE training_camp (
    id                BIGSERIAL PRIMARY KEY,
    name              VARCHAR(100) NOT NULL COMMENT '训练营名称',
    deposit_amount    DECIMAL(10,2) NOT NULL COMMENT '押金金额',
    checkin_days      INTEGER NOT NULL COMMENT '打卡总天数',
    required_days     INTEGER NOT NULL COMMENT '要求打卡天数',
    planet_project_id VARCHAR(100) COMMENT '知识星球项目ID',
    status            VARCHAR(20) DEFAULT 'active' COMMENT '状态：active进行中/finished已结束',
    created_at        TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at        TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    deleted_at        TIMESTAMP COMMENT '软删除标记'
);

CREATE INDEX idx_status ON training_camp(status);
```

#### 3.1.2 checkin_record（打卡记录表）
```sql
CREATE TABLE checkin_record (
    id                BIGSERIAL PRIMARY KEY,
    camp_id           BIGINT NOT NULL COMMENT '训练营ID',
    planet_user_id    VARCHAR(100) NOT NULL COMMENT '知识星球用户ID',
    planet_nickname   VARCHAR(100) COMMENT '星球昵称',
    checkin_date      DATE COMMENT '打卡日期',
    checkin_count     INTEGER COMMENT '累计打卡天数',
    raw_data          JSONB COMMENT '原始JSON数据',
    created_at        TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY (camp_id) REFERENCES training_camp(id)
);

CREATE INDEX idx_camp_user ON checkin_record(camp_id, planet_user_id);
```

#### 3.1.3 refund_record（退款记录表）
```sql
CREATE TABLE refund_record (
    id                BIGSERIAL PRIMARY KEY,
    camp_id           BIGINT NOT NULL COMMENT '训练营ID',
    planet_user_id    VARCHAR(100) NOT NULL COMMENT '知识星球用户ID',
    planet_nickname   VARCHAR(100) COMMENT '星球昵称',
    checkin_count     INTEGER COMMENT '打卡天数',
    is_qualified      BOOLEAN COMMENT '是否合格',
    refund_amount     DECIMAL(10,2) COMMENT '退款金额',
    manual_approved   BOOLEAN COMMENT '人工审核结果：true允许/false拒绝',
    refund_status     VARCHAR(20) DEFAULT 'pending' COMMENT '状态：pending待退款/success已退款/failed失败',
    wechat_order_id   VARCHAR(100) COMMENT '企业微信订单号',
    failure_reason    TEXT COMMENT '失败原因',
    refunded_at       TIMESTAMP COMMENT '退款时间',
    created_at        TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at        TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY (camp_id) REFERENCES training_camp(id)
);

CREATE INDEX idx_camp_status ON refund_record(camp_id, refund_status);
```

#### 3.1.4 system_config（系统配置表）
```sql
CREATE TABLE system_config (
    id            BIGSERIAL PRIMARY KEY,
    config_key    VARCHAR(100) UNIQUE NOT NULL COMMENT '配置键',
    config_value  TEXT NOT NULL COMMENT '配置值（加密存储）',
    description   VARCHAR(200) COMMENT '配置说明',
    updated_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 初始数据
INSERT INTO system_config (config_key, description) VALUES
('planet_cookie', '知识星球Cookie'),
('wechat_merchant_id', '企业微信商户号'),
('wechat_api_key', '企业微信API密钥');
```

---

## 四、核心业务逻辑

### 4.1 获取打卡数据流程

```java
@Service
public class CheckinServiceImpl implements CheckinService {

    @Autowired
    private PlanetApiManager planetApiManager;

    @Autowired
    private CampMapper campMapper;

    @Autowired
    private CheckinRecordMapper checkinRecordMapper;

    @Transactional
    @Override
    public List<CheckinRecordVO> syncCheckinData(Long campId) {
        // 1. 查询训练营信息
        TrainingCamp camp = campMapper.selectById(campId);
        if (camp == null) {
            throw new BusinessException("训练营不存在");
        }

        // 2. 调用知识星球API
        List<PlanetCheckinDTO> apiData = planetApiManager.getProjectCheckins(
            camp.getPlanetProjectId()
        );

        // 3. 清空旧数据（重新同步）
        checkinRecordMapper.deleteByCampId(campId);

        // 4. 保存到数据库
        List<CheckinRecord> records = new ArrayList<>();
        for (PlanetCheckinDTO dto : apiData) {
            CheckinRecord record = new CheckinRecord();
            record.setCampId(campId);
            record.setPlanetUserId(dto.getUserId());
            record.setPlanetNickname(dto.getNickname());
            record.setCheckinCount(dto.getCheckinCount());
            record.setRawData(objectMapper.writeValueAsString(dto));
            records.add(record);
        }
        checkinRecordMapper.insertBatch(records);

        // 5. 返回VO
        return records.stream()
            .map(this::toVO)
            .collect(Collectors.toList());
    }
}
```

### 4.2 生成退款名单流程

```java
@Service
public class RefundServiceImpl implements RefundService {

    @Override
    public List<RefundRecordVO> generateRefundList(Long campId) {
        // 1. 查询训练营信息
        TrainingCamp camp = campMapper.selectById(campId);

        // 2. 查询打卡记录
        List<CheckinRecord> checkinRecords = checkinRecordMapper.selectByCampId(campId);

        // 3. 计算退款资格
        List<RefundRecord> refundRecords = new ArrayList<>();
        for (CheckinRecord checkin : checkinRecords) {
            RefundRecord refund = new RefundRecord();
            refund.setCampId(campId);
            refund.setPlanetUserId(checkin.getPlanetUserId());
            refund.setPlanetNickname(checkin.getPlanetNickname());
            refund.setCheckinCount(checkin.getCheckinCount());

            // 判断是否合格
            boolean qualified = checkin.getCheckinCount() >= camp.getRequiredDays();
            refund.setIsQualified(qualified);
            refund.setRefundAmount(qualified ? camp.getDepositAmount() : BigDecimal.ZERO);
            refund.setManualApproved(qualified); // 默认：合格的允许退款，不合格的拒绝
            refund.setRefundStatus("pending");

            refundRecords.add(refund);
        }

        // 4. 保存到数据库
        refundRecordMapper.insertBatch(refundRecords);

        // 5. 返回VO
        return refundRecords.stream()
            .map(this::toVO)
            .collect(Collectors.toList());
    }
}
```

### 4.3 批量退款流程

```java
@Service
public class RefundServiceImpl implements RefundService {

    @Autowired
    private WechatRefundManager wechatRefundManager;

    @Override
    public RefundResultVO batchRefund(Long campId) {
        // 1. 查询"待退款"且"人工审核通过"的记录
        List<RefundRecord> refundRecords = refundRecordMapper.selectPendingRefunds(campId);

        // 2. 统计
        int totalCount = refundRecords.size();
        int successCount = 0;
        int failureCount = 0;
        List<String> failureMessages = new ArrayList<>();

        // 3. 逐个调用企业微信退款API
        for (RefundRecord record : refundRecords) {
            try {
                // 调用退款API
                WechatRefundResult result = wechatRefundManager.executeRefund(
                    record.getWechatOrderId(),
                    record.getRefundAmount().multiply(new BigDecimal(100)).intValue() // 转为分
                );

                if (result.isSuccess()) {
                    // 退款成功
                    record.setRefundStatus("success");
                    record.setRefundedAt(LocalDateTime.now());
                    successCount++;
                } else {
                    // 退款失败
                    record.setRefundStatus("failed");
                    record.setFailureReason(result.getFailureReason());
                    failureCount++;
                    failureMessages.add(record.getPlanetNickname() + ": " + result.getFailureReason());
                }

                refundRecordMapper.updateById(record);

            } catch (Exception e) {
                // 异常处理
                record.setRefundStatus("failed");
                record.setFailureReason(e.getMessage());
                refundRecordMapper.updateById(record);
                failureCount++;
                failureMessages.add(record.getPlanetNickname() + ": " + e.getMessage());
            }
        }

        // 4. 返回结果
        return RefundResultVO.builder()
            .totalCount(totalCount)
            .successCount(successCount)
            .failureCount(failureCount)
            .failureMessages(failureMessages)
            .build();
    }
}
```

---

## 五、API接口设计

### 5.1 训练营管理

#### 创建训练营
```
POST /api/admin/camps

请求体：
{
  "name": "10月阅读营",
  "depositAmount": 99,
  "checkinDays": 10,
  "requiredDays": 7,
  "planetProjectId": "123456"
}

响应：
{
  "code": 200,
  "message": "成功",
  "data": {
    "id": 1,
    "name": "10月阅读营",
    ...
  }
}
```

#### 训练营列表
```
GET /api/admin/camps?page=1&size=10&status=active

响应：
{
  "code": 200,
  "data": {
    "total": 100,
    "records": [
      {
        "id": 1,
        "name": "10月阅读营",
        "depositAmount": 99,
        "status": "active",
        "createdAt": "2025-10-01 10:00:00"
      }
    ]
  }
}
```

### 5.2 打卡管理

#### 同步打卡数据
```
POST /api/admin/camps/{campId}/sync-checkin

响应：
{
  "code": 200,
  "message": "成功同步15条打卡记录",
  "data": [
    {
      "planetUserId": "123456",
      "planetNickname": "张三",
      "checkinCount": 8
    }
  ]
}
```

### 5.3 退款管理

#### 生成退款名单
```
POST /api/admin/camps/{campId}/refunds/generate

响应：
{
  "code": 200,
  "message": "成功生成15条退款记录",
  "data": [
    {
      "id": 1,
      "planetNickname": "张三",
      "checkinCount": 8,
      "isQualified": true,
      "refundAmount": 99,
      "manualApproved": true,
      "refundStatus": "pending"
    }
  ]
}
```

#### 人工审核
```
PUT /api/admin/refunds/{refundId}/audit

请求体：
{
  "approved": true  // true允许退款 / false拒绝退款
}

响应：
{
  "code": 200,
  "message": "审核成功"
}
```

#### 批量退款
```
POST /api/admin/camps/{campId}/refunds/batch

响应：
{
  "code": 200,
  "data": {
    "totalCount": 15,
    "successCount": 14,
    "failureCount": 1,
    "failureMessages": [
      "王五: 微信零钱余额不足"
    ]
  }
}
```

---

## 六、前端页面设计

### 6.1 页面结构

```
管理后台
├── 登录页（/login）
├── 首页（/dashboard）
└── 训练营管理
    ├── 训练营列表（/camps）
    ├── 创建训练营（/camps/create）
    ├── 训练营详情（/camps/:id）
    │   ├── 基本信息
    │   ├── 打卡数据管理
    │   │   ├── [同步打卡数据] 按钮
    │   │   └── 打卡记录表格
    │   └── 退款管理
    │       ├── [生成退款名单] 按钮
    │       ├── 退款记录表格（可审核）
    │       └── [批量退款] 按钮
    └── 系统配置（/settings）
        └── API配置（知识星球Cookie、企业微信密钥）
```

### 6.2 核心页面UI设计

#### 6.2.1 训练营详情 - 退款管理Tab

```vue
<template>
  <div class="refund-management">
    <!-- 操作按钮 -->
    <div class="actions">
      <el-button type="primary" @click="syncCheckin">同步打卡数据</el-button>
      <el-button type="success" @click="generateRefundList">生成退款名单</el-button>
      <el-button type="danger" @click="batchRefund" :disabled="!hasApprovedRefunds">批量退款</el-button>
    </div>

    <!-- 退款名单表格 -->
    <el-table :data="refundList" border>
      <el-table-column prop="planetNickname" label="星球昵称" />
      <el-table-column prop="checkinCount" label="打卡天数">
        <template #default="{ row }">
          {{ row.checkinCount }} / {{ campInfo.checkinDays }}
        </template>
      </el-table-column>
      <el-table-column prop="isQualified" label="是否合格">
        <template #default="{ row }">
          <el-tag :type="row.isQualified ? 'success' : 'danger'">
            {{ row.isQualified ? '✅ 合格' : '❌ 不合格' }}
          </el-tag>
        </template>
      </el-table-column>
      <el-table-column prop="refundAmount" label="退款金额" />
      <el-table-column prop="manualApproved" label="审核结果">
        <template #default="{ row }">
          <el-tag :type="row.manualApproved ? 'success' : 'info'">
            {{ row.manualApproved ? '允许退款' : '拒绝退款' }}
          </el-tag>
        </template>
      </el-table-column>
      <el-table-column prop="refundStatus" label="退款状态">
        <template #default="{ row }">
          <el-tag v-if="row.refundStatus === 'pending'">待退款</el-tag>
          <el-tag v-else-if="row.refundStatus === 'success'" type="success">已退款</el-tag>
          <el-tag v-else type="danger">退款失败</el-tag>
        </template>
      </el-table-column>
      <el-table-column label="操作" width="200">
        <template #default="{ row }">
          <el-button
            v-if="row.refundStatus === 'pending'"
            size="small"
            @click="toggleApproval(row)"
          >
            {{ row.manualApproved ? '拒绝' : '允许' }}
          </el-button>
          <el-button
            v-if="row.refundStatus === 'failed'"
            size="small"
            type="warning"
            @click="retryRefund(row)"
          >
            重试
          </el-button>
        </template>
      </el-table-column>
    </el-table>
  </div>
</template>
```

---

## 七、部署方案

### 7.1 部署环境

**推荐方案**：云服务器（阿里云/腾讯云）

- **配置**：2核4G（最低配置）
- **系统**：Ubuntu 22.04 LTS
- **域名**：camp-admin.yourdomain.com

### 7.2 部署步骤

#### 1. 安装依赖
```bash
# 安装Java
sudo apt install openjdk-17-jdk

# 安装PostgreSQL
sudo apt install postgresql-15

# 安装Nginx
sudo apt install nginx
```

#### 2. 部署后端
```bash
# 打包
mvn clean package -DskipTests

# 上传到服务器
scp target/camp-refund-0.0.1.jar root@server:/opt/camp-refund/

# 启动服务（使用systemd）
sudo systemctl start camp-refund
```

#### 3. 部署前端
```bash
# 构建
npm run build

# 上传到服务器
scp -r dist/* root@server:/var/www/camp-admin/

# 配置Nginx
sudo nano /etc/nginx/sites-available/camp-admin
```

**Nginx配置示例**：
```nginx
server {
    listen 80;
    server_name camp-admin.yourdomain.com;

    # 前端静态文件
    location / {
        root /var/www/camp-admin;
        try_files $uri $uri/ /index.html;
    }

    # 后端API代理
    location /api/ {
        proxy_pass http://localhost:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

---

## 八、关键技术问题解决方案

### 8.1 知识星球Cookie获取

**问题**：知识星球没有官方API，需要通过Cookie认证

**解决方案**：
1. 登录知识星球Web版（https://wx.zsxq.com/）
2. 打开浏览器开发者工具（F12）
3. 切换到Network标签
4. 刷新页面，找到任意API请求
5. 查看请求头中的Cookie值
6. 复制完整Cookie，配置到系统

**注意**：Cookie会过期（通常7-30天），需定期更新

### 8.2 企业微信退款API签名

**问题**：企业微信API需要复杂的签名算法

**解决方案**：使用官方SDK或参考官方文档实现签名
```java
public class WechatSignUtil {
    public static String sign(Map<String, Object> params, String apiKey) {
        // 1. 参数排序
        // 2. 拼接字符串
        // 3. SHA256加密
        // 4. Base64编码
        // 详见企业微信官方文档
    }
}
```

### 8.3 退款失败处理

**常见失败原因**：
- 微信零钱余额不足
- 订单号错误
- 退款金额超过原支付金额

**解决方案**：
1. 自动重试1次
2. 记录失败原因
3. 提供"重试"按钮
4. 管理员手工处理（去企业微信后台操作）

---

## 九、开发计划

### 9.1 阶段划分（预计7天）

| 阶段 | 时间 | 任务 |
|------|------|------|
| Day 1 | 1天 | 后端框架搭建、数据库初始化 |
| Day 2-3 | 2天 | 训练营CRUD、知识星球API集成、打卡数据同步 |
| Day 4-5 | 2天 | 退款逻辑、企业微信API集成 |
| Day 6 | 1天 | 前端页面开发 |
| Day 7 | 1天 | 联调测试、部署上线 |

### 9.2 验收标准

✅ **必须完成**：
1. 管理员能够创建训练营
2. 系统能够从知识星球获取打卡数据
3. 系统能够自动生成退款名单
4. 管理员能够审核退款名单
5. 系统能够批量调用企业微信退款API
6. 系统能够显示退款结果（成功/失败）

---

## 十、风险与限制

### 10.1 技术风险

| 风险 | 影响 | 应对措施 |
|------|------|----------|
| 知识星球Cookie过期 | API调用失败 | 提供Cookie更新界面，设置过期提醒 |
| 知识星球API变更 | 数据同步失败 | 降级方案：手动导入Excel |
| 企业微信退款失败 | 无法退款 | 记录失败原因，提供重试和手工处理 |

### 10.2 业务限制

- **手工匹配**：v0版本需要手工关联"知识星球用户"和"企业微信订单"
- **无自动化**：无定时任务，需管理员手动触发
- **单一角色**：仅支持管理员，无教练/志愿者权限

---

## 附录：参考资料

### A1. 知识星球API文档（非官方）
- 获取打卡数据：`GET /api/v4/topics/{topic_id}/checkins`
- 需要Cookie认证

### A2. 企业微信支付API文档（官方）
- 退款接口：https://pay.weixin.qq.com/wiki/doc/apiv3/apis/chapter3_1_9.shtml

### A3. 技术栈官方文档
- Spring Boot: https://spring.io/projects/spring-boot
- Vue 3: https://vuejs.org/
- Element Plus: https://element-plus.org/

---

**文档结束**
