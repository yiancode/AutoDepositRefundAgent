<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>知识星球训练营自动押金退款系统 - 原型展示</title>
    <link href="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0d1117;
            --bg-secondary: #161b22;
            --bg-tertiary: #21262d;
            --border-color: #30363d;
            --text-primary: #f0f6fc;
            --text-secondary: #8b949e;
            --text-muted: #6e7681;
            --accent-blue: #58a6ff;
            --accent-green: #3fb950;
            --accent-purple: #a371f7;
            --accent-orange: #d29922;
            --accent-red: #f85149;
            --accent-cyan: #39c5cf;
            --card-blue: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%);
            --card-green: linear-gradient(135deg, #1a4731 0%, #2d6a4f 100%);
            --card-purple: linear-gradient(135deg, #3d2066 0%, #5a3d7a 100%);
            --card-orange: linear-gradient(135deg, #5c3d1e 0%, #8b5a2b 100%);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }

        /* Login Page */
        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            position: relative;
            overflow: hidden;
        }

        .login-container::before {
            content: '';
            position: absolute;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(88, 166, 255, 0.1) 0%, transparent 50%);
            animation: pulse 15s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.2); }
        }

        .login-box {
            background: rgba(22, 27, 34, 0.95);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 48px;
            width: 420px;
            position: relative;
            z-index: 1;
            backdrop-filter: blur(10px);
        }

        .login-logo {
            text-align: center;
            margin-bottom: 32px;
        }

        .login-logo h1 {
            font-size: 24px;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .login-logo p {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: 8px;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 14px;
            transition: all 0.3s;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 3px rgba(88, 166, 255, 0.2);
        }

        .login-btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, var(--accent-blue), #3b82f6);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(88, 166, 255, 0.3);
        }

        .login-footer {
            text-align: center;
            margin-top: 24px;
            color: var(--text-muted);
            font-size: 12px;
        }

        /* Main Layout */
        .app-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 240px;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            position: fixed;
            height: 100vh;
            z-index: 100;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .sidebar-logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .sidebar-logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .sidebar-logo-text h2 {
            font-size: 16px;
            color: var(--text-primary);
        }

        .sidebar-logo-text span {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .sidebar-menu {
            flex: 1;
            padding: 16px 12px;
            overflow-y: auto;
        }

        .menu-section {
            margin-bottom: 24px;
        }

        .menu-section-title {
            font-size: 11px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 0 12px;
            margin-bottom: 8px;
        }

        .menu-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: 8px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 4px;
        }

        .menu-item:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .menu-item.active {
            background: rgba(88, 166, 255, 0.15);
            color: var(--accent-blue);
        }

        .menu-item-icon {
            width: 20px;
            text-align: center;
        }

        .menu-item-badge {
            margin-left: auto;
            background: var(--accent-red);
            color: white;
            font-size: 11px;
            padding: 2px 8px;
            border-radius: 10px;
        }

        .sidebar-footer {
            padding: 16px;
            border-top: 1px solid var(--border-color);
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: var(--bg-tertiary);
            border-radius: 8px;
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-cyan));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        .user-info h4 {
            font-size: 14px;
            color: var(--text-primary);
        }

        .user-info span {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 240px;
            display: flex;
            flex-direction: column;
        }

        /* Top Header */
        .top-header {
            height: 64px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 24px;
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .breadcrumb-item {
            color: var(--text-muted);
        }

        .breadcrumb-item.active {
            color: var(--text-primary);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .header-btn {
            width: 40px;
            height: 40px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            position: relative;
        }

        .header-btn:hover {
            background: var(--bg-primary);
            color: var(--text-primary);
        }

        .header-btn .badge {
            position: absolute;
            top: -4px;
            right: -4px;
            width: 18px;
            height: 18px;
            background: var(--accent-red);
            border-radius: 50%;
            font-size: 11px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Page Content */
        .page-content {
            flex: 1;
            padding: 24px;
            overflow-y: auto;
        }

        .page-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 24px;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 24px;
        }

        .stat-card {
            padding: 24px;
            border-radius: 12px;
            position: relative;
            overflow: hidden;
        }

        .stat-card.blue { background: var(--card-blue); }
        .stat-card.green { background: var(--card-green); }
        .stat-card.purple { background: var(--card-purple); }
        .stat-card.orange { background: var(--card-orange); }

        .stat-card::after {
            content: '';
            position: absolute;
            right: -20px;
            bottom: -20px;
            width: 100px;
            height: 100px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
        }

        .stat-icon {
            width: 48px;
            height: 48px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 16px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            color: white;
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 12px;
        }

        .stat-trend {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            font-size: 13px;
            padding: 4px 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
        }

        .stat-trend.up { color: #4ade80; }
        .stat-trend.down { color: #f87171; }

        /* Content Cards */
        .content-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            margin-bottom: 24px;
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px 24px;
            border-bottom: 1px solid var(--border-color);
        }

        .card-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .card-actions {
            display: flex;
            gap: 12px;
        }

        .card-body {
            padding: 24px;
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
        }

        .btn-primary {
            background: var(--accent-blue);
            color: white;
        }

        .btn-primary:hover {
            background: #4a9eff;
            transform: translateY(-1px);
        }

        .btn-success {
            background: var(--accent-green);
            color: white;
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
        }

        .btn-outline:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 13px;
        }

        /* Tables */
        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th {
            text-align: left;
            padding: 14px 16px;
            font-size: 12px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border-color);
        }

        .data-table td {
            padding: 16px;
            font-size: 14px;
            color: var(--text-primary);
            border-bottom: 1px solid var(--border-color);
        }

        .data-table tr:hover {
            background: rgba(88, 166, 255, 0.05);
        }

        .data-table .checkbox {
            width: 18px;
            height: 18px;
            accent-color: var(--accent-blue);
        }

        /* Status Badges */
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-badge.ongoing {
            background: rgba(63, 185, 80, 0.15);
            color: var(--accent-green);
        }

        .status-badge.upcoming {
            background: rgba(88, 166, 255, 0.15);
            color: var(--accent-blue);
        }

        .status-badge.ended {
            background: rgba(139, 148, 158, 0.15);
            color: var(--text-secondary);
        }

        .status-badge.pending {
            background: rgba(210, 153, 34, 0.15);
            color: var(--accent-orange);
        }

        .status-badge.success {
            background: rgba(63, 185, 80, 0.15);
            color: var(--accent-green);
        }

        .status-badge.failed {
            background: rgba(248, 81, 73, 0.15);
            color: var(--accent-red);
        }

        /* 新增训练营状态 - 根据技术方案 v1 */
        .status-badge.draft {
            background: rgba(139, 148, 158, 0.15);
            color: var(--text-muted);
        }

        .status-badge.enrolling {
            background: rgba(88, 166, 255, 0.15);
            color: var(--accent-blue);
        }

        .status-badge.settling {
            background: rgba(163, 113, 247, 0.15);
            color: var(--accent-purple);
        }

        .status-badge.archived {
            background: rgba(110, 118, 129, 0.15);
            color: var(--text-muted);
        }

        .status-badge.cancelled {
            background: rgba(248, 81, 73, 0.15);
            color: var(--accent-red);
        }

        /* 支付映射绑定状态 - 根据技术方案 v1 */
        .status-badge.bind-pending {
            background: rgba(210, 153, 34, 0.15);
            color: var(--accent-orange);
        }

        .status-badge.bind-completed {
            background: rgba(63, 185, 80, 0.15);
            color: var(--accent-green);
        }

        .status-badge.bind-expired {
            background: rgba(248, 81, 73, 0.15);
            color: var(--accent-red);
        }

        .status-badge.bind-manual {
            background: rgba(163, 113, 247, 0.15);
            color: var(--accent-purple);
        }

        .status-badge.bind-closed {
            background: rgba(110, 118, 129, 0.15);
            color: var(--text-muted);
        }

        /* 绑定方式标签 */
        .method-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
        }

        .method-badge.dynamic-qrcode {
            background: rgba(63, 185, 80, 0.15);
            color: var(--accent-green);
        }

        .method-badge.user-fill {
            background: rgba(88, 166, 255, 0.15);
            color: var(--accent-blue);
        }

        .method-badge.smart-match {
            background: rgba(163, 113, 247, 0.15);
            color: var(--accent-purple);
        }

        .method-badge.manual {
            background: rgba(210, 153, 34, 0.15);
            color: var(--accent-orange);
        }

        /* Progress Bar */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-cyan));
            border-radius: 4px;
            transition: width 0.3s;
        }

        .progress-text {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 4px;
        }

        /* Filters */
        .filters-bar {
            display: flex;
            gap: 16px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-label {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .filter-select {
            padding: 8px 12px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 13px;
            cursor: pointer;
        }

        .filter-input {
            padding: 8px 12px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 13px;
            width: 200px;
        }

        /* Charts Container */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 24px;
            margin-bottom: 24px;
        }

        .chart-container {
            height: 300px;
        }

        /* Pagination */
        .pagination {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 0;
        }

        .pagination-info {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .pagination-buttons {
            display: flex;
            gap: 8px;
        }

        .page-btn {
            min-width: 36px;
            height: 36px;
            padding: 0 12px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-secondary);
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .page-btn:hover {
            background: var(--bg-primary);
            color: var(--text-primary);
        }

        .page-btn.active {
            background: var(--accent-blue);
            border-color: var(--accent-blue);
            color: white;
        }

        /* Todo Items */
        .todo-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .todo-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            background: var(--bg-tertiary);
            border-radius: 8px;
            border-left: 3px solid var(--accent-orange);
        }

        .todo-item.urgent {
            border-left-color: var(--accent-red);
        }

        .todo-icon {
            width: 36px;
            height: 36px;
            background: rgba(210, 153, 34, 0.15);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--accent-orange);
        }

        .todo-item.urgent .todo-icon {
            background: rgba(248, 81, 73, 0.15);
            color: var(--accent-red);
        }

        .todo-content h4 {
            font-size: 14px;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .todo-content span {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* Quick Actions */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
        }

        .quick-action-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            padding: 24px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .quick-action-btn:hover {
            background: var(--bg-primary);
            border-color: var(--accent-blue);
            transform: translateY(-2px);
        }

        .quick-action-icon {
            width: 48px;
            height: 48px;
            background: rgba(88, 166, 255, 0.15);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: var(--accent-blue);
        }

        .quick-action-btn span {
            font-size: 14px;
            color: var(--text-primary);
        }

        /* Page Navigation */
        .page-nav {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .page-nav-item {
            padding: 8px 16px;
            font-size: 14px;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s;
        }

        .page-nav-item:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .page-nav-item.active {
            background: rgba(88, 166, 255, 0.15);
            color: var(--accent-blue);
        }

        /* Hide all pages by default */
        .page { display: none; }
        .page.active { display: block; }

        /* Confidence indicator */
        .confidence {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            font-size: 12px;
        }

        .confidence-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .confidence.high .confidence-dot { background: var(--accent-green); }
        .confidence.medium .confidence-dot { background: var(--accent-orange); }
        .confidence.low .confidence-dot { background: var(--accent-red); }

        /* Action buttons in table */
        .action-btns {
            display: flex;
            gap: 8px;
        }

        .action-btn {
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 4px;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
        }

        .action-btn.view {
            background: rgba(88, 166, 255, 0.15);
            color: var(--accent-blue);
        }

        .action-btn.approve {
            background: rgba(63, 185, 80, 0.15);
            color: var(--accent-green);
        }

        .action-btn.reject {
            background: rgba(248, 81, 73, 0.15);
            color: var(--accent-red);
        }

        .action-btn:hover {
            transform: translateY(-1px);
        }

        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 18px;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .empty-state p {
            color: var(--text-secondary);
            font-size: 14px;
        }

        /* Modal Overlay */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            display: none;
            align-items: flex-start;
            justify-content: center;
            padding: 40px;
            overflow-y: auto;
        }

        .modal-overlay.active {
            display: flex;
        }

        /* Drawer Overlay */
        .drawer-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            display: none;
        }

        .drawer-overlay.active {
            display: block;
        }

        .drawer-container {
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            width: 600px;
            max-width: 90%;
            background: var(--bg-secondary);
            box-shadow: -4px 0 20px rgba(0, 0, 0, 0.3);
            z-index: 1001;
            display: flex;
            flex-direction: column;
            animation: drawerSlideIn 0.3s ease;
        }

        @keyframes drawerSlideIn {
            from {
                transform: translateX(100%);
            }
            to {
                transform: translateX(0);
            }
        }

        .drawer-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px 24px;
            border-bottom: 1px solid var(--border-color);
            flex-shrink: 0;
        }

        .drawer-header h2 {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
        }

        .drawer-close {
            width: 32px;
            height: 32px;
            background: var(--bg-tertiary);
            border: none;
            border-radius: 8px;
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            transition: all 0.2s;
        }

        .drawer-close:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .drawer-body {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
        }

        .drawer-footer {
            padding: 16px 24px;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            flex-shrink: 0;
        }

        /* Modal / Drawer */
        .modal {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            width: 800px;
            max-width: 100%;
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px 24px;
            border-bottom: 1px solid var(--border-color);
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .modal-close {
            width: 32px;
            height: 32px;
            background: var(--bg-tertiary);
            border: none;
            border-radius: 8px;
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.2s;
        }

        .modal-close:hover {
            background: var(--bg-primary);
            color: var(--text-primary);
        }

        .modal-body {
            padding: 24px;
            max-height: 70vh;
            overflow-y: auto;
        }

        .modal-footer {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 12px;
            padding: 20px 24px;
            border-top: 1px solid var(--border-color);
        }

        /* Form Styles */
        .form-section {
            margin-bottom: 24px;
        }

        .form-section-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-section-title .icon {
            font-size: 16px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 16px;
        }

        .form-row.single {
            grid-template-columns: 1fr;
        }

        .form-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-label {
            font-size: 13px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .form-label .required {
            color: var(--accent-red);
        }

        .form-control {
            padding: 10px 14px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 14px;
            transition: all 0.2s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 3px rgba(88, 166, 255, 0.15);
        }

        .form-control::placeholder {
            color: var(--text-muted);
        }

        textarea.form-control {
            min-height: 100px;
            resize: vertical;
        }

        select.form-control {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%238b949e' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            padding-right: 36px;
        }

        /* Radio Group */
        .radio-group {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
        }

        .radio-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .radio-item:hover {
            border-color: var(--accent-blue);
        }

        .radio-item.active {
            background: rgba(88, 166, 255, 0.15);
            border-color: var(--accent-blue);
        }

        .radio-item input {
            display: none;
        }

        .radio-dot {
            width: 16px;
            height: 16px;
            border: 2px solid var(--border-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .radio-item.active .radio-dot {
            border-color: var(--accent-blue);
        }

        .radio-dot::after {
            content: '';
            width: 8px;
            height: 8px;
            background: var(--accent-blue);
            border-radius: 50%;
            transform: scale(0);
            transition: all 0.2s;
        }

        .radio-item.active .radio-dot::after {
            transform: scale(1);
        }

        .radio-label {
            font-size: 14px;
            color: var(--text-primary);
        }

        /* Checkbox Group */
        .checkbox-group {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 14px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .checkbox-item:hover {
            border-color: var(--accent-blue);
        }

        .checkbox-item.active {
            background: rgba(88, 166, 255, 0.15);
            border-color: var(--accent-blue);
        }

        .checkbox-item input {
            display: none;
        }

        .checkbox-box {
            width: 16px;
            height: 16px;
            border: 2px solid var(--border-color);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            font-size: 10px;
            color: transparent;
        }

        .checkbox-item.active .checkbox-box {
            border-color: var(--accent-blue);
            background: var(--accent-blue);
            color: white;
        }

        /* Number Input with Unit */
        .input-with-unit {
            display: flex;
            align-items: center;
        }

        .input-with-unit .form-control {
            border-radius: 8px 0 0 8px;
            flex: 1;
        }

        .input-unit {
            padding: 10px 14px;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-left: none;
            border-radius: 0 8px 8px 0;
            color: var(--text-secondary);
            font-size: 14px;
        }

        /* Conditional Fields */
        .conditional-field {
            margin-top: 12px;
            padding: 12px;
            background: var(--bg-primary);
            border-radius: 8px;
            display: none;
        }

        .conditional-field.active {
            display: block;
        }

        /* AI Generate Button */
        .ai-generate-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: linear-gradient(135deg, #a371f7, #58a6ff);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .ai-generate-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(163, 113, 247, 0.4);
        }

        .ai-generate-btn .sparkle {
            animation: sparkle 1.5s infinite;
        }

        @keyframes sparkle {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Poster Upload */
        .poster-upload {
            display: flex;
            gap: 16px;
            align-items: flex-start;
        }

        .poster-preview {
            width: 200px;
            height: 280px;
            background: var(--bg-tertiary);
            border: 2px dashed var(--border-color);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .poster-preview:hover {
            border-color: var(--accent-blue);
            background: rgba(88, 166, 255, 0.05);
        }

        .poster-preview.has-image {
            border-style: solid;
            background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 50%, #3d2066 100%);
        }

        .poster-preview-icon {
            font-size: 48px;
            color: var(--text-muted);
        }

        .poster-preview-text {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .poster-actions {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        /* Form Help Text */
        .form-help {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 4px;
        }

        /* Preview Card */
        .preview-card {
            background: var(--bg-tertiary);
            border-radius: 12px;
            padding: 16px;
            margin-top: 12px;
        }

        .preview-card-title {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .preview-card-content {
            font-size: 14px;
            color: var(--text-primary);
            line-height: 1.6;
            white-space: pre-wrap;
        }

        /* Steps Indicator */
        .steps-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .step-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .step-number {
            width: 28px;
            height: 28px;
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .step-item.active .step-number {
            background: var(--accent-blue);
            border-color: var(--accent-blue);
            color: white;
        }

        .step-item.completed .step-number {
            background: var(--accent-green);
            border-color: var(--accent-green);
            color: white;
        }

        .step-label {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .step-item.active .step-label {
            color: var(--text-primary);
        }

        .step-divider {
            width: 40px;
            height: 2px;
            background: var(--border-color);
        }

        .step-item.completed + .step-divider {
            background: var(--accent-green);
        }

        /* Checkin Tab Styles */
        .checkin-tab {
            display: none;
        }

        .checkin-tab.active {
            display: block;
        }

        /* Calendar Stat Day */
        .calendar-stat-day {
            padding: 12px 8px;
            background: var(--bg-tertiary);
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .calendar-stat-day:hover {
            background: var(--bg-primary);
            transform: translateY(-2px);
        }

        .calendar-stat-day .day-num {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .calendar-stat-day .day-count {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .calendar-stat-day.high {
            background: rgba(63, 185, 80, 0.15);
        }

        .calendar-stat-day.high .day-count {
            color: var(--accent-green);
        }

        .calendar-stat-day.low {
            background: rgba(248, 81, 73, 0.15);
        }

        .calendar-stat-day.low .day-count {
            color: var(--accent-red);
        }

        .calendar-stat-day.today {
            border: 2px solid var(--accent-blue);
        }

        .calendar-stat-day.future {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .calendar-stat-day.future:hover {
            transform: none;
        }

        /* Mini Day for Progress Ranking */
        .mini-day {
            width: 12px;
            height: 12px;
            border-radius: 2px;
            background: var(--bg-tertiary);
            display: inline-block;
        }

        .mini-day.checked {
            background: var(--accent-green);
        }

        .mini-day.missed {
            background: var(--accent-red);
        }

        /* Checkin Detail Drawer Styles */
        .checkin-calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
            margin-top: 16px;
        }

        .checkin-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            font-size: 14px;
            background: var(--bg-tertiary);
            position: relative;
        }

        .checkin-day.checked {
            background: rgba(63, 185, 80, 0.2);
            color: var(--accent-green);
        }

        .checkin-day.checked::after {
            content: '✓';
            position: absolute;
            top: 2px;
            right: 4px;
            font-size: 10px;
        }

        .checkin-day.missed {
            background: rgba(248, 81, 73, 0.2);
            color: var(--accent-red);
        }

        .checkin-day.missed::after {
            content: '✗';
            position: absolute;
            top: 2px;
            right: 4px;
            font-size: 10px;
        }

        .checkin-day.future {
            background: var(--bg-primary);
            color: var(--text-muted);
        }

        /* Checkin Record Item */
        .checkin-record-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 12px 16px;
            background: var(--bg-tertiary);
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .checkin-record-date {
            width: 80px;
            text-align: center;
        }

        .checkin-record-date .date {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .checkin-record-date .day {
            font-size: 12px;
            color: var(--text-muted);
        }

        .checkin-record-status {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .checkin-record-status.checked {
            background: rgba(63, 185, 80, 0.2);
            color: var(--accent-green);
        }

        .checkin-record-status.missed {
            background: rgba(248, 81, 73, 0.2);
            color: var(--accent-red);
        }

        .checkin-record-content {
            flex: 1;
        }

        .checkin-record-time {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .checkin-record-preview {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 300px;
        }

        /* Member Detail Tab */
        .member-detail-tab {
            display: none;
        }

        .member-detail-tab.active {
            display: block;
        }

        /* Match User Item */
        .match-user-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            cursor: pointer;
            transition: background 0.2s;
            border-bottom: 1px solid var(--border-color);
        }

        .match-user-item:last-child {
            border-bottom: none;
        }

        .match-user-item:hover {
            background: var(--bg-tertiary);
        }

        .match-user-item.selected {
            background: rgba(63, 185, 80, 0.1);
            border-left: 3px solid var(--accent-green);
        }

        /* Member Status Badges in Table */
        .confidence-high {
            color: var(--accent-green);
            font-weight: 600;
        }

        .confidence-medium {
            color: var(--accent-orange);
            font-weight: 600;
        }

        .confidence-low {
            color: var(--accent-red);
            font-weight: 600;
        }

        /* Refund Tab Styles */
        .refund-tab {
            display: none;
        }

        .refund-tab.active {
            display: block;
        }

        /* Refund Status Badges */
        .status-badge.rejected {
            background: rgba(248, 81, 73, 0.15);
            color: var(--accent-red);
        }

        .status-badge.failed {
            background: rgba(248, 81, 73, 0.15);
            color: var(--accent-red);
        }

        /* Judgment Badge Styles */
        .judgment-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .judgment-badge.qualified {
            background: rgba(63, 185, 80, 0.15);
            color: var(--accent-green);
        }

        .judgment-badge.review {
            background: rgba(227, 179, 65, 0.15);
            color: var(--accent-orange);
        }

        .judgment-badge.unqualified {
            background: rgba(248, 81, 73, 0.15);
            color: var(--accent-red);
        }

        /* Refund Detail Styles */
        .refund-info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 20px;
        }

        .refund-info-item {
            background: var(--bg-tertiary);
            padding: 16px;
            border-radius: 8px;
        }

        .refund-info-item .label {
            font-size: 12px;
            color: var(--text-muted);
            margin-bottom: 4px;
        }

        .refund-info-item .value {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .refund-info-item .value.amount {
            color: var(--accent-green);
        }

        /* Operation Log Styles */
        .operation-log {
            margin-top: 20px;
        }

        .log-item {
            display: flex;
            gap: 12px;
            padding: 12px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .log-item:last-child {
            border-bottom: none;
        }

        .log-icon {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--bg-tertiary);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .log-content {
            flex: 1;
        }

        .log-title {
            font-size: 14px;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .log-meta {
            font-size: 12px;
            color: var(--text-muted);
        }

        /* Reject Modal Styles */
        .reject-reason-input {
            width: 100%;
            min-height: 100px;
            padding: 12px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 14px;
            resize: vertical;
        }

        .reject-reason-input:focus {
            outline: none;
            border-color: var(--accent-blue);
        }

        .reject-quick-reasons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 12px;
        }

        .quick-reason-btn {
            padding: 6px 12px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            color: var(--text-secondary);
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .quick-reason-btn:hover {
            background: var(--bg-hover);
            border-color: var(--accent-blue);
            color: var(--accent-blue);
        }

        /* System Management Styles */
        .system-tab {
            display: none;
        }

        .system-tab.active {
            display: block;
        }

        /* Role badges */
        .role-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .role-badge.super-admin {
            background: rgba(163, 113, 247, 0.15);
            color: var(--accent-purple);
        }

        .role-badge.admin {
            background: rgba(88, 166, 255, 0.15);
            color: var(--accent-blue);
        }

        .role-badge.coach {
            background: rgba(63, 185, 80, 0.15);
            color: var(--accent-green);
        }

        .role-badge.volunteer {
            background: rgba(210, 153, 34, 0.15);
            color: var(--accent-orange);
        }

        /* Config form styles */
        .config-form {
            max-width: 800px;
        }

        .config-item {
            margin-bottom: 20px;
        }

        .config-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .config-label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .config-input {
            max-width: 400px;
        }

        .config-input.readonly {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
        }

        .config-input-group {
            display: flex;
            gap: 8px;
            max-width: 400px;
        }

        .config-input-group .form-control {
            flex: 1;
        }

        .config-help {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 6px;
        }

        .config-actions {
            display: flex;
            gap: 12px;
            margin-top: 24px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }

        .config-icon {
            margin-right: 8px;
        }

        .config-status {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 13px;
            padding: 4px 12px;
            border-radius: 12px;
        }

        .config-status.connected {
            background: rgba(63, 185, 80, 0.15);
            color: var(--accent-green);
        }

        .config-status.disconnected {
            background: rgba(248, 81, 73, 0.15);
            color: var(--accent-red);
        }

        .config-status .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: currentColor;
        }

        .config-switch-row {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 20px;
        }

        .config-switch-info {
            flex: 1;
        }

        /* Toggle Switch */
        .switch {
            position: relative;
            display: inline-block;
            width: 48px;
            height: 26px;
            flex-shrink: 0;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--bg-tertiary);
            transition: .3s;
            border-radius: 26px;
            border: 1px solid var(--border-color);
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 2px;
            bottom: 2px;
            background-color: white;
            transition: .3s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--accent-blue);
            border-color: var(--accent-blue);
        }

        input:checked + .slider:before {
            transform: translateX(22px);
        }

        /* Notify receivers */
        .notify-receivers {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        /* Log type badges */
        .log-type-badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 11px;
            font-weight: 500;
        }

        .log-type-badge.camp {
            background: rgba(88, 166, 255, 0.15);
            color: var(--accent-blue);
        }

        .log-type-badge.member {
            background: rgba(63, 185, 80, 0.15);
            color: var(--accent-green);
        }

        .log-type-badge.refund {
            background: rgba(210, 153, 34, 0.15);
            color: var(--accent-orange);
        }

        .log-type-badge.system {
            background: rgba(163, 113, 247, 0.15);
            color: var(--accent-purple);
        }

        .log-type-badge.login {
            background: rgba(57, 197, 207, 0.15);
            color: var(--accent-cyan);
        }

        /* Delete button style */
        .action-btn.delete {
            color: var(--accent-red);
        }

        .action-btn.delete:hover {
            background: rgba(248, 81, 73, 0.15);
        }

        /* Button icon */
        .btn-icon {
            margin-right: 6px;
        }
    </style>
</head>
<body>
    <!-- Login Page -->
    <div class="login-container" id="loginPage">
        <div class="login-box">
            <div class="login-logo">
                <h1>知识星球训练营</h1>
                <p>自动押金退款管理系统</p>
            </div>
            <form id="loginForm">
                <div class="form-group">
                    <label>用户名</label>
                    <input type="text" class="form-input" placeholder="请输入用户名" value="admin">
                </div>
                <div class="form-group">
                    <label>密码</label>
                    <input type="password" class="form-input" placeholder="请输入密码" value="123456">
                </div>
                <button type="submit" class="login-btn">登 录</button>
            </form>
            <div class="login-footer">
                © 2025 知识星球训练营管理系统 v1.0
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div class="app-container" id="appContainer" style="display: none;">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <div class="sidebar-logo-icon">🏕️</div>
                    <div class="sidebar-logo-text">
                        <h2>训练营系统</h2>
                        <span>管理后台 v1.0</span>
                    </div>
                </div>
            </div>
            <nav class="sidebar-menu">
                <div class="menu-section">
                    <div class="menu-section-title">概览</div>
                    <div class="menu-item active" data-page="dashboard">
                        <span class="menu-item-icon">📊</span>
                        <span>工作台</span>
                    </div>
                </div>
                <div class="menu-section">
                    <div class="menu-section-title">业务管理</div>
                    <div class="menu-item" data-page="camps">
                        <span class="menu-item-icon">🏕️</span>
                        <span>训练营管理</span>
                    </div>
                    <div class="menu-item" data-page="members">
                        <span class="menu-item-icon">👥</span>
                        <span>会员管理</span>
                    </div>
                    <div class="menu-item" data-page="checkins">
                        <span class="menu-item-icon">📝</span>
                        <span>打卡管理</span>
                    </div>
                    <div class="menu-item" data-page="payments">
                        <span class="menu-item-icon">💳</span>
                        <span>支付映射</span>
                        <span class="menu-item-badge">5</span>
                    </div>
                    <div class="menu-item" data-page="refunds">
                        <span class="menu-item-icon">💰</span>
                        <span>退款审核</span>
                        <span class="menu-item-badge">12</span>
                    </div>
                </div>
                <div class="menu-section">
                    <div class="menu-section-title">数据分析</div>
                    <div class="menu-item" data-page="statistics">
                        <span class="menu-item-icon">📈</span>
                        <span>统计报表</span>
                    </div>
                </div>
                <div class="menu-section">
                    <div class="menu-section-title">系统设置</div>
                    <div class="menu-item" data-page="system">
                        <span class="menu-item-icon">⚙️</span>
                        <span>系统管理</span>
                    </div>
                </div>
            </nav>
            <div class="sidebar-footer">
                <div class="user-profile">
                    <div class="user-avatar">管</div>
                    <div class="user-info">
                        <h4>超级管理员</h4>
                        <span>admin@camp.com</span>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Top Header -->
            <header class="top-header">
                <div class="breadcrumb">
                    <span class="breadcrumb-item">首页</span>
                    <span>/</span>
                    <span class="breadcrumb-item active" id="currentPage">工作台</span>
                </div>
                <div class="header-actions">
                    <button class="header-btn">
                        <span>🔔</span>
                        <span class="badge">3</span>
                    </button>
                    <button class="header-btn">
                        <span>⚙️</span>
                    </button>
                    <button class="header-btn" onclick="logout()">
                        <span>🚪</span>
                    </button>
                </div>
            </header>

            <!-- Page Content -->
            <div class="page-content">
                <!-- Dashboard Page -->
                <div class="page active" id="dashboardPage">
                    <h1 class="page-title">工作台</h1>

                    <!-- Stats Cards -->
                    <div class="stats-grid">
                        <div class="stat-card blue">
                            <div class="stat-icon">🏕️</div>
                            <div class="stat-value">156</div>
                            <div class="stat-label">训练营总数</div>
                            <span class="stat-trend up">↑ 12 本月新增</span>
                        </div>
                        <div class="stat-card green">
                            <div class="stat-icon">👥</div>
                            <div class="stat-value">3,542</div>
                            <div class="stat-label">会员总数</div>
                            <span class="stat-trend up">↑ 89 本月新增</span>
                        </div>
                        <div class="stat-card purple">
                            <div class="stat-icon">💰</div>
                            <div class="stat-value">¥27.5K</div>
                            <div class="stat-label">本月净收入</div>
                            <span class="stat-trend up">↑ 15.2%</span>
                        </div>
                        <div class="stat-card orange">
                            <div class="stat-icon">✅</div>
                            <div class="stat-value">85%</div>
                            <div class="stat-label">平均完成率</div>
                            <span class="stat-trend up">↑ 3.5%</span>
                        </div>
                    </div>

                    <!-- Charts -->
                    <div class="charts-grid">
                        <div class="content-card">
                            <div class="card-header">
                                <h3 class="card-title">收入趋势</h3>
                                <div class="card-actions">
                                    <select class="filter-select">
                                        <option>近7天</option>
                                        <option>近30天</option>
                                        <option>近90天</option>
                                    </select>
                                </div>
                            </div>
                            <div class="card-body">
                                <div id="incomeChart" class="chart-container"></div>
                            </div>
                        </div>
                        <div class="content-card">
                            <div class="card-header">
                                <h3 class="card-title">完成率分布</h3>
                            </div>
                            <div class="card-body">
                                <div id="completionChart" class="chart-container"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Todo Items -->
                    <div class="content-card">
                        <div class="card-header">
                            <h3 class="card-title">待办事项</h3>
                            <button class="btn btn-outline btn-sm">查看全部</button>
                        </div>
                        <div class="card-body">
                            <div class="todo-list">
                                <div class="todo-item urgent">
                                    <div class="todo-icon">⚠️</div>
                                    <div class="todo-content">
                                        <h4>12 个退款待审核</h4>
                                        <span>「21天早起训练营」已结束，请及时处理退款申请</span>
                                    </div>
                                    <button class="btn btn-primary btn-sm">立即处理</button>
                                </div>
                                <div class="todo-item">
                                    <div class="todo-icon">📋</div>
                                    <div class="todo-content">
                                        <h4>5 个训练营即将结束</h4>
                                        <span>请提前准备退款审核工作</span>
                                    </div>
                                    <button class="btn btn-outline btn-sm">查看详情</button>
                                </div>
                                <div class="todo-item">
                                    <div class="todo-icon">🔗</div>
                                    <div class="todo-content">
                                        <h4>3 个会员待匹配</h4>
                                        <span>系统无法自动匹配，需人工确认</span>
                                    </div>
                                    <button class="btn btn-outline btn-sm">手动匹配</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="content-card">
                        <div class="card-header">
                            <h3 class="card-title">快捷操作</h3>
                        </div>
                        <div class="card-body">
                            <div class="quick-actions">
                                <div class="quick-action-btn" onclick="openCreateCampModal()">
                                    <div class="quick-action-icon">➕</div>
                                    <span>创建训练营</span>
                                </div>
                                <div class="quick-action-btn" onclick="showPage('refunds')">
                                    <div class="quick-action-icon">💰</div>
                                    <span>处理退款</span>
                                </div>
                                <div class="quick-action-btn" onclick="showPage('statistics')">
                                    <div class="quick-action-icon">📊</div>
                                    <span>查看报表</span>
                                </div>
                                <div class="quick-action-btn" onclick="showPage('system')">
                                    <div class="quick-action-icon">⚙️</div>
                                    <span>系统配置</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Camps Page -->
                <div class="page" id="campsPage">
                    <h1 class="page-title">训练营管理</h1>

                    <div class="content-card">
                        <div class="card-header">
                            <h3 class="card-title">训练营列表</h3>
                            <button class="btn btn-primary" onclick="openCreateCampModal()">+ 创建训练营</button>
                        </div>
                        <div class="card-body">
                            <div class="filters-bar">
                                <div class="filter-group">
                                    <span class="filter-label">状态：</span>
                                    <select class="filter-select" id="campStatusFilter">
                                        <option value="">全部</option>
                                        <option value="draft">草稿</option>
                                        <option value="pending">待发布</option>
                                        <option value="enrolling">报名中</option>
                                        <option value="ongoing">进行中</option>
                                        <option value="ended">已结束</option>
                                        <option value="settling">结算中</option>
                                        <option value="archived">已归档</option>
                                        <option value="cancelled">已取消</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <span class="filter-label">时间：</span>
                                    <select class="filter-select">
                                        <option>本月</option>
                                        <option>上月</option>
                                        <option>近三个月</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <input type="text" class="filter-input" placeholder="搜索训练营名称...">
                                </div>
                                <button class="btn btn-outline btn-sm">🔍 搜索</button>
                            </div>

                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>训练营名称</th>
                                        <th>押金</th>
                                        <th>时间范围</th>
                                        <th>打卡要求</th>
                                        <th>报名人数</th>
                                        <th>状态</th>
                                        <th>操作</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                            <strong>21天早起训练营</strong>
                                            <br><small style="color: var(--text-muted);">ID: 12345</small>
                                        </td>
                                        <td>¥99</td>
                                        <td>2025-01-01 ~ 2025-01-21</td>
                                        <td>21天15打卡</td>
                                        <td>156 / 200</td>
                                        <td><span class="status-badge ongoing">● 进行中</span></td>
                                        <td>
                                            <div class="action-btns">
                                                <button class="action-btn view" onclick="viewCampDetail(12345)">查看</button>
                                                <button class="action-btn view" onclick="editCamp(12345)">编辑</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <strong>7天读书打卡营</strong>
                                            <br><small style="color: var(--text-muted);">ID: 12346</small>
                                        </td>
                                        <td>¥49</td>
                                        <td>2025-01-15 ~ 2025-01-22</td>
                                        <td>7天5打卡</td>
                                        <td>89 / 100</td>
                                        <td><span class="status-badge enrolling">● 报名中</span></td>
                                        <td>
                                            <div class="action-btns">
                                                <button class="action-btn view" onclick="viewCampDetail(12346)">查看</button>
                                                <button class="action-btn view" onclick="editCamp(12346)">编辑</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <strong>30天健身打卡营</strong>
                                            <br><small style="color: var(--text-muted);">ID: 12344</small>
                                        </td>
                                        <td>¥199</td>
                                        <td>2024-12-01 ~ 2024-12-30</td>
                                        <td>30天20打卡</td>
                                        <td>234 / 300</td>
                                        <td><span class="status-badge settling">● 结算中</span></td>
                                        <td>
                                            <div class="action-btns">
                                                <button class="action-btn view" onclick="viewCampDetail(12344)">查看</button>
                                                <button class="action-btn approve" onclick="settleCamp(12344)">退款审核</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <strong>14天冥想训练营</strong>
                                            <br><small style="color: var(--text-muted);">ID: 12347</small>
                                        </td>
                                        <td>¥79</td>
                                        <td>2025-02-01 ~ 2025-02-14</td>
                                        <td>14天10打卡</td>
                                        <td>0 / 150</td>
                                        <td><span class="status-badge draft">● 草稿</span></td>
                                        <td>
                                            <div class="action-btns">
                                                <button class="action-btn view" onclick="editCamp(12347)">编辑</button>
                                                <button class="action-btn approve" onclick="publishCamp(12347)">发布</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <strong>60天英语学习营</strong>
                                            <br><small style="color: var(--text-muted);">ID: 12343</small>
                                        </td>
                                        <td>¥299</td>
                                        <td>2024-10-01 ~ 2024-11-30</td>
                                        <td>60天45打卡</td>
                                        <td>189 / 200</td>
                                        <td><span class="status-badge archived">● 已归档</span></td>
                                        <td>
                                            <div class="action-btns">
                                                <button class="action-btn view" onclick="viewCampDetail(12343)">查看</button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                            <div class="pagination">
                                <div class="pagination-info">共 156 条记录</div>
                                <div class="pagination-buttons">
                                    <button class="page-btn">‹</button>
                                    <button class="page-btn active">1</button>
                                    <button class="page-btn">2</button>
                                    <button class="page-btn">3</button>
                                    <button class="page-btn">...</button>
                                    <button class="page-btn">16</button>
                                    <button class="page-btn">›</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Members Page -->
                <div class="page" id="membersPage">
                    <h1 class="page-title">会员管理</h1>

                    <div class="content-card">
                        <div class="card-header">
                            <h3 class="card-title">会员列表</h3>
                            <button class="btn btn-outline btn-sm" onclick="exportMemberList()">📥 导出</button>
                        </div>
                        <div class="card-body">
                            <div class="filters-bar">
                                <div class="filter-group">
                                    <span class="filter-label">训练营：</span>
                                    <select class="filter-select" id="memberCampFilter" onchange="filterMembers()">
                                        <option value="">全部</option>
                                        <option value="12345">21天早起训练营</option>
                                        <option value="12346">7天读书打卡营</option>
                                        <option value="12344">30天健身打卡营</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <span class="filter-label">绑定状态：</span>
                                    <select class="filter-select" id="memberBindStatusFilter" onchange="filterMembers()">
                                        <option value="">全部</option>
                                        <option value="completed">已绑定</option>
                                        <option value="pending">待绑定</option>
                                        <option value="expired">已过期</option>
                                        <option value="manual_required">需人工</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <span class="filter-label">绑定方式：</span>
                                    <select class="filter-select" id="memberBindMethodFilter" onchange="filterMembers()">
                                        <option value="">全部</option>
                                        <option value="dynamic_qrcode">动态二维码</option>
                                        <option value="user_fill">用户填写</option>
                                        <option value="smart_match">智能匹配</option>
                                        <option value="manual">人工绑定</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <input type="text" class="filter-input" placeholder="搜索星球昵称/ID..." id="memberSearchInput">
                                </div>
                                <button class="btn btn-outline btn-sm" onclick="filterMembers()">🔍 搜索</button>
                                <button class="btn btn-outline btn-sm" onclick="resetMemberFilters()">重置</button>
                            </div>

                            <table class="data-table" id="memberTable">
                                <thead>
                                    <tr>
                                        <th>星球昵称</th>
                                        <th>星球ID</th>
                                        <th>微信昵称</th>
                                        <th>训练营</th>
                                        <th>绑定状态</th>
                                        <th>绑定方式</th>
                                        <th>匹配置信度</th>
                                        <th>操作</th>
                                    </tr>
                                </thead>
                                <tbody id="memberTableBody">
                                    <tr onclick="viewMemberDetail('M001')" data-match-status="matched">
                                        <td>球球的副业探索</td>
                                        <td>88455815</td>
                                        <td>小球球</td>
                                        <td>21天早起训练营</td>
                                        <td><span class="status-badge bind-completed">● 已绑定</span></td>
                                        <td><span class="method-badge dynamic-qrcode">📱 动态二维码</span></td>
                                        <td>
                                            <div class="confidence high">
                                                <span class="confidence-dot"></span>
                                                <span>100%</span>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="action-btns">
                                                <button class="action-btn view" onclick="event.stopPropagation(); viewMemberDetail('M001')">详情</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr onclick="viewMemberDetail('M002')" data-match-status="pending">
                                        <td>爱学习的小明</td>
                                        <td>88123457</td>
                                        <td>小明同学</td>
                                        <td>21天早起训练营</td>
                                        <td><span class="status-badge bind-completed">● 已绑定</span></td>
                                        <td><span class="method-badge user-fill">✍️ 用户填写</span></td>
                                        <td>
                                            <div class="confidence high">
                                                <span class="confidence-dot"></span>
                                                <span>95%</span>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="action-btns">
                                                <button class="action-btn view" onclick="event.stopPropagation(); viewMemberDetail('M002')">详情</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr onclick="viewMemberDetail('M003')" data-match-status="pending">
                                        <td>努力工作的小红</td>
                                        <td>88123456</td>
                                        <td>小红</td>
                                        <td>21天早起训练营</td>
                                        <td><span class="status-badge bind-completed">● 已绑定</span></td>
                                        <td><span class="method-badge smart-match">🤖 智能匹配</span></td>
                                        <td>
                                            <div class="confidence medium">
                                                <span class="confidence-dot"></span>
                                                <span>75%</span>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="action-btns">
                                                <button class="action-btn view" onclick="event.stopPropagation(); viewMemberDetail('M003')">详情</button>
                                                <button class="action-btn approve" onclick="event.stopPropagation(); openManualMatchModal('M003')">确认匹配</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr onclick="viewMemberDetail('M004')" data-match-status="failed">
                                        <td>微信用户A</td>
                                        <td>-</td>
                                        <td>微信用户A</td>
                                        <td>21天早起训练营</td>
                                        <td><span class="status-badge bind-pending">● 待绑定</span></td>
                                        <td><span style="color: var(--text-muted);">-</span></td>
                                        <td>
                                            <div class="confidence low">
                                                <span class="confidence-dot"></span>
                                                <span>-</span>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="action-btns">
                                                <button class="action-btn view" onclick="event.stopPropagation(); viewMemberDetail('M004')">详情</button>
                                                <button class="action-btn approve" onclick="event.stopPropagation(); openManualMatchModal('M004')">手动绑定</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr onclick="viewMemberDetail('M005')" data-match-status="expired">
                                        <td>微信用户B</td>
                                        <td>-</td>
                                        <td>微信用户B</td>
                                        <td>21天早起训练营</td>
                                        <td><span class="status-badge bind-expired">● 已过期</span></td>
                                        <td><span style="color: var(--text-muted);">-</span></td>
                                        <td>
                                            <div class="confidence low">
                                                <span class="confidence-dot"></span>
                                                <span>-</span>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="action-btns">
                                                <button class="action-btn view" onclick="event.stopPropagation(); viewMemberDetail('M005')">详情</button>
                                                <button class="action-btn approve" onclick="event.stopPropagation(); openManualMatchModal('M005')">人工处理</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr onclick="viewMemberDetail('M006')" data-match-status="manual">
                                        <td>运营助手小王</td>
                                        <td>88999888</td>
                                        <td>小王</td>
                                        <td>21天早起训练营</td>
                                        <td><span class="status-badge bind-completed">● 已绑定</span></td>
                                        <td><span class="method-badge manual">👤 人工绑定</span></td>
                                        <td>
                                            <div class="confidence high">
                                                <span class="confidence-dot"></span>
                                                <span>100%</span>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="action-btns">
                                                <button class="action-btn view" onclick="event.stopPropagation(); viewMemberDetail('M006')">详情</button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                            <div class="pagination">
                                <div class="pagination-info">共 3,542 条记录</div>
                                <div class="pagination-buttons">
                                    <button class="page-btn">‹</button>
                                    <button class="page-btn active">1</button>
                                    <button class="page-btn">2</button>
                                    <button class="page-btn">3</button>
                                    <button class="page-btn">...</button>
                                    <button class="page-btn">354</button>
                                    <button class="page-btn">›</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Checkins Page -->
                <div class="page" id="checkinsPage">
                    <h1 class="page-title">打卡管理</h1>

                    <div class="page-nav">
                        <div class="page-nav-item active" onclick="switchCheckinTab(this, 'records')">打卡记录</div>
                        <div class="page-nav-item" onclick="switchCheckinTab(this, 'statistics')">打卡统计</div>
                    </div>

                    <!-- Tab: 打卡记录 -->
                    <div class="checkin-tab active" id="checkin-tab-records">
                        <div class="content-card">
                            <div class="card-header">
                                <h3 class="card-title">打卡记录列表</h3>
                                <button class="btn btn-outline btn-sm" onclick="syncCheckinData()">🔄 同步数据</button>
                            </div>
                            <div class="card-body">
                                <div class="filters-bar">
                                    <div class="filter-group">
                                        <span class="filter-label">训练营：</span>
                                        <select class="filter-select" id="checkinCampFilter" onchange="filterCheckinRecords()">
                                            <option value="">全部</option>
                                            <option value="12345">21天早起训练营</option>
                                            <option value="12346">7天读书打卡营</option>
                                            <option value="12344">30天健身打卡营</option>
                                        </select>
                                    </div>
                                    <div class="filter-group">
                                        <span class="filter-label">是否达标：</span>
                                        <select class="filter-select" id="checkinStatusFilter" onchange="filterCheckinRecords()">
                                            <option value="">全部</option>
                                            <option value="qualified">已达标</option>
                                            <option value="ongoing">进行中</option>
                                            <option value="unqualified">未达标</option>
                                        </select>
                                    </div>
                                    <div class="filter-group">
                                        <input type="text" class="filter-input" placeholder="搜索会员昵称/ID..." id="checkinSearchInput">
                                    </div>
                                    <button class="btn btn-outline btn-sm" onclick="filterCheckinRecords()">🔍 搜索</button>
                                    <button class="btn btn-outline btn-sm" onclick="resetCheckinFilters()">重置</button>
                                </div>

                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>会员信息</th>
                                            <th>训练营</th>
                                            <th>打卡进度</th>
                                            <th>完成率</th>
                                            <th>是否达标</th>
                                            <th>最后打卡</th>
                                            <th>操作</th>
                                        </tr>
                                    </thead>
                                    <tbody id="checkinRecordsTable">
                                        <tr onclick="viewCheckinDetail('88455815')">
                                            <td>
                                                <strong>球球的副业探索</strong>
                                                <br><small style="color: var(--text-muted);">ID: 88455815</small>
                                            </td>
                                            <td>21天早起训练营</td>
                                            <td>
                                                <div style="display: flex; align-items: center; gap: 8px;">
                                                    <span>16/15</span>
                                                    <div class="progress-bar" style="width: 100px;">
                                                        <div class="progress-bar-fill" style="width: 100%;"></div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>107%</td>
                                            <td><span class="status-badge success">✓ 达标</span></td>
                                            <td>2025-01-15 07:32</td>
                                            <td>
                                                <button class="action-btn view" onclick="event.stopPropagation(); viewCheckinDetail('88455815')">详情</button>
                                            </td>
                                        </tr>
                                        <tr onclick="viewCheckinDetail('88123457')">
                                            <td>
                                                <strong>学习达人小明</strong>
                                                <br><small style="color: var(--text-muted);">ID: 88123457</small>
                                            </td>
                                            <td>21天早起训练营</td>
                                            <td>
                                                <div style="display: flex; align-items: center; gap: 8px;">
                                                    <span>12/15</span>
                                                    <div class="progress-bar" style="width: 100px;">
                                                        <div class="progress-bar-fill" style="width: 80%;"></div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>80%</td>
                                            <td><span class="status-badge pending">⏳ 进行中</span></td>
                                            <td>2025-01-15 08:15</td>
                                            <td>
                                                <button class="action-btn view" onclick="event.stopPropagation(); viewCheckinDetail('88123457')">详情</button>
                                            </td>
                                        </tr>
                                        <tr onclick="viewCheckinDetail('88123456')">
                                            <td>
                                                <strong>努力工作的小红</strong>
                                                <br><small style="color: var(--text-muted);">ID: 88123456</small>
                                            </td>
                                            <td>21天早起训练营</td>
                                            <td>
                                                <div style="display: flex; align-items: center; gap: 8px;">
                                                    <span>8/15</span>
                                                    <div class="progress-bar" style="width: 100px;">
                                                        <div class="progress-bar-fill" style="width: 53%; background: linear-gradient(90deg, var(--accent-orange), #f59e0b);"></div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>53%</td>
                                            <td><span class="status-badge failed">✗ 未达标</span></td>
                                            <td>2025-01-10 09:45</td>
                                            <td>
                                                <button class="action-btn view" onclick="event.stopPropagation(); viewCheckinDetail('88123456')">详情</button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>

                                <div class="pagination">
                                    <div class="pagination-info">共 156 条记录</div>
                                    <div class="pagination-buttons">
                                        <button class="page-btn">‹</button>
                                        <button class="page-btn active">1</button>
                                        <button class="page-btn">2</button>
                                        <button class="page-btn">3</button>
                                        <button class="page-btn">...</button>
                                        <button class="page-btn">16</button>
                                        <button class="page-btn">›</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tab: 打卡统计 -->
                    <div class="checkin-tab" id="checkin-tab-statistics">
                        <!-- Statistics Overview -->
                        <div class="stats-grid" style="margin-bottom: 24px;">
                            <div class="stat-card blue">
                                <div class="stat-icon">👥</div>
                                <div class="stat-value">156</div>
                                <div class="stat-label">参与总人数</div>
                            </div>
                            <div class="stat-card green">
                                <div class="stat-icon">✅</div>
                                <div class="stat-value">85%</div>
                                <div class="stat-label">平均打卡率</div>
                            </div>
                            <div class="stat-card purple">
                                <div class="stat-icon">🏆</div>
                                <div class="stat-value">132</div>
                                <div class="stat-label">达标人数</div>
                            </div>
                            <div class="stat-card orange">
                                <div class="stat-icon">⚠️</div>
                                <div class="stat-value">24</div>
                                <div class="stat-label">未达标人数</div>
                            </div>
                        </div>

                        <!-- Camp Selector -->
                        <div class="content-card">
                            <div class="card-header">
                                <h3 class="card-title">训练营打卡统计</h3>
                                <div class="card-actions">
                                    <select class="filter-select" id="statisticsCampSelect" onchange="updateCheckinStatistics()">
                                        <option value="12345">21天早起训练营</option>
                                        <option value="12346">7天读书打卡营</option>
                                        <option value="12344">30天健身打卡营</option>
                                    </select>
                                    <button class="btn btn-outline btn-sm" onclick="exportCheckinStats()">📥 导出统计</button>
                                </div>
                            </div>
                            <div class="card-body">
                                <!-- Progress Summary -->
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 24px;">
                                    <div style="padding: 16px; background: var(--bg-tertiary); border-radius: 8px; text-align: center;">
                                        <div style="font-size: 24px; font-weight: 700; color: var(--accent-blue);">15</div>
                                        <div style="font-size: 13px; color: var(--text-secondary);">已进行天数</div>
                                    </div>
                                    <div style="padding: 16px; background: var(--bg-tertiary); border-radius: 8px; text-align: center;">
                                        <div style="font-size: 24px; font-weight: 700; color: var(--text-primary);">21</div>
                                        <div style="font-size: 13px; color: var(--text-secondary);">总天数</div>
                                    </div>
                                    <div style="padding: 16px; background: var(--bg-tertiary); border-radius: 8px; text-align: center;">
                                        <div style="font-size: 24px; font-weight: 700; color: var(--accent-green);">6</div>
                                        <div style="font-size: 13px; color: var(--text-secondary);">剩余天数</div>
                                    </div>
                                </div>

                                <!-- Checkin Calendar View -->
                                <h4 style="margin-bottom: 16px; font-size: 14px; color: var(--text-secondary);">每日打卡人数</h4>
                                <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 8px; margin-bottom: 24px;">
                                    <div style="text-align: center; font-size: 12px; color: var(--text-muted);">一</div>
                                    <div style="text-align: center; font-size: 12px; color: var(--text-muted);">二</div>
                                    <div style="text-align: center; font-size: 12px; color: var(--text-muted);">三</div>
                                    <div style="text-align: center; font-size: 12px; color: var(--text-muted);">四</div>
                                    <div style="text-align: center; font-size: 12px; color: var(--text-muted);">五</div>
                                    <div style="text-align: center; font-size: 12px; color: var(--text-muted);">六</div>
                                    <div style="text-align: center; font-size: 12px; color: var(--text-muted);">日</div>
                                    <!-- Week 1 -->
                                    <div class="calendar-stat-day" onclick="viewDayCheckins('2025-01-01')">
                                        <span class="day-num">1</span>
                                        <span class="day-count">148</span>
                                    </div>
                                    <div class="calendar-stat-day" onclick="viewDayCheckins('2025-01-02')">
                                        <span class="day-num">2</span>
                                        <span class="day-count">145</span>
                                    </div>
                                    <div class="calendar-stat-day low" onclick="viewDayCheckins('2025-01-03')">
                                        <span class="day-num">3</span>
                                        <span class="day-count">120</span>
                                    </div>
                                    <div class="calendar-stat-day" onclick="viewDayCheckins('2025-01-04')">
                                        <span class="day-num">4</span>
                                        <span class="day-count">142</span>
                                    </div>
                                    <div class="calendar-stat-day" onclick="viewDayCheckins('2025-01-05')">
                                        <span class="day-num">5</span>
                                        <span class="day-count">140</span>
                                    </div>
                                    <div class="calendar-stat-day high" onclick="viewDayCheckins('2025-01-06')">
                                        <span class="day-num">6</span>
                                        <span class="day-count">152</span>
                                    </div>
                                    <div class="calendar-stat-day high" onclick="viewDayCheckins('2025-01-07')">
                                        <span class="day-num">7</span>
                                        <span class="day-count">150</span>
                                    </div>
                                    <!-- Week 2 -->
                                    <div class="calendar-stat-day" onclick="viewDayCheckins('2025-01-08')">
                                        <span class="day-num">8</span>
                                        <span class="day-count">138</span>
                                    </div>
                                    <div class="calendar-stat-day" onclick="viewDayCheckins('2025-01-09')">
                                        <span class="day-num">9</span>
                                        <span class="day-count">135</span>
                                    </div>
                                    <div class="calendar-stat-day low" onclick="viewDayCheckins('2025-01-10')">
                                        <span class="day-num">10</span>
                                        <span class="day-count">115</span>
                                    </div>
                                    <div class="calendar-stat-day" onclick="viewDayCheckins('2025-01-11')">
                                        <span class="day-num">11</span>
                                        <span class="day-count">130</span>
                                    </div>
                                    <div class="calendar-stat-day" onclick="viewDayCheckins('2025-01-12')">
                                        <span class="day-num">12</span>
                                        <span class="day-count">128</span>
                                    </div>
                                    <div class="calendar-stat-day" onclick="viewDayCheckins('2025-01-13')">
                                        <span class="day-num">13</span>
                                        <span class="day-count">132</span>
                                    </div>
                                    <div class="calendar-stat-day" onclick="viewDayCheckins('2025-01-14')">
                                        <span class="day-num">14</span>
                                        <span class="day-count">130</span>
                                    </div>
                                    <!-- Week 3 -->
                                    <div class="calendar-stat-day today" onclick="viewDayCheckins('2025-01-15')">
                                        <span class="day-num">15</span>
                                        <span class="day-count">125</span>
                                    </div>
                                    <div class="calendar-stat-day future">
                                        <span class="day-num">16</span>
                                        <span class="day-count">-</span>
                                    </div>
                                    <div class="calendar-stat-day future">
                                        <span class="day-num">17</span>
                                        <span class="day-count">-</span>
                                    </div>
                                    <div class="calendar-stat-day future">
                                        <span class="day-num">18</span>
                                        <span class="day-count">-</span>
                                    </div>
                                    <div class="calendar-stat-day future">
                                        <span class="day-num">19</span>
                                        <span class="day-count">-</span>
                                    </div>
                                    <div class="calendar-stat-day future">
                                        <span class="day-num">20</span>
                                        <span class="day-count">-</span>
                                    </div>
                                    <div class="calendar-stat-day future">
                                        <span class="day-num">21</span>
                                        <span class="day-count">-</span>
                                    </div>
                                </div>

                                <!-- Legend -->
                                <div style="display: flex; justify-content: center; gap: 24px; font-size: 12px; color: var(--text-secondary);">
                                    <div style="display: flex; align-items: center; gap: 6px;">
                                        <div style="width: 12px; height: 12px; background: rgba(63, 185, 80, 0.3); border-radius: 4px;"></div>
                                        <span>高出勤 (>95%)</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 6px;">
                                        <div style="width: 12px; height: 12px; background: var(--bg-tertiary); border-radius: 4px;"></div>
                                        <span>正常</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 6px;">
                                        <div style="width: 12px; height: 12px; background: rgba(248, 81, 73, 0.3); border-radius: 4px;"></div>
                                        <span>低出勤 (<80%)</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Member Progress List -->
                        <div class="content-card" style="margin-top: 24px;">
                            <div class="card-header">
                                <h3 class="card-title">会员打卡进度榜</h3>
                                <div class="card-actions">
                                    <select class="filter-select" onchange="sortCheckinRanking(this.value)">
                                        <option value="desc">打卡天数 高→低</option>
                                        <option value="asc">打卡天数 低→高</option>
                                    </select>
                                </div>
                            </div>
                            <div class="card-body">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>排名</th>
                                            <th>会员信息</th>
                                            <th>打卡日历</th>
                                            <th>已打卡/要求</th>
                                            <th>完成率</th>
                                            <th>状态</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><span style="font-size: 18px;">🥇</span></td>
                                            <td>
                                                <strong>早起冠军小王</strong>
                                                <br><small style="color: var(--text-muted);">ID: 88455820</small>
                                            </td>
                                            <td>
                                                <div style="display: flex; gap: 2px;">
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                </div>
                                            </td>
                                            <td>15/15</td>
                                            <td>100%</td>
                                            <td><span class="status-badge success">✓ 达标</span></td>
                                        </tr>
                                        <tr>
                                            <td><span style="font-size: 18px;">🥈</span></td>
                                            <td>
                                                <strong>球球的副业探索</strong>
                                                <br><small style="color: var(--text-muted);">ID: 88455815</small>
                                            </td>
                                            <td>
                                                <div style="display: flex; gap: 2px;">
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day missed"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                </div>
                                            </td>
                                            <td>16/15</td>
                                            <td>107%</td>
                                            <td><span class="status-badge success">✓ 达标</span></td>
                                        </tr>
                                        <tr>
                                            <td><span style="font-size: 18px;">🥉</span></td>
                                            <td>
                                                <strong>学习达人小明</strong>
                                                <br><small style="color: var(--text-muted);">ID: 88123457</small>
                                            </td>
                                            <td>
                                                <div style="display: flex; gap: 2px;">
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day missed"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day missed"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day missed"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                </div>
                                            </td>
                                            <td>12/15</td>
                                            <td>80%</td>
                                            <td><span class="status-badge pending">⏳ 进行中</span></td>
                                        </tr>
                                        <tr>
                                            <td style="color: var(--text-muted);">4</td>
                                            <td>
                                                <strong>努力工作的小红</strong>
                                                <br><small style="color: var(--text-muted);">ID: 88123456</small>
                                            </td>
                                            <td>
                                                <div style="display: flex; gap: 2px;">
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day missed"></span>
                                                    <span class="mini-day missed"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day missed"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day missed"></span>
                                                    <span class="mini-day missed"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day missed"></span>
                                                    <span class="mini-day missed"></span>
                                                    <span class="mini-day checked"></span>
                                                    <span class="mini-day checked"></span>
                                                </div>
                                            </td>
                                            <td>8/15</td>
                                            <td>53%</td>
                                            <td><span class="status-badge failed">✗ 未达标</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Payment Mapping Page 支付映射管理 -->
                <div class="page" id="paymentsPage">
                    <h1 class="page-title">支付映射管理</h1>

                    <!-- 统计卡片 -->
                    <div class="stats-grid" style="grid-template-columns: repeat(5, 1fr);">
                        <div class="stat-card">
                            <div class="stat-value" style="color: var(--accent-orange);">5</div>
                            <div class="stat-label">待绑定</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" style="color: var(--accent-green);">156</div>
                            <div class="stat-label">已绑定</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" style="color: var(--accent-red);">3</div>
                            <div class="stat-label">已过期</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" style="color: var(--accent-purple);">2</div>
                            <div class="stat-label">需人工处理</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" style="color: var(--text-muted);">1</div>
                            <div class="stat-label">已关闭</div>
                        </div>
                    </div>

                    <div class="content-card">
                        <div class="card-header">
                            <h3 class="card-title">支付映射列表</h3>
                            <div class="card-actions">
                                <button class="btn btn-primary btn-sm" onclick="runSmartMatch()">🔄 批量智能匹配</button>
                                <button class="btn btn-outline btn-sm" onclick="exportPayments()">📊 导出</button>
                            </div>
                        </div>

                        <!-- 筛选器 -->
                        <div class="filter-bar">
                            <div class="filter-group">
                                <label class="filter-label">绑定状态</label>
                                <select class="filter-select" id="bindStatusFilter">
                                    <option value="">全部</option>
                                    <option value="pending">待绑定</option>
                                    <option value="completed">已绑定</option>
                                    <option value="expired">已过期</option>
                                    <option value="manual_required">需人工处理</option>
                                    <option value="closed">已关闭</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label">绑定方式</label>
                                <select class="filter-select" id="bindMethodFilter">
                                    <option value="">全部</option>
                                    <option value="dynamic_qrcode">动态二维码</option>
                                    <option value="user_fill">用户填写</option>
                                    <option value="smart_match">智能匹配</option>
                                    <option value="manual">人工绑定</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label">训练营</label>
                                <select class="filter-select" id="paymentCampFilter">
                                    <option value="">全部训练营</option>
                                    <option value="1">21天早起打卡训练营</option>
                                    <option value="2">30天阅读习惯养成</option>
                                    <option value="3">14天冥想入门</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label">搜索</label>
                                <input type="text" class="filter-input" placeholder="订单号/微信昵称/星球ID">
                            </div>
                        </div>

                        <!-- 数据表格 -->
                        <div class="data-table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th><input type="checkbox" onclick="toggleAllPayments(this)"></th>
                                        <th>订单号</th>
                                        <th>支付金额</th>
                                        <th>付款人微信</th>
                                        <th>训练营</th>
                                        <th>绑定状态</th>
                                        <th>绑定方式</th>
                                        <th>绑定截止</th>
                                        <th>星球用户</th>
                                        <th>置信度</th>
                                        <th>操作</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- 动态二维码绑定 - 已完成 -->
                                    <tr>
                                        <td><input type="checkbox"></td>
                                        <td><code style="font-size: 11px;">CAMP_1730001_A1B2C3</code></td>
                                        <td>¥99.00</td>
                                        <td>小明同学</td>
                                        <td>21天早起打卡</td>
                                        <td><span class="status-badge bind-completed">已绑定</span></td>
                                        <td><span class="method-badge dynamic-qrcode">📱 动态二维码</span></td>
                                        <td>-</td>
                                        <td>
                                            <div style="font-size: 12px;">小明同学</div>
                                            <div style="font-size: 10px; color: var(--text-muted);">ID: 123456789</div>
                                        </td>
                                        <td><span style="color: var(--accent-green); font-weight: 600;">100%</span></td>
                                        <td>
                                            <button class="btn btn-text btn-xs" onclick="viewPaymentDetail(1)">详情</button>
                                        </td>
                                    </tr>
                                    <!-- 用户填写绑定 - 已完成 -->
                                    <tr>
                                        <td><input type="checkbox"></td>
                                        <td><code style="font-size: 11px;">CAMP_1730002_D4E5F6</code></td>
                                        <td>¥99.00</td>
                                        <td>阅读爱好者</td>
                                        <td>30天阅读习惯</td>
                                        <td><span class="status-badge bind-completed">已绑定</span></td>
                                        <td><span class="method-badge user-fill">✍️ 用户填写</span></td>
                                        <td>-</td>
                                        <td>
                                            <div style="font-size: 12px;">爱读书的人</div>
                                            <div style="font-size: 10px; color: var(--text-muted);">ID: 987654321</div>
                                        </td>
                                        <td><span style="color: var(--accent-green); font-weight: 600;">100%</span></td>
                                        <td>
                                            <button class="btn btn-text btn-xs" onclick="viewPaymentDetail(2)">详情</button>
                                        </td>
                                    </tr>
                                    <!-- 待绑定 - 等待用户填写 -->
                                    <tr style="background: rgba(210, 153, 34, 0.05);">
                                        <td><input type="checkbox"></td>
                                        <td><code style="font-size: 11px;">CAMP_1730003_G7H8I9</code></td>
                                        <td>¥99.00</td>
                                        <td>微信用户A</td>
                                        <td>21天早起打卡</td>
                                        <td><span class="status-badge bind-pending">待绑定</span></td>
                                        <td><span style="color: var(--text-muted); font-size: 11px;">-</span></td>
                                        <td>
                                            <span style="color: var(--accent-orange); font-size: 11px;">2025-12-08</span>
                                            <div style="font-size: 10px; color: var(--text-muted);">剩余 7 天</div>
                                        </td>
                                        <td><span style="color: var(--text-muted);">未绑定</span></td>
                                        <td>-</td>
                                        <td>
                                            <button class="btn btn-outline btn-xs" onclick="manualBind(3)">手动绑定</button>
                                        </td>
                                    </tr>
                                    <!-- 待绑定 - 即将过期 -->
                                    <tr style="background: rgba(248, 81, 73, 0.05);">
                                        <td><input type="checkbox"></td>
                                        <td><code style="font-size: 11px;">CAMP_1730004_J0K1L2</code></td>
                                        <td>¥99.00</td>
                                        <td>微信用户B</td>
                                        <td>14天冥想入门</td>
                                        <td><span class="status-badge bind-pending">待绑定</span></td>
                                        <td><span style="color: var(--text-muted); font-size: 11px;">-</span></td>
                                        <td>
                                            <span style="color: var(--accent-red); font-size: 11px;">2025-12-02</span>
                                            <div style="font-size: 10px; color: var(--accent-red);">剩余 1 天 ⚠️</div>
                                        </td>
                                        <td><span style="color: var(--text-muted);">未绑定</span></td>
                                        <td>-</td>
                                        <td>
                                            <button class="btn btn-warning btn-xs" onclick="manualBind(4)">手动绑定</button>
                                        </td>
                                    </tr>
                                    <!-- 智能匹配绑定 -->
                                    <tr>
                                        <td><input type="checkbox"></td>
                                        <td><code style="font-size: 11px;">CAMP_1730005_M3N4O5</code></td>
                                        <td>¥99.00</td>
                                        <td>早起的鸟儿</td>
                                        <td>21天早起打卡</td>
                                        <td><span class="status-badge bind-completed">已绑定</span></td>
                                        <td><span class="method-badge smart-match">🤖 智能匹配</span></td>
                                        <td>-</td>
                                        <td>
                                            <div style="font-size: 12px;">早起鸟儿</div>
                                            <div style="font-size: 10px; color: var(--text-muted);">ID: 456789123</div>
                                        </td>
                                        <td><span style="color: var(--accent-purple); font-weight: 600;">85%</span></td>
                                        <td>
                                            <button class="btn btn-text btn-xs" onclick="viewPaymentDetail(5)">详情</button>
                                        </td>
                                    </tr>
                                    <!-- 已过期 - 需要智能匹配 -->
                                    <tr style="background: rgba(248, 81, 73, 0.05);">
                                        <td><input type="checkbox"></td>
                                        <td><code style="font-size: 11px;">CAMP_1730006_P6Q7R8</code></td>
                                        <td>¥99.00</td>
                                        <td>微信用户C</td>
                                        <td>30天阅读习惯</td>
                                        <td><span class="status-badge bind-expired">已过期</span></td>
                                        <td><span style="color: var(--text-muted); font-size: 11px;">-</span></td>
                                        <td>
                                            <span style="color: var(--text-muted); font-size: 11px; text-decoration: line-through;">2025-11-25</span>
                                        </td>
                                        <td><span style="color: var(--text-muted);">未绑定</span></td>
                                        <td>-</td>
                                        <td>
                                            <button class="btn btn-primary btn-xs" onclick="smartMatchSingle(6)">智能匹配</button>
                                            <button class="btn btn-outline btn-xs" onclick="manualBind(6)">手动</button>
                                        </td>
                                    </tr>
                                    <!-- 需人工处理 - 智能匹配失败 -->
                                    <tr style="background: rgba(163, 113, 247, 0.05);">
                                        <td><input type="checkbox"></td>
                                        <td><code style="font-size: 11px;">CAMP_1730007_S9T0U1</code></td>
                                        <td>¥99.00</td>
                                        <td>🌟星星🌟</td>
                                        <td>21天早起打卡</td>
                                        <td><span class="status-badge bind-manual">需人工处理</span></td>
                                        <td><span style="color: var(--text-muted); font-size: 11px;">匹配失败</span></td>
                                        <td>-</td>
                                        <td>
                                            <span style="color: var(--accent-red); font-size: 11px;">匹配评分 < 50%</span>
                                        </td>
                                        <td><span style="color: var(--accent-red); font-weight: 600;">32%</span></td>
                                        <td>
                                            <button class="btn btn-warning btn-xs" onclick="manualBind(7)">人工绑定</button>
                                        </td>
                                    </tr>
                                    <!-- 人工绑定 - 已完成 -->
                                    <tr>
                                        <td><input type="checkbox"></td>
                                        <td><code style="font-size: 11px;">CAMP_1730008_V2W3X4</code></td>
                                        <td>¥99.00</td>
                                        <td>特殊符号😊</td>
                                        <td>14天冥想入门</td>
                                        <td><span class="status-badge bind-completed">已绑定</span></td>
                                        <td><span class="method-badge manual">👤 人工绑定</span></td>
                                        <td>-</td>
                                        <td>
                                            <div style="font-size: 12px;">冥想爱好者</div>
                                            <div style="font-size: 10px; color: var(--text-muted);">ID: 789123456</div>
                                        </td>
                                        <td><span style="color: var(--accent-green); font-weight: 600;">100%</span></td>
                                        <td>
                                            <button class="btn btn-text btn-xs" onclick="viewPaymentDetail(8)">详情</button>
                                        </td>
                                    </tr>
                                    <!-- 已关闭 -->
                                    <tr style="opacity: 0.6;">
                                        <td><input type="checkbox"></td>
                                        <td><code style="font-size: 11px;">CAMP_1730009_Y5Z6A7</code></td>
                                        <td>¥99.00</td>
                                        <td>测试账号</td>
                                        <td>21天早起打卡</td>
                                        <td><span class="status-badge bind-closed">已关闭</span></td>
                                        <td><span style="color: var(--text-muted); font-size: 11px;">无法匹配</span></td>
                                        <td>-</td>
                                        <td><span style="color: var(--text-muted);">-</span></td>
                                        <td>-</td>
                                        <td>
                                            <button class="btn btn-text btn-xs" onclick="viewPaymentDetail(9)">详情</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- 分页 -->
                        <div class="pagination">
                            <button class="pagination-btn" disabled>上一页</button>
                            <span class="pagination-info">第 1 页，共 17 页（167 条记录）</span>
                            <button class="pagination-btn">下一页</button>
                        </div>
                    </div>
                </div>

                <!-- Refunds Page -->
                <div class="page" id="refundsPage">
                    <h1 class="page-title">退款审核</h1>

                    <div class="page-nav">
                        <div class="page-nav-item active" onclick="switchRefundTab(this, 'pending')">待审核</div>
                        <div class="page-nav-item" onclick="switchRefundTab(this, 'records')">退款记录</div>
                    </div>

                    <!-- Tab: 待审核 -->
                    <div class="refund-tab active" id="refund-tab-pending">
                        <div class="content-card">
                            <div class="card-header">
                                <h3 class="card-title">待审核列表 <span style="color: var(--accent-orange);" id="pendingRefundCount">(12)</span></h3>
                                <div class="card-actions">
                                    <button class="btn btn-success btn-sm" onclick="batchApproveRefunds()">✓ 批量通过</button>
                                    <button class="btn btn-outline btn-sm" onclick="batchRejectRefunds()">✗ 批量拒绝</button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="filters-bar">
                                    <div class="filter-group">
                                        <span class="filter-label">训练营：</span>
                                        <select class="filter-select" id="refundCampFilter" onchange="filterRefunds()">
                                            <option value="">全部</option>
                                            <option value="12345">21天早起训练营</option>
                                            <option value="12346">7天读书打卡营</option>
                                        </select>
                                    </div>
                                    <div class="filter-group">
                                        <span class="filter-label">绑定方式：</span>
                                        <select class="filter-select" id="refundBindMethodFilter" onchange="filterRefunds()">
                                            <option value="">全部</option>
                                            <option value="dynamic_qrcode">动态二维码</option>
                                            <option value="user_fill">用户填写</option>
                                            <option value="smart_match">智能匹配</option>
                                            <option value="manual">人工绑定</option>
                                        </select>
                                    </div>
                                    <div class="filter-group">
                                        <span class="filter-label">匹配置信度：</span>
                                        <select class="filter-select" id="refundConfidenceFilter" onchange="filterRefunds()">
                                            <option value="">全部</option>
                                            <option value="100">100%</option>
                                            <option value="80">≥80%</option>
                                            <option value="50">50-79%</option>
                                            <option value="low"><50%</option>
                                        </select>
                                    </div>
                                    <div class="filter-group">
                                        <span class="filter-label">系统判断：</span>
                                        <select class="filter-select" id="refundJudgmentFilter" onchange="filterRefunds()">
                                            <option value="">全部</option>
                                            <option value="qualified">符合条件</option>
                                            <option value="manual">需人工确认</option>
                                            <option value="unqualified">不符合条件</option>
                                        </select>
                                    </div>
                                </div>

                                <table class="data-table" id="refundPendingTable">
                                    <thead>
                                        <tr>
                                            <th><input type="checkbox" class="checkbox" id="refundSelectAll" onchange="toggleSelectAllRefunds()"></th>
                                            <th>会员信息</th>
                                            <th>训练营</th>
                                            <th>打卡完成</th>
                                            <th>退款金额</th>
                                            <th>绑定方式</th>
                                            <th>匹配置信度</th>
                                            <th>系统判断</th>
                                            <th>操作</th>
                                        </tr>
                                    </thead>
                                    <tbody id="refundPendingBody">
                                        <tr data-refund-id="R001" data-judgment="qualified" onclick="viewRefundDetail('R001')">
                                            <td onclick="event.stopPropagation()"><input type="checkbox" class="checkbox refund-checkbox" value="R001" onchange="updateRefundSelection()"></td>
                                            <td>
                                                <strong>球球的副业探索</strong>
                                                <br><small style="color: var(--text-muted);">ID: 88455815</small>
                                            </td>
                                            <td>21天早起训练营</td>
                                            <td>
                                                <span style="color: var(--accent-green);">16/15 ✓</span>
                                            </td>
                                            <td style="color: var(--accent-orange); font-weight: 600;">¥99</td>
                                            <td><span class="method-badge dynamic-qrcode">📱 动态二维码</span></td>
                                            <td>
                                                <div class="confidence high">
                                                    <span class="confidence-dot"></span>
                                                    <span>100%</span>
                                                </div>
                                            </td>
                                            <td><span class="status-badge success">✓ 符合条件</span></td>
                                            <td>
                                                <div class="action-btns">
                                                    <button class="action-btn approve" onclick="event.stopPropagation(); approveRefund('R001')">通过</button>
                                                    <button class="action-btn reject" onclick="event.stopPropagation(); openRejectModal('R001')">拒绝</button>
                                                    <button class="action-btn view" onclick="event.stopPropagation(); viewRefundDetail('R001')">详情</button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr data-refund-id="R002" data-judgment="manual" onclick="viewRefundDetail('R002')">
                                            <td onclick="event.stopPropagation()"><input type="checkbox" class="checkbox refund-checkbox" value="R002" onchange="updateRefundSelection()"></td>
                                            <td>
                                                <strong>学习达人小明</strong>
                                                <br><small style="color: var(--text-muted);">ID: 88123457</small>
                                            </td>
                                            <td>21天早起训练营</td>
                                            <td>
                                                <span style="color: var(--accent-green);">15/15 ✓</span>
                                            </td>
                                            <td style="color: var(--accent-orange); font-weight: 600;">¥99</td>
                                            <td><span class="method-badge smart-match">🤖 智能匹配</span></td>
                                            <td>
                                                <div class="confidence medium">
                                                    <span class="confidence-dot"></span>
                                                    <span>66%</span>
                                                </div>
                                            </td>
                                            <td><span class="status-badge pending">⚠ 需人工确认</span></td>
                                            <td>
                                                <div class="action-btns">
                                                    <button class="action-btn approve" onclick="event.stopPropagation(); approveRefund('R002')">通过</button>
                                                    <button class="action-btn reject" onclick="event.stopPropagation(); openRejectModal('R002')">拒绝</button>
                                                    <button class="action-btn view" onclick="event.stopPropagation(); viewRefundDetail('R002')">详情</button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr data-refund-id="R003" data-judgment="unqualified" onclick="viewRefundDetail('R003')">
                                            <td onclick="event.stopPropagation()"><input type="checkbox" class="checkbox refund-checkbox" value="R003" onchange="updateRefundSelection()"></td>
                                            <td>
                                                <strong>坚持早起的小李</strong>
                                                <br><small style="color: var(--text-muted);">ID: 88123458</small>
                                            </td>
                                            <td>21天早起训练营</td>
                                            <td>
                                                <span style="color: var(--accent-red);">14/15 ✗</span>
                                            </td>
                                            <td style="color: var(--text-muted);">¥99</td>
                                            <td><span class="method-badge user-fill">✍️ 用户填写</span></td>
                                            <td>
                                                <div class="confidence high">
                                                    <span class="confidence-dot"></span>
                                                    <span>100%</span>
                                                </div>
                                            </td>
                                            <td><span class="status-badge failed">✗ 不符合条件</span></td>
                                            <td>
                                                <div class="action-btns">
                                                    <button class="action-btn approve" onclick="event.stopPropagation(); approveRefund('R003')" style="opacity: 0.5;" title="不符合退款条件">通过</button>
                                                    <button class="action-btn reject" onclick="event.stopPropagation(); openRejectModal('R003')">拒绝</button>
                                                    <button class="action-btn view" onclick="event.stopPropagation(); viewRefundDetail('R003')">详情</button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr data-refund-id="R004" data-judgment="qualified" onclick="viewRefundDetail('R004')">
                                            <td onclick="event.stopPropagation()"><input type="checkbox" class="checkbox refund-checkbox" value="R004" onchange="updateRefundSelection()"></td>
                                            <td>
                                                <strong>阅读爱好者</strong>
                                                <br><small style="color: var(--text-muted);">ID: 88123459</small>
                                            </td>
                                            <td>30天阅读习惯</td>
                                            <td>
                                                <span style="color: var(--accent-green);">25/21 ✓</span>
                                            </td>
                                            <td style="color: var(--accent-orange); font-weight: 600;">¥99</td>
                                            <td><span class="method-badge manual">👤 人工绑定</span></td>
                                            <td>
                                                <div class="confidence high">
                                                    <span class="confidence-dot"></span>
                                                    <span>100%</span>
                                                </div>
                                            </td>
                                            <td><span class="status-badge success">✓ 符合条件</span></td>
                                            <td>
                                                <div class="action-btns">
                                                    <button class="action-btn approve" onclick="event.stopPropagation(); approveRefund('R004')">通过</button>
                                                    <button class="action-btn reject" onclick="event.stopPropagation(); openRejectModal('R004')">拒绝</button>
                                                    <button class="action-btn view" onclick="event.stopPropagation(); viewRefundDetail('R004')">详情</button>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>

                                <div class="pagination">
                                    <div class="pagination-info">共 <span id="pendingTotalCount">12</span> 条待审核</div>
                                    <div class="pagination-buttons">
                                        <button class="page-btn active">1</button>
                                        <button class="page-btn">2</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tab: 退款记录 -->
                    <div class="refund-tab" id="refund-tab-records">
                        <div class="content-card">
                            <div class="card-header">
                                <h3 class="card-title">退款记录</h3>
                                <div class="card-actions">
                                    <button class="btn btn-outline btn-sm" onclick="exportRefundRecords()">📥 导出记录</button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="filters-bar">
                                    <div class="filter-group">
                                        <span class="filter-label">训练营：</span>
                                        <select class="filter-select" id="recordCampFilter" onchange="filterRefundRecords()">
                                            <option value="">全部</option>
                                            <option value="12345">21天早起训练营</option>
                                            <option value="12346">7天读书打卡营</option>
                                        </select>
                                    </div>
                                    <div class="filter-group">
                                        <span class="filter-label">退款状态：</span>
                                        <select class="filter-select" id="recordStatusFilter" onchange="filterRefundRecords()">
                                            <option value="">全部</option>
                                            <option value="success">已退款</option>
                                            <option value="failed">退款失败</option>
                                            <option value="rejected">已拒绝</option>
                                        </select>
                                    </div>
                                    <div class="filter-group">
                                        <span class="filter-label">时间范围：</span>
                                        <input type="date" class="filter-input" id="recordStartDate" style="width: 140px;">
                                        <span style="margin: 0 4px;">-</span>
                                        <input type="date" class="filter-input" id="recordEndDate" style="width: 140px;">
                                    </div>
                                    <button class="btn btn-outline btn-sm" onclick="filterRefundRecords()">🔍 查询</button>
                                    <button class="btn btn-outline btn-sm" onclick="resetRecordFilters()">重置</button>
                                </div>

                                <table class="data-table" id="refundRecordsTable">
                                    <thead>
                                        <tr>
                                            <th>会员信息</th>
                                            <th>训练营</th>
                                            <th>打卡完成</th>
                                            <th>退款金额</th>
                                            <th>绑定方式</th>
                                            <th>审核时间</th>
                                            <th>审核人</th>
                                            <th>退款状态</th>
                                            <th>操作</th>
                                        </tr>
                                    </thead>
                                    <tbody id="refundRecordsBody">
                                        <tr data-status="success" onclick="viewRefundRecordDetail('REC001')">
                                            <td>
                                                <strong>积极向上的小王</strong>
                                                <br><small style="color: var(--text-muted);">ID: 88123459</small>
                                            </td>
                                            <td>21天早起训练营</td>
                                            <td>
                                                <span style="color: var(--accent-green);">18/15 ✓</span>
                                            </td>
                                            <td style="color: var(--accent-green); font-weight: 600;">¥99</td>
                                            <td><span class="method-badge dynamic-qrcode">📱 动态二维码</span></td>
                                            <td>2025-01-14 10:30</td>
                                            <td>管理员</td>
                                            <td><span class="status-badge success">✓ 已退款</span></td>
                                            <td>
                                                <button class="action-btn view" onclick="event.stopPropagation(); viewRefundRecordDetail('REC001')">详情</button>
                                            </td>
                                        </tr>
                                        <tr data-status="failed" onclick="viewRefundRecordDetail('REC002')">
                                            <td>
                                                <strong>热爱生活的小张</strong>
                                                <br><small style="color: var(--text-muted);">ID: 88123460</small>
                                            </td>
                                            <td>21天早起训练营</td>
                                            <td>
                                                <span style="color: var(--accent-green);">16/15 ✓</span>
                                            </td>
                                            <td style="color: var(--accent-orange); font-weight: 600;">¥99</td>
                                            <td><span class="method-badge user-fill">✍️ 用户填写</span></td>
                                            <td>2025-01-14 10:25</td>
                                            <td>管理员</td>
                                            <td><span class="status-badge failed">✗ 退款失败</span></td>
                                            <td>
                                                <button class="action-btn approve" onclick="event.stopPropagation(); retryRefund('REC002')">重试</button>
                                                <button class="action-btn view" onclick="event.stopPropagation(); viewRefundRecordDetail('REC002')">详情</button>
                                            </td>
                                        </tr>
                                        <tr data-status="rejected" onclick="viewRefundRecordDetail('REC003')">
                                            <td>
                                                <strong>努力奋斗的小陈</strong>
                                                <br><small style="color: var(--text-muted);">ID: 88123461</small>
                                            </td>
                                            <td>7天读书打卡营</td>
                                            <td>
                                                <span style="color: var(--accent-red);">4/5 ✗</span>
                                            </td>
                                            <td style="color: var(--text-muted);">¥49</td>
                                            <td><span class="method-badge smart-match">🤖 智能匹配</span></td>
                                            <td>2025-01-13 15:20</td>
                                            <td>教练A</td>
                                            <td><span class="status-badge rejected">✗ 已拒绝</span></td>
                                            <td>
                                                <button class="action-btn view" onclick="event.stopPropagation(); viewRefundRecordDetail('REC003')">详情</button>
                                            </td>
                                        </tr>
                                        <tr data-status="success" onclick="viewRefundRecordDetail('REC004')">
                                            <td>
                                                <strong>坚持打卡的小周</strong>
                                                <br><small style="color: var(--text-muted);">ID: 88123462</small>
                                            </td>
                                            <td>7天读书打卡营</td>
                                            <td>
                                                <span style="color: var(--accent-green);">7/5 ✓</span>
                                            </td>
                                            <td style="color: var(--accent-green); font-weight: 600;">¥49</td>
                                            <td><span class="method-badge manual">👤 人工绑定</span></td>
                                            <td>2025-01-12 09:15</td>
                                            <td>管理员</td>
                                            <td><span class="status-badge success">✓ 已退款</span></td>
                                            <td>
                                                <button class="action-btn view" onclick="event.stopPropagation(); viewRefundRecordDetail('REC004')">详情</button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>

                                <div class="pagination">
                                    <div class="pagination-info">共 156 条记录</div>
                                    <div class="pagination-buttons">
                                        <button class="page-btn">‹</button>
                                        <button class="page-btn active">1</button>
                                        <button class="page-btn">2</button>
                                        <button class="page-btn">3</button>
                                        <button class="page-btn">...</button>
                                        <button class="page-btn">16</button>
                                        <button class="page-btn">›</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Statistics Page -->
                <div class="page" id="statisticsPage">
                    <h1 class="page-title">统计报表</h1>

                    <div class="filters-bar" style="margin-bottom: 24px;">
                        <div class="filter-group">
                            <span class="filter-label">时间范围：</span>
                            <select class="filter-select">
                                <option>本月</option>
                                <option>上月</option>
                                <option>近三个月</option>
                                <option>今年</option>
                            </select>
                        </div>
                        <button class="btn btn-outline btn-sm">📥 导出报表</button>
                    </div>

                    <!-- Stats Cards -->
                    <div class="stats-grid" style="grid-template-columns: repeat(5, 1fr);">
                        <div class="stat-card blue">
                            <div class="stat-value">23</div>
                            <div class="stat-label">训练营数</div>
                        </div>
                        <div class="stat-card green">
                            <div class="stat-value">1,256</div>
                            <div class="stat-label">参与人数</div>
                        </div>
                        <div class="stat-card purple">
                            <div class="stat-value">¥124,344</div>
                            <div class="stat-label">押金收入</div>
                        </div>
                        <div class="stat-card orange">
                            <div class="stat-value">¥96,858</div>
                            <div class="stat-label">退款金额</div>
                        </div>
                        <div class="stat-card blue">
                            <div class="stat-value">¥27,486</div>
                            <div class="stat-label">净收入</div>
                        </div>
                    </div>

                    <!-- Charts -->
                    <div class="charts-grid">
                        <div class="content-card">
                            <div class="card-header">
                                <h3 class="card-title">月度收入趋势</h3>
                            </div>
                            <div class="card-body">
                                <div id="monthlyChart" class="chart-container"></div>
                            </div>
                        </div>
                        <div class="content-card">
                            <div class="card-header">
                                <h3 class="card-title">训练营完成率对比</h3>
                            </div>
                            <div class="card-body">
                                <div id="campCompareChart" class="chart-container"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Detail Table -->
                    <div class="content-card">
                        <div class="card-header">
                            <h3 class="card-title">训练营明细</h3>
                        </div>
                        <div class="card-body">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>训练营名称</th>
                                        <th>报名人数</th>
                                        <th>完成率</th>
                                        <th>押金收入</th>
                                        <th>退款金额</th>
                                        <th>净收入</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>21天早起训练营</strong></td>
                                        <td>156</td>
                                        <td>85%</td>
                                        <td>¥15,444</td>
                                        <td>¥13,068</td>
                                        <td style="color: var(--accent-green); font-weight: 600;">¥2,376</td>
                                    </tr>
                                    <tr>
                                        <td><strong>7天读书打卡营</strong></td>
                                        <td>89</td>
                                        <td>78%</td>
                                        <td>¥4,361</td>
                                        <td>¥3,402</td>
                                        <td style="color: var(--accent-green); font-weight: 600;">¥959</td>
                                    </tr>
                                    <tr>
                                        <td><strong>30天健身打卡营</strong></td>
                                        <td>234</td>
                                        <td>72%</td>
                                        <td>¥46,566</td>
                                        <td>¥33,528</td>
                                        <td style="color: var(--accent-green); font-weight: 600;">¥13,038</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- System Page -->
                <div class="page" id="systemPage">
                    <h1 class="page-title">系统管理</h1>

                    <div class="page-nav">
                        <div class="page-nav-item active" onclick="switchSystemTab(this, 'users')">用户管理</div>
                        <div class="page-nav-item" onclick="switchSystemTab(this, 'config')">系统配置</div>
                        <div class="page-nav-item" onclick="switchSystemTab(this, 'logs')">操作日志</div>
                    </div>

                    <!-- Tab: 用户管理 -->
                    <div class="system-tab active" id="system-tab-users">
                        <div class="content-card">
                            <div class="card-header">
                                <h3 class="card-title">用户列表</h3>
                                <button class="btn btn-primary" onclick="openAddUserModal()">+ 添加用户</button>
                            </div>
                            <div class="card-body">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>用户名</th>
                                            <th>角色</th>
                                            <th>创建时间</th>
                                            <th>最后登录</th>
                                            <th>状态</th>
                                            <th>操作</th>
                                        </tr>
                                    </thead>
                                    <tbody id="userTableBody">
                                        <tr data-user-id="U001" data-role="super_admin" data-status="enabled">
                                            <td><strong>admin</strong></td>
                                            <td><span class="role-badge super-admin">超级管理员</span></td>
                                            <td>2024-01-01</td>
                                            <td>2025-01-15 10:30</td>
                                            <td><span class="status-badge success">启用</span></td>
                                            <td>
                                                <div class="action-btns">
                                                    <button class="action-btn view" onclick="openEditUserModal('U001')">编辑</button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr data-user-id="U002" data-role="admin" data-status="enabled">
                                            <td><strong>manager01</strong></td>
                                            <td><span class="role-badge admin">管理员</span></td>
                                            <td>2024-03-15</td>
                                            <td>2025-01-14 18:45</td>
                                            <td><span class="status-badge success">启用</span></td>
                                            <td>
                                                <div class="action-btns">
                                                    <button class="action-btn view" onclick="openEditUserModal('U002')">编辑</button>
                                                    <button class="action-btn reject" onclick="toggleUserStatus('U002', 'disable')">禁用</button>
                                                    <button class="action-btn delete" onclick="deleteUser('U002')">删除</button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr data-user-id="U003" data-role="coach" data-status="enabled">
                                            <td><strong>coach_zhang</strong></td>
                                            <td><span class="role-badge coach">教练</span></td>
                                            <td>2024-06-01</td>
                                            <td>2025-01-15 09:20</td>
                                            <td><span class="status-badge success">启用</span></td>
                                            <td>
                                                <div class="action-btns">
                                                    <button class="action-btn view" onclick="openEditUserModal('U003')">编辑</button>
                                                    <button class="action-btn reject" onclick="toggleUserStatus('U003', 'disable')">禁用</button>
                                                    <button class="action-btn delete" onclick="deleteUser('U003')">删除</button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr data-user-id="U004" data-role="volunteer" data-status="disabled">
                                            <td><strong>volunteer_li</strong></td>
                                            <td><span class="role-badge volunteer">志愿者</span></td>
                                            <td>2024-09-01</td>
                                            <td>2025-01-13 14:30</td>
                                            <td><span class="status-badge ended">禁用</span></td>
                                            <td>
                                                <div class="action-btns">
                                                    <button class="action-btn view" onclick="openEditUserModal('U004')">编辑</button>
                                                    <button class="action-btn approve" onclick="toggleUserStatus('U004', 'enable')">启用</button>
                                                    <button class="action-btn delete" onclick="deleteUser('U004')">删除</button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr data-user-id="U005" data-role="coach" data-status="enabled">
                                            <td><strong>coach_li</strong></td>
                                            <td><span class="role-badge coach">教练</span></td>
                                            <td>2024-08-15</td>
                                            <td>2025-01-14 16:00</td>
                                            <td><span class="status-badge success">启用</span></td>
                                            <td>
                                                <div class="action-btns">
                                                    <button class="action-btn view" onclick="openEditUserModal('U005')">编辑</button>
                                                    <button class="action-btn reject" onclick="toggleUserStatus('U005', 'disable')">禁用</button>
                                                    <button class="action-btn delete" onclick="deleteUser('U005')">删除</button>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Tab: 系统配置 -->
                    <div class="system-tab" id="system-tab-config">
                        <!-- 知识星球配置 -->
                        <div class="content-card">
                            <div class="card-header">
                                <h3 class="card-title">
                                    <span class="config-icon">🌟</span>
                                    知识星球配置
                                </h3>
                                <span class="config-status connected" id="zsxqStatus">
                                    <span class="status-dot"></span>
                                    已连接
                                </span>
                            </div>
                            <div class="card-body">
                                <div class="config-form">
                                    <div class="config-item">
                                        <label class="config-label">星球 ID <span class="required">*</span></label>
                                        <input type="text" class="form-control config-input" id="zsxqGroupId" value="15555411412112" placeholder="请输入星球ID">
                                        <div class="config-help">在知识星球App中查看：我的星球 → 星球ID</div>
                                    </div>
                                    <div class="config-item">
                                        <label class="config-label">Cookie <span class="required">*</span></label>
                                        <div class="config-input-group">
                                            <input type="password" class="form-control config-input" id="zsxqCookie" value="••••••••••••••••••••" placeholder="请输入Cookie">
                                            <button class="btn btn-sm btn-outline" onclick="togglePasswordVisibility('zsxqCookie', this)">显示</button>
                                        </div>
                                        <div class="config-help">从浏览器开发者工具中获取，用于API认证</div>
                                    </div>
                                    <div class="config-item">
                                        <label class="config-label">X-Timestamp</label>
                                        <input type="text" class="form-control config-input" id="zsxqTimestamp" value="1730000000000" placeholder="请输入时间戳">
                                    </div>
                                    <div class="config-item">
                                        <label class="config-label">X-Signature</label>
                                        <input type="text" class="form-control config-input" id="zsxqSignature" value="a1b2c3d4e5f6..." placeholder="请输入签名">
                                    </div>
                                    <div class="config-actions">
                                        <button class="btn btn-outline" onclick="testZsxqConnection()">
                                            <span class="btn-icon">🔗</span>
                                            测试连接
                                        </button>
                                        <button class="btn btn-primary" onclick="saveZsxqConfig()">保存配置</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 企业微信配置 -->
                        <div class="content-card">
                            <div class="card-header">
                                <h3 class="card-title">
                                    <span class="config-icon">💼</span>
                                    企业微信配置
                                </h3>
                                <span class="config-status connected" id="wechatStatus">
                                    <span class="status-dot"></span>
                                    已连接
                                </span>
                            </div>
                            <div class="card-body">
                                <div class="config-form">
                                    <div class="config-row">
                                        <div class="config-item">
                                            <label class="config-label">企业 ID <span class="required">*</span></label>
                                            <input type="text" class="form-control config-input" id="wechatCorpId" value="ww1234567890" placeholder="请输入企业ID">
                                        </div>
                                        <div class="config-item">
                                            <label class="config-label">应用 Secret <span class="required">*</span></label>
                                            <div class="config-input-group">
                                                <input type="password" class="form-control config-input" id="wechatSecret" value="••••••••••••" placeholder="请输入应用Secret">
                                                <button class="btn btn-sm btn-outline" onclick="togglePasswordVisibility('wechatSecret', this)">显示</button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="config-row">
                                        <div class="config-item">
                                            <label class="config-label">支付商户号 <span class="required">*</span></label>
                                            <input type="text" class="form-control config-input" id="wechatMchId" value="1600000001" placeholder="请输入商户号">
                                        </div>
                                        <div class="config-item">
                                            <label class="config-label">支付密钥 <span class="required">*</span></label>
                                            <div class="config-input-group">
                                                <input type="password" class="form-control config-input" id="wechatPayKey" value="••••••••••••" placeholder="请输入支付密钥">
                                                <button class="btn btn-sm btn-outline" onclick="togglePasswordVisibility('wechatPayKey', this)">显示</button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="config-item">
                                        <label class="config-label">Webhook 回调地址</label>
                                        <div class="config-input-group">
                                            <input type="text" class="form-control config-input readonly" id="webhookUrl" value="https://api.example.com/webhook/wechat/payment" readonly>
                                            <button class="btn btn-sm btn-outline" onclick="copyToClipboard('webhookUrl')">复制</button>
                                        </div>
                                        <div class="config-help">将此地址配置到企业微信支付后台</div>
                                    </div>
                                    <div class="config-actions">
                                        <button class="btn btn-outline" onclick="testWechatConnection()">
                                            <span class="btn-icon">🔗</span>
                                            测试连接
                                        </button>
                                        <button class="btn btn-primary" onclick="saveWechatConfig()">保存配置</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 通知配置 -->
                        <div class="content-card">
                            <div class="card-header">
                                <h3 class="card-title">
                                    <span class="config-icon">🔔</span>
                                    通知配置
                                </h3>
                            </div>
                            <div class="card-body">
                                <div class="config-form">
                                    <div class="config-item">
                                        <div class="config-switch-row">
                                            <div class="config-switch-info">
                                                <label class="config-label">企业微信应用消息</label>
                                                <div class="config-help">启用后，系统异常、退款失败等事件将通过企业微信应用推送通知</div>
                                            </div>
                                            <label class="switch">
                                                <input type="checkbox" id="notifyAppMsg" checked onchange="toggleNotifySetting('appMsg')">
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="config-item">
                                        <div class="config-switch-row">
                                            <div class="config-switch-info">
                                                <label class="config-label">群机器人通知</label>
                                                <div class="config-help">启用后，退款成功等消息将发送到训练营学习群</div>
                                            </div>
                                            <label class="switch">
                                                <input type="checkbox" id="notifyGroupBot" checked onchange="toggleNotifySetting('groupBot')">
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="config-item">
                                        <label class="config-label">通知接收人</label>
                                        <div class="notify-receivers">
                                            <label class="checkbox-item checked">
                                                <input type="checkbox" checked>
                                                <span class="checkbox-box">✓</span>
                                                <span>admin (超级管理员)</span>
                                            </label>
                                            <label class="checkbox-item checked">
                                                <input type="checkbox" checked>
                                                <span class="checkbox-box">✓</span>
                                                <span>manager01 (管理员)</span>
                                            </label>
                                            <label class="checkbox-item">
                                                <input type="checkbox">
                                                <span class="checkbox-box">✓</span>
                                                <span>coach_zhang (教练)</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="config-actions">
                                        <button class="btn btn-outline" onclick="testNotification()">
                                            <span class="btn-icon">📤</span>
                                            发送测试消息
                                        </button>
                                        <button class="btn btn-primary" onclick="saveNotifyConfig()">保存配置</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 其他设置 -->
                        <div class="content-card">
                            <div class="card-header">
                                <h3 class="card-title">
                                    <span class="config-icon">⚙️</span>
                                    其他设置
                                </h3>
                            </div>
                            <div class="card-body">
                                <div class="config-form">
                                    <div class="config-row">
                                        <div class="config-item">
                                            <label class="config-label">打卡宽限天数</label>
                                            <div class="input-with-unit" style="max-width: 150px;">
                                                <input type="number" class="form-control" id="graceDays" value="1" min="0" max="7">
                                                <span class="input-unit">天</span>
                                            </div>
                                            <div class="config-help">计算退款资格时额外增加的宽限天数</div>
                                        </div>
                                        <div class="config-item">
                                            <label class="config-label">数据保留期限</label>
                                            <div class="input-with-unit" style="max-width: 150px;">
                                                <input type="number" class="form-control" id="dataRetention" value="90" min="30" max="365">
                                                <span class="input-unit">天</span>
                                            </div>
                                            <div class="config-help">历史数据和操作日志的保留天数</div>
                                        </div>
                                    </div>
                                    <div class="config-actions">
                                        <button class="btn btn-primary" onclick="saveOtherConfig()">保存配置</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tab: 操作日志 -->
                    <div class="system-tab" id="system-tab-logs">
                        <div class="content-card">
                            <div class="card-header">
                                <h3 class="card-title">操作日志</h3>
                                <button class="btn btn-outline" onclick="exportOperationLogs()">
                                    <span class="btn-icon">📥</span>
                                    导出日志
                                </button>
                            </div>
                            <div class="card-body">
                                <!-- Filters -->
                                <div class="filter-bar">
                                    <div class="filter-item">
                                        <label>操作人</label>
                                        <select class="filter-select" id="logUserFilter" onchange="filterOperationLogs()">
                                            <option value="">全部</option>
                                            <option value="admin">admin</option>
                                            <option value="manager01">manager01</option>
                                            <option value="coach_zhang">coach_zhang</option>
                                        </select>
                                    </div>
                                    <div class="filter-item">
                                        <label>操作类型</label>
                                        <select class="filter-select" id="logTypeFilter" onchange="filterOperationLogs()">
                                            <option value="">全部</option>
                                            <option value="camp">训练营管理</option>
                                            <option value="member">会员管理</option>
                                            <option value="refund">退款审核</option>
                                            <option value="system">系统配置</option>
                                            <option value="login">登录登出</option>
                                        </select>
                                    </div>
                                    <div class="filter-item">
                                        <label>时间范围</label>
                                        <div class="date-range">
                                            <input type="date" class="filter-input" id="logStartDate">
                                            <span>至</span>
                                            <input type="date" class="filter-input" id="logEndDate">
                                        </div>
                                    </div>
                                    <div class="filter-item">
                                        <label>关键词</label>
                                        <input type="text" class="filter-input" id="logKeyword" placeholder="搜索操作内容..." onkeyup="filterOperationLogs()">
                                    </div>
                                    <button class="btn btn-sm btn-outline" onclick="resetLogFilters()">重置</button>
                                </div>

                                <!-- Log Table -->
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th width="160">操作时间</th>
                                            <th width="100">操作人</th>
                                            <th width="100">操作类型</th>
                                            <th>操作内容</th>
                                            <th width="120">IP地址</th>
                                        </tr>
                                    </thead>
                                    <tbody id="logTableBody">
                                        <tr data-user="admin" data-type="refund">
                                            <td>2025-01-15 10:30:25</td>
                                            <td><strong>admin</strong></td>
                                            <td><span class="log-type-badge refund">退款审核</span></td>
                                            <td>批量通过退款申请：21天早起训练营（3人）</td>
                                            <td>192.168.1.100</td>
                                        </tr>
                                        <tr data-user="manager01" data-type="camp">
                                            <td>2025-01-15 09:45:12</td>
                                            <td><strong>manager01</strong></td>
                                            <td><span class="log-type-badge camp">训练营管理</span></td>
                                            <td>创建训练营：30天健身打卡营</td>
                                            <td>192.168.1.101</td>
                                        </tr>
                                        <tr data-user="admin" data-type="system">
                                            <td>2025-01-15 09:30:00</td>
                                            <td><strong>admin</strong></td>
                                            <td><span class="log-type-badge system">系统配置</span></td>
                                            <td>修改知识星球配置：更新Cookie</td>
                                            <td>192.168.1.100</td>
                                        </tr>
                                        <tr data-user="coach_zhang" data-type="member">
                                            <td>2025-01-15 09:15:33</td>
                                            <td><strong>coach_zhang</strong></td>
                                            <td><span class="log-type-badge member">会员管理</span></td>
                                            <td>手动匹配会员：球球的副业探索 → 知识星球ID 88455815</td>
                                            <td>192.168.1.102</td>
                                        </tr>
                                        <tr data-user="admin" data-type="login">
                                            <td>2025-01-15 08:30:00</td>
                                            <td><strong>admin</strong></td>
                                            <td><span class="log-type-badge login">登录登出</span></td>
                                            <td>用户登录成功</td>
                                            <td>192.168.1.100</td>
                                        </tr>
                                        <tr data-user="manager01" data-type="refund">
                                            <td>2025-01-14 18:20:15</td>
                                            <td><strong>manager01</strong></td>
                                            <td><span class="log-type-badge refund">退款审核</span></td>
                                            <td>拒绝退款申请：小明同学（原因：打卡天数未达标）</td>
                                            <td>192.168.1.101</td>
                                        </tr>
                                        <tr data-user="admin" data-type="member">
                                            <td>2025-01-14 17:45:20</td>
                                            <td><strong>admin</strong></td>
                                            <td><span class="log-type-badge member">会员管理</span></td>
                                            <td>标记进群状态：早起达人 → 已进群</td>
                                            <td>192.168.1.100</td>
                                        </tr>
                                        <tr data-user="manager01" data-type="camp">
                                            <td>2025-01-14 16:30:00</td>
                                            <td><strong>manager01</strong></td>
                                            <td><span class="log-type-badge camp">训练营管理</span></td>
                                            <td>编辑训练营：7天读书打卡营（修改押金金额）</td>
                                            <td>192.168.1.101</td>
                                        </tr>
                                        <tr data-user="admin" data-type="system">
                                            <td>2025-01-14 15:00:00</td>
                                            <td><strong>admin</strong></td>
                                            <td><span class="log-type-badge system">系统配置</span></td>
                                            <td>添加用户：coach_li（角色：教练）</td>
                                            <td>192.168.1.100</td>
                                        </tr>
                                        <tr data-user="admin" data-type="login">
                                            <td>2025-01-14 14:30:00</td>
                                            <td><strong>admin</strong></td>
                                            <td><span class="log-type-badge login">登录登出</span></td>
                                            <td>用户登出</td>
                                            <td>192.168.1.100</td>
                                        </tr>
                                    </tbody>
                                </table>

                                <!-- Pagination -->
                                <div class="table-footer">
                                    <div class="table-info">共 156 条记录</div>
                                    <div class="pagination">
                                        <button class="page-btn" disabled>上一页</button>
                                        <button class="page-btn active">1</button>
                                        <button class="page-btn">2</button>
                                        <button class="page-btn">3</button>
                                        <span class="page-ellipsis">...</span>
                                        <button class="page-btn">16</button>
                                        <button class="page-btn">下一页</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Create Camp Modal -->
    <div class="modal-overlay" id="createCampModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">创建训练营</h3>
                <button class="modal-close" onclick="closeCreateCampModal()">&times;</button>
            </div>

            <!-- Steps Indicator -->
            <div class="steps-indicator">
                <div class="step-item active" data-step="1">
                    <div class="step-number">1</div>
                    <span class="step-label">基本信息</span>
                </div>
                <div class="step-divider"></div>
                <div class="step-item" data-step="2">
                    <div class="step-number">2</div>
                    <span class="step-label">打卡规则</span>
                </div>
                <div class="step-divider"></div>
                <div class="step-item" data-step="3">
                    <div class="step-number">3</div>
                    <span class="step-label">宣传设置</span>
                </div>
            </div>

            <div class="modal-body">
                <!-- Step 1: 基本信息 -->
                <div class="form-step active" id="step1">
                    <div class="form-section">
                        <div class="form-section-title">
                            <span class="icon">📝</span>
                            基本信息
                        </div>

                        <div class="form-row single">
                            <div class="form-item">
                                <label class="form-label">训练营标题 <span class="required">*</span></label>
                                <input type="text" class="form-control" placeholder="请输入训练营标题，如：21天早起训练营" maxlength="50">
                                <div class="form-help">最多50个字符</div>
                            </div>
                        </div>

                        <div class="form-row single">
                            <div class="form-item">
                                <label class="form-label">训练营规则说明 <span class="required">*</span></label>
                                <textarea class="form-control" rows="4" placeholder="请详细描述训练营的规则和要求..."></textarea>
                                <div class="form-help">详细说明打卡要求、退款规则等</div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-item">
                                <label class="form-label">押金金额 <span class="required">*</span></label>
                                <div class="input-with-unit">
                                    <input type="number" class="form-control" placeholder="99" min="1" max="9999">
                                    <span class="input-unit">元</span>
                                </div>
                            </div>
                            <div class="form-item">
                                <label class="form-label">训练营教练 <span class="required">*</span></label>
                                <div class="checkbox-group">
                                    <label class="checkbox-item" onclick="toggleCheckbox(this)">
                                        <input type="checkbox" name="coach">
                                        <span class="checkbox-box">✓</span>
                                        <span>coach_zhang</span>
                                    </label>
                                    <label class="checkbox-item" onclick="toggleCheckbox(this)">
                                        <input type="checkbox" name="coach">
                                        <span class="checkbox-box">✓</span>
                                        <span>coach_li</span>
                                    </label>
                                    <label class="checkbox-item" onclick="toggleCheckbox(this)">
                                        <input type="checkbox" name="coach">
                                        <span class="checkbox-box">✓</span>
                                        <span>coach_wang</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 2: 打卡规则 -->
                <div class="form-step" id="step2">
                    <div class="form-section">
                        <div class="form-section-title">
                            <span class="icon">✅</span>
                            打卡规则
                        </div>

                        <div class="form-row single">
                            <div class="form-item">
                                <label class="form-label">打卡类型 <span class="required">*</span></label>
                                <div class="radio-group">
                                    <label class="radio-item active" onclick="selectRadio(this, 'checkinType')">
                                        <input type="radio" name="checkinType" value="cumulative" checked>
                                        <span class="radio-dot"></span>
                                        <span class="radio-label">累计打卡</span>
                                    </label>
                                    <label class="radio-item" onclick="selectRadio(this, 'checkinType')">
                                        <input type="radio" name="checkinType" value="consecutive">
                                        <span class="radio-dot"></span>
                                        <span class="radio-label">连续打卡</span>
                                    </label>
                                </div>
                                <div class="form-help">累计打卡：只要达到总天数即可；连续打卡：必须连续不中断</div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-item">
                                <label class="form-label">训练营总天数 <span class="required">*</span></label>
                                <div class="input-with-unit">
                                    <input type="number" class="form-control" placeholder="21" min="1" max="365" id="totalDays">
                                    <span class="input-unit">天</span>
                                </div>
                            </div>
                            <div class="form-item">
                                <label class="form-label">要求打卡天数 <span class="required">*</span></label>
                                <div class="input-with-unit">
                                    <input type="number" class="form-control" placeholder="15" min="1" max="365" id="requiredDays">
                                    <span class="input-unit">天</span>
                                </div>
                                <div class="form-help">要求天数不能超过总天数</div>
                            </div>
                        </div>

                        <div class="form-row single">
                            <div class="form-item">
                                <label class="form-label">打卡截止时间 <span class="required">*</span></label>
                                <div class="radio-group">
                                    <label class="radio-item active" onclick="selectRadio(this, 'deadline'); toggleConditional('deadlineDate', false)">
                                        <input type="radio" name="deadline" value="permanent" checked>
                                        <span class="radio-dot"></span>
                                        <span class="radio-label">长期有效</span>
                                    </label>
                                    <label class="radio-item" onclick="selectRadio(this, 'deadline'); toggleConditional('deadlineDate', true)">
                                        <input type="radio" name="deadline" value="specified">
                                        <span class="radio-dot"></span>
                                        <span class="radio-label">指定截止时间</span>
                                    </label>
                                </div>
                                <div class="conditional-field" id="deadlineDate">
                                    <div class="form-row">
                                        <div class="form-item">
                                            <label class="form-label">开始日期</label>
                                            <input type="date" class="form-control">
                                        </div>
                                        <div class="form-item">
                                            <label class="form-label">结束日期</label>
                                            <input type="date" class="form-control">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-row single">
                            <div class="form-item">
                                <label class="form-label">打卡最低字数</label>
                                <div class="radio-group">
                                    <label class="radio-item active" onclick="selectRadio(this, 'minWords'); toggleConditional('minWordsInput', false)">
                                        <input type="radio" name="minWords" value="none" checked>
                                        <span class="radio-dot"></span>
                                        <span class="radio-label">不限制</span>
                                    </label>
                                    <label class="radio-item" onclick="selectRadio(this, 'minWords'); toggleConditional('minWordsInput', true)">
                                        <input type="radio" name="minWords" value="specified">
                                        <span class="radio-dot"></span>
                                        <span class="radio-label">指定字数</span>
                                    </label>
                                </div>
                                <div class="conditional-field" id="minWordsInput">
                                    <div class="input-with-unit" style="max-width: 200px;">
                                        <input type="number" class="form-control" placeholder="100" min="0" max="1000">
                                        <span class="input-unit">字</span>
                                    </div>
                                    <div class="form-help">范围：0-1000字</div>
                                </div>
                            </div>
                        </div>

                        <div class="form-row single">
                            <div class="form-item">
                                <label class="form-label">展现方式</label>
                                <div class="radio-group">
                                    <label class="radio-item active" onclick="selectRadio(this, 'displayMode')">
                                        <input type="radio" name="displayMode" value="timeline" checked>
                                        <span class="radio-dot"></span>
                                        <span class="radio-label">展示在时间线/动态</span>
                                    </label>
                                    <label class="radio-item" onclick="selectRadio(this, 'displayMode')">
                                        <input type="radio" name="displayMode" value="checkin_only">
                                        <span class="radio-dot"></span>
                                        <span class="radio-label">仅展示到打卡挑战内</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 3: 宣传设置 -->
                <div class="form-step" id="step3">
                    <div class="form-section">
                        <div class="form-section-title">
                            <span class="icon">📢</span>
                            宣传设置
                        </div>

                        <div class="form-row single">
                            <div class="form-item">
                                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                                    <label class="form-label" style="margin: 0;">训练营宣传文案</label>
                                    <button class="ai-generate-btn" onclick="generatePromoText()">
                                        <span class="sparkle">✨</span>
                                        AI 智能生成
                                    </button>
                                </div>
                                <textarea class="form-control" rows="6" placeholder="请输入训练营宣传文案，或点击AI智能生成..." id="promoText"></textarea>
                                <div class="form-help">宣传文案将用于训练营推广页面</div>

                                <div class="preview-card" id="promoPreview" style="display: none;">
                                    <div class="preview-card-title">预览</div>
                                    <div class="preview-card-content" id="promoPreviewContent"></div>
                                </div>
                            </div>
                        </div>

                        <div class="form-row single">
                            <div class="form-item">
                                <label class="form-label">训练营海报</label>
                                <div class="poster-upload">
                                    <div class="poster-preview" id="posterPreview" onclick="document.getElementById('posterInput').click()">
                                        <span class="poster-preview-icon">🖼️</span>
                                        <span class="poster-preview-text">点击上传海报</span>
                                        <input type="file" id="posterInput" accept="image/*" style="display: none;" onchange="previewPoster(this)">
                                    </div>
                                    <div class="poster-actions">
                                        <button class="ai-generate-btn" onclick="generatePoster()">
                                            <span class="sparkle">✨</span>
                                            AI 生成海报
                                        </button>
                                        <button class="btn btn-outline btn-sm" onclick="document.getElementById('posterInput').click()">
                                            📤 上传图片
                                        </button>
                                        <div class="form-help" style="margin-top: 8px;">
                                            支持 jpg、png 格式<br>
                                            建议尺寸：750 × 1334 像素<br>
                                            最大 2MB
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-row single">
                            <div class="form-item">
                                <label class="form-label">群二维码 <span class="required">*</span></label>
                                <div class="poster-upload">
                                    <div class="poster-preview" style="width: 150px; height: 150px;" id="qrcodePreview" onclick="document.getElementById('qrcodeInput').click()">
                                        <span class="poster-preview-icon">📱</span>
                                        <span class="poster-preview-text">上传群二维码</span>
                                        <input type="file" id="qrcodeInput" accept="image/*" style="display: none;" onchange="previewQRCode(this)">
                                    </div>
                                    <div class="poster-actions">
                                        <button class="btn btn-outline btn-sm" onclick="document.getElementById('qrcodeInput').click()">
                                            📤 上传二维码
                                        </button>
                                        <div class="form-help" style="margin-top: 8px;">
                                            上传学习群的企业微信二维码<br>
                                            支付成功后展示给用户
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn btn-outline" id="prevStepBtn" onclick="prevStep()" style="display: none;">上一步</button>
                <button class="btn btn-outline" onclick="closeCreateCampModal()">取消</button>
                <button class="btn btn-primary" id="nextStepBtn" onclick="nextStep()">下一步</button>
                <button class="btn btn-success" id="submitBtn" onclick="submitCamp()" style="display: none;">创建训练营</button>
            </div>
        </div>
    </div>

    <!-- Camp Detail Drawer -->
    <div class="modal-overlay" id="campDetailDrawer">
        <div class="modal" style="width: 900px;">
            <div class="modal-header">
                <h3 class="modal-title" id="campDetailTitle">训练营详情</h3>
                <button class="modal-close" onclick="closeCampDetailDrawer()">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Detail Tabs -->
                <div class="page-nav" style="margin: 0 0 20px 0; padding: 0; border: none;">
                    <div class="page-nav-item active" onclick="switchDetailTab(this, 'overview')">概览</div>
                    <div class="page-nav-item" onclick="switchDetailTab(this, 'members')">报名列表</div>
                    <div class="page-nav-item" onclick="switchDetailTab(this, 'checkins')">打卡情况</div>
                    <div class="page-nav-item" onclick="switchDetailTab(this, 'refunds')">退款情况</div>
                </div>

                <!-- Tab: Overview -->
                <div class="detail-tab active" id="tab-overview">
                    <div style="display: grid; grid-template-columns: 200px 1fr; gap: 24px;">
                        <!-- Poster -->
                        <div style="background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%); border-radius: 12px; height: 280px; display: flex; align-items: center; justify-content: center; color: white; font-size: 48px;">
                            🌅
                        </div>
                        <!-- Info -->
                        <div>
                            <h2 style="font-size: 20px; margin-bottom: 16px;" id="detailCampName">21天早起训练营</h2>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px;">
                                <div class="form-item">
                                    <span class="form-label" style="color: var(--text-muted);">训练营ID</span>
                                    <span id="detailCampId">12345</span>
                                </div>
                                <div class="form-item">
                                    <span class="form-label" style="color: var(--text-muted);">押金金额</span>
                                    <span style="color: var(--accent-orange); font-weight: 600;">¥99</span>
                                </div>
                                <div class="form-item">
                                    <span class="form-label" style="color: var(--text-muted);">时间范围</span>
                                    <span>2025-01-01 ~ 2025-01-21</span>
                                </div>
                                <div class="form-item">
                                    <span class="form-label" style="color: var(--text-muted);">打卡要求</span>
                                    <span>21天15打卡</span>
                                </div>
                                <div class="form-item">
                                    <span class="form-label" style="color: var(--text-muted);">状态</span>
                                    <span class="status-badge ongoing">● 进行中</span>
                                </div>
                                <div class="form-item">
                                    <span class="form-label" style="color: var(--text-muted);">教练</span>
                                    <span>coach_zhang, coach_li</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Stats Cards -->
                    <div class="stats-grid" style="margin-top: 24px; grid-template-columns: repeat(4, 1fr);">
                        <div class="stat-card blue" style="padding: 16px;">
                            <div class="stat-value" style="font-size: 24px;">156</div>
                            <div class="stat-label">报名人数</div>
                        </div>
                        <div class="stat-card green" style="padding: 16px;">
                            <div class="stat-value" style="font-size: 24px;">¥15,444</div>
                            <div class="stat-label">押金总额</div>
                        </div>
                        <div class="stat-card purple" style="padding: 16px;">
                            <div class="stat-value" style="font-size: 24px;">85%</div>
                            <div class="stat-label">平均打卡率</div>
                        </div>
                        <div class="stat-card orange" style="padding: 16px;">
                            <div class="stat-value" style="font-size: 24px;">¥13,068</div>
                            <div class="stat-label">已退款金额</div>
                        </div>
                    </div>

                    <!-- QR Code Section -->
                    <div style="margin-top: 24px; padding: 20px; background: var(--bg-tertiary); border-radius: 12px;">
                        <h4 style="margin-bottom: 16px;">H5报名链接</h4>
                        <div style="display: flex; align-items: center; gap: 16px;">
                            <div style="flex: 1; padding: 12px; background: var(--bg-primary); border-radius: 8px; font-family: monospace; font-size: 13px; color: var(--text-secondary);">
                                https://camp.example.com/enroll/12345
                            </div>
                            <button class="btn btn-outline btn-sm" onclick="copyLink()">📋 复制链接</button>
                            <button class="btn btn-primary btn-sm" onclick="showQRCode()">📱 显示二维码</button>
                        </div>
                    </div>
                </div>

                <!-- Tab: Members -->
                <div class="detail-tab" id="tab-members">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>星球昵称</th>
                                <th>星球ID</th>
                                <th>微信昵称</th>
                                <th>支付时间</th>
                                <th>匹配状态</th>
                                <th>进群状态</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>球球的副业探索</td>
                                <td>88455815</td>
                                <td>小球球</td>
                                <td>2025-01-01 10:30</td>
                                <td><span class="status-badge success">● 已匹配</span></td>
                                <td><span class="status-badge success">● 已进群</span></td>
                                <td><button class="action-btn view">详情</button></td>
                            </tr>
                            <tr>
                                <td>学习达人小明</td>
                                <td>88123457</td>
                                <td>明明</td>
                                <td>2025-01-01 11:15</td>
                                <td><span class="status-badge pending">● 待匹配</span></td>
                                <td><span class="status-badge success">● 已进群</span></td>
                                <td>
                                    <button class="action-btn view">详情</button>
                                    <button class="action-btn approve">手动匹配</button>
                                </td>
                            </tr>
                            <tr>
                                <td>努力工作的小红</td>
                                <td>88123456</td>
                                <td>红红</td>
                                <td>2025-01-01 14:20</td>
                                <td><span class="status-badge success">● 已匹配</span></td>
                                <td><span class="status-badge failed">● 未进群</span></td>
                                <td>
                                    <button class="action-btn view">详情</button>
                                    <button class="action-btn approve">标记进群</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Tab: Checkins -->
                <div class="detail-tab" id="tab-checkins">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>会员信息</th>
                                <th>已打卡/要求</th>
                                <th>完成率</th>
                                <th>是否达标</th>
                                <th>最后打卡时间</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <strong>球球的副业探索</strong>
                                    <br><small style="color: var(--text-muted);">ID: 88455815</small>
                                </td>
                                <td>16/15</td>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 8px;">
                                        <div class="progress-bar" style="width: 80px;">
                                            <div class="progress-bar-fill" style="width: 100%;"></div>
                                        </div>
                                        <span>107%</span>
                                    </div>
                                </td>
                                <td><span class="status-badge success">✓ 达标</span></td>
                                <td>2025-01-15 07:32</td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>学习达人小明</strong>
                                    <br><small style="color: var(--text-muted);">ID: 88123457</small>
                                </td>
                                <td>12/15</td>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 8px;">
                                        <div class="progress-bar" style="width: 80px;">
                                            <div class="progress-bar-fill" style="width: 80%;"></div>
                                        </div>
                                        <span>80%</span>
                                    </div>
                                </td>
                                <td><span class="status-badge pending">⏳ 进行中</span></td>
                                <td>2025-01-15 08:15</td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>努力工作的小红</strong>
                                    <br><small style="color: var(--text-muted);">ID: 88123456</small>
                                </td>
                                <td>8/15</td>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 8px;">
                                        <div class="progress-bar" style="width: 80px;">
                                            <div class="progress-bar-fill" style="width: 53%; background: linear-gradient(90deg, var(--accent-orange), #f59e0b);"></div>
                                        </div>
                                        <span>53%</span>
                                    </div>
                                </td>
                                <td><span class="status-badge failed">✗ 未达标</span></td>
                                <td>2025-01-10 09:45</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Tab: Refunds -->
                <div class="detail-tab" id="tab-refunds">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>会员信息</th>
                                <th>打卡完成</th>
                                <th>退款金额</th>
                                <th>审核状态</th>
                                <th>退款状态</th>
                                <th>操作时间</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <strong>球球的副业探索</strong>
                                    <br><small style="color: var(--text-muted);">ID: 88455815</small>
                                </td>
                                <td><span style="color: var(--accent-green);">16/15 ✓</span></td>
                                <td style="color: var(--accent-orange); font-weight: 600;">¥99</td>
                                <td><span class="status-badge success">✓ 已通过</span></td>
                                <td><span class="status-badge success">● 已退款</span></td>
                                <td>2025-01-16 10:30</td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>早起打卡王</strong>
                                    <br><small style="color: var(--text-muted);">ID: 88123460</small>
                                </td>
                                <td><span style="color: var(--accent-green);">18/15 ✓</span></td>
                                <td style="color: var(--accent-orange); font-weight: 600;">¥99</td>
                                <td><span class="status-badge success">✓ 已通过</span></td>
                                <td><span class="status-badge pending">● 退款中</span></td>
                                <td>2025-01-16 11:00</td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>坚持早起的小李</strong>
                                    <br><small style="color: var(--text-muted);">ID: 88123458</small>
                                </td>
                                <td><span style="color: var(--accent-red);">14/15 ✗</span></td>
                                <td style="color: var(--text-muted);">¥99</td>
                                <td><span class="status-badge failed">✗ 已拒绝</span></td>
                                <td><span class="status-badge ended">-</span></td>
                                <td>2025-01-16 10:45</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeCampDetailDrawer()">关闭</button>
                <button class="btn btn-primary" id="editCampBtn" onclick="editCampFromDetail()">编辑训练营</button>
            </div>
        </div>
    </div>

    <!-- Checkin Detail Drawer -->
    <div class="modal-overlay" id="checkinDetailDrawer">
        <div class="modal" style="width: 700px;">
            <div class="modal-header">
                <h3 class="modal-title" id="checkinDetailTitle">打卡详情</h3>
                <button class="modal-close" onclick="closeCheckinDetailDrawer()">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Member Info -->
                <div style="display: flex; gap: 24px; margin-bottom: 24px;">
                    <div style="width: 64px; height: 64px; background: linear-gradient(135deg, var(--accent-green), var(--accent-cyan)); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; font-weight: 600;">
                        球
                    </div>
                    <div style="flex: 1;">
                        <h3 style="font-size: 18px; margin-bottom: 8px;" id="checkinDetailMemberName">球球的副业探索</h3>
                        <div style="display: flex; gap: 24px; font-size: 13px; color: var(--text-secondary);">
                            <span>星球ID: <span id="checkinDetailPlanetId">88455815</span></span>
                            <span>训练营: <span id="checkinDetailCampName">21天早起训练营</span></span>
                        </div>
                    </div>
                </div>

                <!-- Progress Stats -->
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 24px;">
                    <div style="padding: 16px; background: var(--bg-tertiary); border-radius: 8px; text-align: center;">
                        <div style="font-size: 24px; font-weight: 700; color: var(--accent-blue);" id="checkinDetailCheckedDays">16</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">已打卡</div>
                    </div>
                    <div style="padding: 16px; background: var(--bg-tertiary); border-radius: 8px; text-align: center;">
                        <div style="font-size: 24px; font-weight: 700; color: var(--text-primary);" id="checkinDetailRequiredDays">15</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">要求天数</div>
                    </div>
                    <div style="padding: 16px; background: var(--bg-tertiary); border-radius: 8px; text-align: center;">
                        <div style="font-size: 24px; font-weight: 700; color: var(--accent-green);" id="checkinDetailRate">107%</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">完成率</div>
                    </div>
                    <div style="padding: 16px; background: var(--bg-tertiary); border-radius: 8px; text-align: center;">
                        <div id="checkinDetailStatus">
                            <span class="status-badge success">✓ 达标</span>
                        </div>
                        <div style="font-size: 12px; color: var(--text-secondary); margin-top: 8px;">状态</div>
                    </div>
                </div>

                <!-- Calendar View -->
                <div class="content-card" style="margin-bottom: 24px;">
                    <div class="card-header">
                        <h3 class="card-title">打卡日历</h3>
                    </div>
                    <div class="card-body">
                        <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; text-align: center; margin-bottom: 8px;">
                            <div style="font-size: 12px; color: var(--text-muted);">一</div>
                            <div style="font-size: 12px; color: var(--text-muted);">二</div>
                            <div style="font-size: 12px; color: var(--text-muted);">三</div>
                            <div style="font-size: 12px; color: var(--text-muted);">四</div>
                            <div style="font-size: 12px; color: var(--text-muted);">五</div>
                            <div style="font-size: 12px; color: var(--text-muted);">六</div>
                            <div style="font-size: 12px; color: var(--text-muted);">日</div>
                        </div>
                        <div class="checkin-calendar-grid" id="checkinDetailCalendar">
                            <!-- Week 1 -->
                            <div class="checkin-day checked">1</div>
                            <div class="checkin-day checked">2</div>
                            <div class="checkin-day missed">3</div>
                            <div class="checkin-day checked">4</div>
                            <div class="checkin-day checked">5</div>
                            <div class="checkin-day checked">6</div>
                            <div class="checkin-day checked">7</div>
                            <!-- Week 2 -->
                            <div class="checkin-day checked">8</div>
                            <div class="checkin-day checked">9</div>
                            <div class="checkin-day checked">10</div>
                            <div class="checkin-day checked">11</div>
                            <div class="checkin-day checked">12</div>
                            <div class="checkin-day checked">13</div>
                            <div class="checkin-day checked">14</div>
                            <!-- Week 3 -->
                            <div class="checkin-day checked">15</div>
                            <div class="checkin-day future">16</div>
                            <div class="checkin-day future">17</div>
                            <div class="checkin-day future">18</div>
                            <div class="checkin-day future">19</div>
                            <div class="checkin-day future">20</div>
                            <div class="checkin-day future">21</div>
                        </div>
                        <div style="display: flex; justify-content: center; gap: 24px; margin-top: 16px; font-size: 12px; color: var(--text-secondary);">
                            <div style="display: flex; align-items: center; gap: 6px;">
                                <div style="width: 12px; height: 12px; background: rgba(63, 185, 80, 0.2); border-radius: 4px;"></div>
                                <span>已打卡</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 6px;">
                                <div style="width: 12px; height: 12px; background: rgba(248, 81, 73, 0.2); border-radius: 4px;"></div>
                                <span>未打卡</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 6px;">
                                <div style="width: 12px; height: 12px; background: var(--bg-primary); border-radius: 4px;"></div>
                                <span>未到</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Checkin Records -->
                <div class="content-card">
                    <div class="card-header">
                        <h3 class="card-title">打卡记录</h3>
                    </div>
                    <div class="card-body" style="max-height: 300px; overflow-y: auto;">
                        <div id="checkinDetailRecords">
                            <div class="checkin-record-item">
                                <div class="checkin-record-date">
                                    <div class="date">01-15</div>
                                    <div class="day">周三</div>
                                </div>
                                <div class="checkin-record-status checked">✓</div>
                                <div class="checkin-record-content">
                                    <div class="checkin-record-time">07:32 打卡</div>
                                    <div class="checkin-record-preview">今天早起感觉特别好，坚持就是胜利！</div>
                                </div>
                            </div>
                            <div class="checkin-record-item">
                                <div class="checkin-record-date">
                                    <div class="date">01-14</div>
                                    <div class="day">周二</div>
                                </div>
                                <div class="checkin-record-status checked">✓</div>
                                <div class="checkin-record-content">
                                    <div class="checkin-record-time">06:58 打卡</div>
                                    <div class="checkin-record-preview">第14天，已经形成习惯了</div>
                                </div>
                            </div>
                            <div class="checkin-record-item">
                                <div class="checkin-record-date">
                                    <div class="date">01-13</div>
                                    <div class="day">周一</div>
                                </div>
                                <div class="checkin-record-status checked">✓</div>
                                <div class="checkin-record-content">
                                    <div class="checkin-record-time">07:15 打卡</div>
                                    <div class="checkin-record-preview">新的一周开始，继续加油！</div>
                                </div>
                            </div>
                            <div class="checkin-record-item">
                                <div class="checkin-record-date">
                                    <div class="date">01-03</div>
                                    <div class="day">周五</div>
                                </div>
                                <div class="checkin-record-status missed">✗</div>
                                <div class="checkin-record-content">
                                    <div class="checkin-record-time">未打卡</div>
                                    <div class="checkin-record-preview" style="color: var(--accent-red);">错过打卡</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeCheckinDetailDrawer()">关闭</button>
            </div>
        </div>
    </div>

    <!-- Day Checkin List Drawer -->
    <div class="modal-overlay" id="dayCheckinDrawer">
        <div class="modal" style="width: 600px;">
            <div class="modal-header">
                <h3 class="modal-title" id="dayCheckinTitle">2025-01-15 打卡详情</h3>
                <button class="modal-close" onclick="closeDayCheckinDrawer()">&times;</button>
            </div>
            <div class="modal-body">
                <div style="margin-bottom: 16px; padding: 16px; background: var(--bg-tertiary); border-radius: 8px; display: flex; justify-content: space-around; text-align: center;">
                    <div>
                        <div style="font-size: 24px; font-weight: 700; color: var(--accent-green);" id="dayCheckinCount">125</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">打卡人数</div>
                    </div>
                    <div>
                        <div style="font-size: 24px; font-weight: 700; color: var(--text-primary);" id="dayTotalCount">156</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">总人数</div>
                    </div>
                    <div>
                        <div style="font-size: 24px; font-weight: 700; color: var(--accent-blue);" id="dayCheckinRate">80%</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">打卡率</div>
                    </div>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>会员</th>
                            <th>打卡时间</th>
                            <th>状态</th>
                        </tr>
                    </thead>
                    <tbody id="dayCheckinList">
                        <tr>
                            <td>
                                <strong>球球的副业探索</strong>
                                <br><small style="color: var(--text-muted);">ID: 88455815</small>
                            </td>
                            <td>07:32</td>
                            <td><span class="status-badge success">✓ 已打卡</span></td>
                        </tr>
                        <tr>
                            <td>
                                <strong>学习达人小明</strong>
                                <br><small style="color: var(--text-muted);">ID: 88123457</small>
                            </td>
                            <td>08:15</td>
                            <td><span class="status-badge success">✓ 已打卡</span></td>
                        </tr>
                        <tr>
                            <td>
                                <strong>努力工作的小红</strong>
                                <br><small style="color: var(--text-muted);">ID: 88123456</small>
                            </td>
                            <td>-</td>
                            <td><span class="status-badge failed">✗ 未打卡</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeDayCheckinDrawer()">关闭</button>
            </div>
        </div>
    </div>

    <!-- Member Detail Drawer -->
    <div class="modal-overlay" id="memberDetailDrawer" onclick="closeMemberDetailDrawer()">
        <div class="drawer-container" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2>会员详情</h2>
                <button class="modal-close" onclick="closeMemberDetailDrawer()">&times;</button>
            </div>
            <div class="modal-body" style="padding: 0;">
                <!-- Member Info Card -->
                <div style="padding: 24px; background: var(--bg-secondary); border-bottom: 1px solid var(--border-color);">
                    <div style="display: flex; gap: 20px; align-items: flex-start;">
                        <div style="width: 80px; height: 80px; border-radius: 50%; background: linear-gradient(135deg, #58a6ff, #1f6feb); display: flex; align-items: center; justify-content: center; font-size: 32px; color: white; font-weight: bold;" id="memberDetailAvatar">球</div>
                        <div style="flex: 1;">
                            <h3 style="margin: 0 0 8px; font-size: 20px;" id="memberDetailName">球球的副业探索</h3>
                            <div style="display: flex; flex-wrap: wrap; gap: 16px; color: var(--text-muted); font-size: 14px;">
                                <span>星球ID: <strong style="color: var(--text-primary);" id="memberDetailPlanetId">88455815</strong></span>
                                <span>微信昵称: <strong style="color: var(--text-primary);" id="memberDetailWechatName">小球球</strong></span>
                            </div>
                            <div style="display: flex; gap: 12px; margin-top: 12px;">
                                <span class="status-badge success" id="memberDetailMatchStatus">已匹配 100%</span>
                                <span class="status-badge success" id="memberDetailGroupStatus">已进群</span>
                            </div>
                        </div>
                        <div style="display: flex; gap: 8px;">
                            <button class="btn btn-outline" onclick="openManualMatchModal(currentMemberId)">🔗 重新匹配</button>
                            <button class="btn btn-outline" onclick="toggleGroupStatus()">📱 标记进群</button>
                        </div>
                    </div>
                </div>

                <!-- Tabs -->
                <div style="padding: 0 24px; background: var(--bg-secondary); border-bottom: 1px solid var(--border-color);">
                    <div class="tab-nav">
                        <button class="tab-btn active" onclick="switchMemberDetailTab(this, 'payment')">支付记录</button>
                        <button class="tab-btn" onclick="switchMemberDetailTab(this, 'checkin')">打卡记录</button>
                        <button class="tab-btn" onclick="switchMemberDetailTab(this, 'refund')">退款记录</button>
                    </div>
                </div>

                <!-- Tab Content -->
                <div style="padding: 24px;">
                    <!-- Payment Records Tab -->
                    <div class="member-detail-tab active" id="memberPaymentTab">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>支付时间</th>
                                    <th>训练营</th>
                                    <th>金额</th>
                                    <th>订单号</th>
                                    <th>状态</th>
                                </tr>
                            </thead>
                            <tbody id="memberPaymentRecords">
                                <tr>
                                    <td>2025-01-01 10:30:25</td>
                                    <td>21天早起训练营</td>
                                    <td style="color: var(--accent-orange); font-weight: 600;">¥99</td>
                                    <td style="font-family: monospace;">PAY20250101103025001</td>
                                    <td><span class="status-badge success">已支付</span></td>
                                </tr>
                                <tr>
                                    <td>2024-12-01 09:15:30</td>
                                    <td>7天读书打卡营</td>
                                    <td style="color: var(--accent-orange); font-weight: 600;">¥49</td>
                                    <td style="font-family: monospace;">PAY20241201091530001</td>
                                    <td><span class="status-badge success">已支付</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Checkin Records Tab -->
                    <div class="member-detail-tab" id="memberCheckinTab">
                        <div style="margin-bottom: 20px;">
                            <select class="filter-select" id="memberCheckinCampFilter" onchange="filterMemberCheckins()">
                                <option value="">选择训练营</option>
                                <option value="1" selected>21天早起训练营</option>
                                <option value="2">7天读书打卡营</option>
                            </select>
                        </div>

                        <!-- Stats Cards -->
                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 24px;">
                            <div style="padding: 16px; background: var(--bg-tertiary); border-radius: 8px; text-align: center;">
                                <div style="font-size: 28px; font-weight: 700; color: var(--accent-green);" id="memberCheckinCount">16</div>
                                <div style="font-size: 12px; color: var(--text-muted);">已打卡天数</div>
                            </div>
                            <div style="padding: 16px; background: var(--bg-tertiary); border-radius: 8px; text-align: center;">
                                <div style="font-size: 28px; font-weight: 700; color: var(--text-primary);" id="memberRequiredDays">15</div>
                                <div style="font-size: 12px; color: var(--text-muted);">要求天数</div>
                            </div>
                            <div style="padding: 16px; background: var(--bg-tertiary); border-radius: 8px; text-align: center;">
                                <div style="font-size: 28px; font-weight: 700; color: var(--accent-blue);" id="memberCheckinRate">76%</div>
                                <div style="font-size: 12px; color: var(--text-muted);">完成��</div>
                            </div>
                            <div style="padding: 16px; background: var(--bg-tertiary); border-radius: 8px; text-align: center;">
                                <div style="font-size: 28px; font-weight: 700; color: var(--accent-green);" id="memberQualifyStatus">✓</div>
                                <div style="font-size: 12px; color: var(--text-muted);">已达标</div>
                            </div>
                        </div>

                        <!-- Calendar View -->
                        <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 16px; margin-bottom: 20px;">
                            <div style="font-weight: 600; margin-bottom: 12px;">打卡日历</div>
                            <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; text-align: center; margin-bottom: 8px;">
                                <span style="font-size: 12px; color: var(--text-muted);">一</span>
                                <span style="font-size: 12px; color: var(--text-muted);">二</span>
                                <span style="font-size: 12px; color: var(--text-muted);">三</span>
                                <span style="font-size: 12px; color: var(--text-muted);">四</span>
                                <span style="font-size: 12px; color: var(--text-muted);">五</span>
                                <span style="font-size: 12px; color: var(--text-muted);">六</span>
                                <span style="font-size: 12px; color: var(--text-muted);">日</span>
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px;" id="memberCheckinCalendar">
                                <!-- Generated by JS -->
                            </div>
                        </div>

                        <!-- Checkin List -->
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>日期</th>
                                    <th>打卡时间</th>
                                    <th>状态</th>
                                </tr>
                            </thead>
                            <tbody id="memberCheckinList">
                                <tr>
                                    <td>2025-01-15</td>
                                    <td>06:45:30</td>
                                    <td><span class="status-badge success">✓ 已打卡</span></td>
                                </tr>
                                <tr>
                                    <td>2025-01-14</td>
                                    <td>07:02:15</td>
                                    <td><span class="status-badge success">✓ 已打卡</span></td>
                                </tr>
                                <tr>
                                    <td>2025-01-13</td>
                                    <td>-</td>
                                    <td><span class="status-badge failed">✗ 未打卡</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Refund Records Tab -->
                    <div class="member-detail-tab" id="memberRefundTab">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>时间</th>
                                    <th>训练营</th>
                                    <th>金额</th>
                                    <th>状态</th>
                                    <th>操作人</th>
                                </tr>
                            </thead>
                            <tbody id="memberRefundRecords">
                                <tr>
                                    <td>2024-12-08 14:30:00</td>
                                    <td>7天读书打卡营</td>
                                    <td style="color: var(--accent-green); font-weight: 600;">¥49</td>
                                    <td><span class="status-badge success">已退款</span></td>
                                    <td>管理员</td>
                                </tr>
                            </tbody>
                        </table>
                        <div style="text-align: center; padding: 40px; color: var(--text-muted);" id="memberNoRefundTip" style="display: none;">
                            当前训练营暂无退款记录
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeMemberDetailDrawer()">关闭</button>
            </div>
        </div>
    </div>

    <!-- Manual Match Modal -->
    <div class="modal-overlay" id="manualMatchModal" onclick="closeManualMatchModal()">
        <div class="modal-container" style="max-width: 600px;" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2>手动匹配会员</h2>
                <button class="modal-close" onclick="closeManualMatchModal()">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Current Member Info -->
                <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 16px; margin-bottom: 20px;">
                    <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 8px;">待匹配会员信息</div>
                    <div style="display: flex; gap: 20px; align-items: center;">
                        <div style="width: 48px; height: 48px; border-radius: 50%; background: linear-gradient(135deg, #f85149, #da3633); display: flex; align-items: center; justify-content: center; font-size: 20px; color: white;" id="matchMemberAvatar">微</div>
                        <div>
                            <div style="font-weight: 600;" id="matchMemberName">微信用户A</div>
                            <div style="font-size: 13px; color: var(--text-muted);">
                                星球ID: <span id="matchMemberPlanetId">-</span> |
                                微信昵称: <span id="matchMemberWechatName">微信用户A</span>
                            </div>
                        </div>
                        <span class="status-badge failed" style="margin-left: auto;">匹配失败</span>
                    </div>
                </div>

                <!-- Search -->
                <div style="margin-bottom: 20px;">
                    <label class="form-label">搜索知识星球用户</label>
                    <div style="display: flex; gap: 8px;">
                        <input type="text" class="form-input" id="matchSearchInput" placeholder="输入星球ID或昵称搜索..." style="flex: 1;">
                        <button class="btn btn-primary" onclick="searchPlanetUsers()">🔍 搜索</button>
                    </div>
                </div>

                <!-- Search Results -->
                <div style="margin-bottom: 20px;">
                    <label class="form-label">搜索结果</label>
                    <div style="max-height: 300px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;" id="matchSearchResults">
                        <div class="match-user-item" onclick="selectMatchUser('88455815', '球球的副业探索')">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <div style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #58a6ff, #1f6feb); display: flex; align-items: center; justify-content: center; color: white;">球</div>
                                <div>
                                    <div style="font-weight: 600;">球球的副业探索</div>
                                    <div style="font-size: 12px; color: var(--text-muted);">ID: 88455815</div>
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-size: 13px; color: var(--accent-green);">已打卡 16 天</div>
                                <div style="font-size: 12px; color: var(--text-muted);">21天早起训练营</div>
                            </div>
                        </div>
                        <div class="match-user-item" onclick="selectMatchUser('88123457', '爱学习的小明')">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <div style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #3fb950, #238636); display: flex; align-items: center; justify-content: center; color: white;">爱</div>
                                <div>
                                    <div style="font-weight: 600;">爱学习的小明</div>
                                    <div style="font-size: 12px; color: var(--text-muted);">ID: 88123457</div>
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-size: 13px; color: var(--accent-green);">已打卡 14 天</div>
                                <div style="font-size: 12px; color: var(--text-muted);">21天早起训练营</div>
                            </div>
                        </div>
                        <div class="match-user-item" onclick="selectMatchUser('88123456', '努力工作的小红')">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <div style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #f85149, #da3633); display: flex; align-items: center; justify-content: center; color: white;">努</div>
                                <div>
                                    <div style="font-weight: 600;">努力工作的小红</div>
                                    <div style="font-size: 12px; color: var(--text-muted);">ID: 88123456</div>
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-size: 13px; color: var(--accent-orange);">已打卡 10 天</div>
                                <div style="font-size: 12px; color: var(--text-muted);">21天早起训练营</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Selected User -->
                <div style="background: rgba(63, 185, 80, 0.1); border: 1px solid var(--accent-green); border-radius: 8px; padding: 16px; display: none;" id="selectedMatchUser">
                    <div style="font-size: 12px; color: var(--accent-green); margin-bottom: 8px;">✓ 已选择匹配对象</div>
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #58a6ff, #1f6feb); display: flex; align-items: center; justify-content: center; color: white;" id="selectedUserAvatar">球</div>
                        <div>
                            <div style="font-weight: 600;" id="selectedUserName">球球的副业探索</div>
                            <div style="font-size: 12px; color: var(--text-muted);">ID: <span id="selectedUserId">88455815</span></div>
                        </div>
                        <button class="btn btn-outline" style="margin-left: auto; padding: 4px 12px; font-size: 12px;" onclick="clearSelectedUser()">取消选择</button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeManualMatchModal()">取消</button>
                <button class="btn btn-primary" onclick="confirmManualMatch()" id="confirmMatchBtn" disabled>确认匹配</button>
            </div>
        </div>
    </div>

    <!-- Refund Detail Drawer -->
    <div class="drawer-overlay" id="refundDetailDrawer" onclick="closeRefundDetailDrawer()">
        <div class="drawer-container" onclick="event.stopPropagation()">
            <div class="drawer-header">
                <h2>退款详情</h2>
                <button class="drawer-close" onclick="closeRefundDetailDrawer()">&times;</button>
            </div>
            <div class="drawer-body">
                <!-- Member Info -->
                <div class="detail-section">
                    <div class="detail-section-title">会员信息</div>
                    <div style="display: flex; gap: 16px; align-items: center; margin-bottom: 16px;">
                        <div style="width: 56px; height: 56px; border-radius: 50%; background: linear-gradient(135deg, #58a6ff, #1f6feb); display: flex; align-items: center; justify-content: center; font-size: 24px; color: white;" id="refundMemberAvatar">球</div>
                        <div style="flex: 1;">
                            <div style="font-size: 18px; font-weight: 600; margin-bottom: 4px;" id="refundMemberName">球球的副业探索</div>
                            <div style="font-size: 13px; color: var(--text-muted);">
                                星球ID: <span id="refundMemberPlanetId">88455815</span> |
                                微信昵称: <span id="refundMemberWechatName">小球球</span>
                            </div>
                        </div>
                        <div style="text-align: right;">
                            <span class="confidence-high" id="refundMemberConfidence">100%</span>
                            <div style="font-size: 12px; color: var(--text-muted);">匹配置信度</div>
                        </div>
                    </div>
                </div>

                <!-- Camp & Checkin Info -->
                <div class="detail-section">
                    <div class="detail-section-title">训练营 & 打卡信息</div>
                    <div class="refund-info-grid">
                        <div class="refund-info-item">
                            <div class="label">训练营</div>
                            <div class="value" id="refundCampName">21天早起训练营</div>
                        </div>
                        <div class="refund-info-item">
                            <div class="label">押金金额</div>
                            <div class="value amount" id="refundAmount">¥99.00</div>
                        </div>
                        <div class="refund-info-item">
                            <div class="label">打卡要求</div>
                            <div class="value" id="refundRequirement">21天15打卡</div>
                        </div>
                        <div class="refund-info-item">
                            <div class="label">实际打卡</div>
                            <div class="value" id="refundActualCheckin">16天</div>
                        </div>
                    </div>

                    <!-- Checkin Calendar -->
                    <div style="margin-top: 16px;">
                        <div style="font-size: 13px; color: var(--text-muted); margin-bottom: 8px;">打卡日历</div>
                        <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px;" id="refundCheckinCalendar">
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; color: var(--text-muted);">一</div>
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; color: var(--text-muted);">二</div>
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; color: var(--text-muted);">三</div>
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; color: var(--text-muted);">四</div>
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; color: var(--text-muted);">五</div>
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; color: var(--text-muted);">六</div>
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; color: var(--text-muted);">日</div>
                            <!-- Sample calendar days -->
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; background: var(--accent-green); color: white; border-radius: 4px;">1</div>
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; background: var(--accent-green); color: white; border-radius: 4px;">2</div>
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; background: rgba(248, 81, 73, 0.3); color: var(--accent-red); border-radius: 4px;">3</div>
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; background: var(--accent-green); color: white; border-radius: 4px;">4</div>
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; background: var(--accent-green); color: white; border-radius: 4px;">5</div>
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; background: var(--accent-green); color: white; border-radius: 4px;">6</div>
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; background: var(--accent-green); color: white; border-radius: 4px;">7</div>
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; background: var(--accent-green); color: white; border-radius: 4px;">8</div>
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; background: var(--accent-green); color: white; border-radius: 4px;">9</div>
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; background: rgba(248, 81, 73, 0.3); color: var(--accent-red); border-radius: 4px;">10</div>
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; background: var(--accent-green); color: white; border-radius: 4px;">11</div>
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; background: var(--accent-green); color: white; border-radius: 4px;">12</div>
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; background: var(--accent-green); color: white; border-radius: 4px;">13</div>
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; background: var(--accent-green); color: white; border-radius: 4px;">14</div>
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; background: var(--accent-green); color: white; border-radius: 4px;">15</div>
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; background: var(--accent-green); color: white; border-radius: 4px;">16</div>
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; background: rgba(248, 81, 73, 0.3); color: var(--accent-red); border-radius: 4px;">17</div>
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; background: rgba(248, 81, 73, 0.3); color: var(--accent-red); border-radius: 4px;">18</div>
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; background: rgba(248, 81, 73, 0.3); color: var(--accent-red); border-radius: 4px;">19</div>
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; background: var(--bg-tertiary); color: var(--text-muted); border-radius: 4px;">20</div>
                            <div style="padding: 8px 4px; text-align: center; font-size: 12px; background: var(--bg-tertiary); color: var(--text-muted); border-radius: 4px;">21</div>
                        </div>
                        <div style="display: flex; gap: 16px; margin-top: 8px; font-size: 12px; color: var(--text-muted);">
                            <div><span style="display: inline-block; width: 12px; height: 12px; background: var(--accent-green); border-radius: 2px; margin-right: 4px;"></span>已打卡</div>
                            <div><span style="display: inline-block; width: 12px; height: 12px; background: rgba(248, 81, 73, 0.3); border-radius: 2px; margin-right: 4px;"></span>未打卡</div>
                            <div><span style="display: inline-block; width: 12px; height: 12px; background: var(--bg-tertiary); border-radius: 2px; margin-right: 4px;"></span>未开始</div>
                        </div>
                    </div>
                </div>

                <!-- System Judgment -->
                <div class="detail-section">
                    <div class="detail-section-title">系统判断</div>
                    <div style="display: flex; align-items: center; gap: 16px; padding: 16px; background: rgba(63, 185, 80, 0.1); border-radius: 8px; border: 1px solid var(--accent-green);" id="refundJudgmentBox">
                        <div style="font-size: 32px;">✅</div>
                        <div>
                            <div style="font-size: 16px; font-weight: 600; color: var(--accent-green);" id="refundJudgmentTitle">符合退款条件</div>
                            <div style="font-size: 13px; color: var(--text-secondary);" id="refundJudgmentDesc">打卡天数（16天）≥ 要求天数（15天），建议审核通过</div>
                        </div>
                    </div>
                </div>

                <!-- Operation Log -->
                <div class="detail-section">
                    <div class="detail-section-title">操作日志</div>
                    <div class="operation-log" id="refundOperationLog">
                        <div class="log-item">
                            <div class="log-icon">📝</div>
                            <div class="log-content">
                                <div class="log-title">创建退款审核记录</div>
                                <div class="log-meta">系统 · 2025-01-22 02:00:00</div>
                            </div>
                        </div>
                        <div class="log-item">
                            <div class="log-icon">🔗</div>
                            <div class="log-content">
                                <div class="log-title">自动匹配成功（置信度100%）</div>
                                <div class="log-meta">系统 · 2025-01-22 02:00:01</div>
                            </div>
                        </div>
                        <div class="log-item">
                            <div class="log-icon">✅</div>
                            <div class="log-content">
                                <div class="log-title">系统判断：符合退款条件</div>
                                <div class="log-meta">系统 · 2025-01-22 02:00:02</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="drawer-footer" id="refundDetailFooter">
                <button class="btn btn-outline" onclick="closeRefundDetailDrawer()">关闭</button>
                <button class="btn btn-danger" onclick="openRejectModal(currentRefundId)" id="refundRejectBtn">拒绝退款</button>
                <button class="btn btn-success" onclick="approveRefund(currentRefundId)" id="refundApproveBtn">审核通过</button>
            </div>
        </div>
    </div>

    <!-- Reject Reason Modal -->
    <div class="modal-overlay" id="rejectReasonModal" onclick="closeRejectModal()">
        <div class="modal-container" style="max-width: 500px;" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2>拒绝退款</h2>
                <button class="modal-close" onclick="closeRejectModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div style="background: rgba(248, 81, 73, 0.1); border-radius: 8px; padding: 12px; margin-bottom: 20px; display: flex; gap: 12px; align-items: center;">
                    <div style="font-size: 24px;">⚠️</div>
                    <div>
                        <div style="font-weight: 600; color: var(--accent-red);">确定拒绝退款吗？</div>
                        <div style="font-size: 13px; color: var(--text-secondary);">拒绝后会员将无法收到退款，请确认理由</div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">拒绝理由 <span style="color: var(--accent-red);">*</span></label>
                    <div class="reject-quick-reasons">
                        <button type="button" class="quick-reason-btn" onclick="setRejectReason('打卡天数未达标')">打卡天数未达标</button>
                        <button type="button" class="quick-reason-btn" onclick="setRejectReason('匹配信息有误')">匹配信息有误</button>
                        <button type="button" class="quick-reason-btn" onclick="setRejectReason('存在刷卡行为')">存在刷卡行为</button>
                        <button type="button" class="quick-reason-btn" onclick="setRejectReason('已中途退出')">已中途退出</button>
                    </div>
                    <textarea class="reject-reason-input" id="rejectReasonInput" placeholder="请输入拒绝理由..."></textarea>
                </div>

                <div style="font-size: 12px; color: var(--text-muted); margin-top: 12px;">
                    💡 提示：拒绝理由将记录在系统日志中，会员可能会查询
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeRejectModal()">取消</button>
                <button class="btn btn-danger" onclick="confirmReject()" id="confirmRejectBtn">确认拒绝</button>
            </div>
        </div>
    </div>

    <!-- Batch Progress Modal -->
    <div class="modal-overlay" id="batchProgressModal">
        <div class="modal-container" style="max-width: 400px;">
            <div class="modal-header">
                <h2>批量处理中</h2>
            </div>
            <div class="modal-body" style="text-align: center; padding: 40px 20px;">
                <div style="font-size: 48px; margin-bottom: 20px;" id="batchProgressIcon">⏳</div>
                <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;" id="batchProgressTitle">正在处理退款...</div>
                <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 20px;" id="batchProgressDesc">请稍候，正在逐条执行退款操作</div>
                <div style="background: var(--bg-tertiary); border-radius: 8px; height: 8px; overflow: hidden;">
                    <div style="background: var(--accent-blue); height: 100%; width: 0%; transition: width 0.3s;" id="batchProgressBar"></div>
                </div>
                <div style="margin-top: 12px; font-size: 13px; color: var(--text-muted);">
                    <span id="batchProgressCurrent">0</span> / <span id="batchProgressTotal">0</span> 条
                </div>
            </div>
        </div>
    </div>

    <!-- User Create/Edit Modal -->
    <div class="modal-overlay" id="userModal">
        <div class="modal" style="width: 500px;">
            <div class="modal-header">
                <h3 class="modal-title" id="userModalTitle">添加用户</h3>
                <button class="modal-close" onclick="closeUserModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-section" style="border: none; padding: 0; margin: 0;">
                    <div class="form-item" style="margin-bottom: 20px;">
                        <label class="form-label">用户名 <span class="required">*</span></label>
                        <input type="text" class="form-control" id="userUsername" placeholder="请输入用户名">
                        <div class="form-help">用户名用于登录，创建后不可修改</div>
                    </div>
                    <div class="form-item" style="margin-bottom: 20px;" id="passwordField">
                        <label class="form-label">密码 <span class="required">*</span></label>
                        <div class="config-input-group">
                            <input type="password" class="form-control" id="userPassword" placeholder="请输入密码">
                            <button class="btn btn-sm btn-outline" onclick="togglePasswordVisibility('userPassword', this)">显示</button>
                        </div>
                        <div class="form-help">密码长度至少6位</div>
                    </div>
                    <div class="form-item" style="margin-bottom: 20px;" id="confirmPasswordField">
                        <label class="form-label">确认密码 <span class="required">*</span></label>
                        <input type="password" class="form-control" id="userConfirmPassword" placeholder="请再次输入密码">
                    </div>
                    <div class="form-item" style="margin-bottom: 20px;">
                        <label class="form-label">角色 <span class="required">*</span></label>
                        <select class="form-control" id="userRole">
                            <option value="">请选择角色</option>
                            <option value="admin">管理员</option>
                            <option value="coach">教练</option>
                            <option value="volunteer">志愿者</option>
                        </select>
                        <div class="form-help">
                            <div style="margin-top: 8px;">
                                <div style="margin-bottom: 4px;"><strong>管理员：</strong>审核退款、查看报表、管理训练营</div>
                                <div style="margin-bottom: 4px;"><strong>教练：</strong>查看负责项目、催促打卡、参与审核</div>
                                <div><strong>志愿者：</strong>查看项目、催促打卡</div>
                            </div>
                        </div>
                    </div>
                    <div class="form-item" style="margin-bottom: 20px;">
                        <label class="form-label">状态</label>
                        <div class="radio-group">
                            <label class="radio-item active" onclick="selectRadio(this, 'userStatus')">
                                <input type="radio" name="userStatus" value="enabled" checked>
                                <span class="radio-dot"></span>
                                <span class="radio-label">启用</span>
                            </label>
                            <label class="radio-item" onclick="selectRadio(this, 'userStatus')">
                                <input type="radio" name="userStatus" value="disabled">
                                <span class="radio-dot"></span>
                                <span class="radio-label">禁用</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeUserModal()">取消</button>
                <button class="btn btn-primary" onclick="saveUser()" id="saveUserBtn">保存</button>
            </div>
        </div>
    </div>

    <!-- Reset Password Modal -->
    <div class="modal-overlay" id="resetPasswordModal">
        <div class="modal" style="width: 400px;">
            <div class="modal-header">
                <h3 class="modal-title">重置密码</h3>
                <button class="modal-close" onclick="closeResetPasswordModal()">&times;</button>
            </div>
            <div class="modal-body" style="text-align: center; padding: 30px 20px;">
                <div style="font-size: 48px; margin-bottom: 16px;">🔑</div>
                <div style="font-size: 16px; margin-bottom: 8px;">已为用户 <strong id="resetPasswordUsername">-</strong> 重置密码</div>
                <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 20px;">新密码已生成，请及时通知用户</div>
                <div style="background: var(--bg-tertiary); padding: 16px; border-radius: 8px; margin-bottom: 20px;">
                    <div style="font-size: 13px; color: var(--text-secondary); margin-bottom: 8px;">新密码</div>
                    <div style="font-size: 20px; font-weight: 600; font-family: monospace; letter-spacing: 2px;" id="newPasswordDisplay">-</div>
                </div>
                <div style="font-size: 12px; color: var(--accent-orange);">
                    ⚠️ 请妥善保管密码，此弹窗关闭后将无法再次查看
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="copyNewPassword()">复制密码</button>
                <button class="btn btn-primary" onclick="closeResetPasswordModal()">确定</button>
            </div>
        </div>
    </div>

    <!-- Delete Confirm Modal -->
    <div class="modal-overlay" id="deleteConfirmModal">
        <div class="modal" style="width: 400px;">
            <div class="modal-header">
                <h3 class="modal-title">确认删除</h3>
                <button class="modal-close" onclick="closeDeleteConfirmModal()">&times;</button>
            </div>
            <div class="modal-body" style="text-align: center; padding: 30px 20px;">
                <div style="font-size: 48px; margin-bottom: 16px; color: var(--accent-red);">⚠️</div>
                <div style="font-size: 16px; margin-bottom: 8px;">确定要删除用户 <strong id="deleteUsername">-</strong> 吗？</div>
                <div style="font-size: 14px; color: var(--text-secondary);">删除后该用户将无法登录系统，此操作不可恢复</div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeDeleteConfirmModal()">取消</button>
                <button class="btn btn-danger" onclick="confirmDeleteUser()" id="confirmDeleteBtn">确认删除</button>
            </div>
        </div>
    </div>

    <!-- API Test Result Modal -->
    <div class="modal-overlay" id="apiTestModal">
        <div class="modal" style="width: 450px;">
            <div class="modal-header">
                <h3 class="modal-title" id="apiTestTitle">API 测试结果</h3>
                <button class="modal-close" onclick="closeApiTestModal()">&times;</button>
            </div>
            <div class="modal-body" style="text-align: center; padding: 30px 20px;">
                <div style="font-size: 64px; margin-bottom: 16px;" id="apiTestIcon">⏳</div>
                <div style="font-size: 18px; font-weight: 600; margin-bottom: 8px;" id="apiTestStatus">正在测试...</div>
                <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 20px;" id="apiTestMessage">请稍候，正在连接API服务</div>
                <div id="apiTestDetails" style="display: none; text-align: left; background: var(--bg-tertiary); padding: 16px; border-radius: 8px; font-size: 13px;">
                    <div style="margin-bottom: 8px;"><strong>响应时间：</strong><span id="apiTestTime">-</span></div>
                    <div style="margin-bottom: 8px;"><strong>接口地址：</strong><span id="apiTestEndpoint">-</span></div>
                    <div><strong>返回数据：</strong><span id="apiTestData">-</span></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="closeApiTestModal()">确定</button>
            </div>
        </div>
    </div>

    <script>
        // Login handler
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('appContainer').style.display = 'flex';
            initCharts();
        });

        // Logout handler
        function logout() {
            document.getElementById('appContainer').style.display = 'none';
            document.getElementById('loginPage').style.display = 'flex';
        }

        // Page navigation
        document.querySelectorAll('.menu-item').forEach(item => {
            item.addEventListener('click', function() {
                const page = this.dataset.page;
                showPage(page);
            });
        });

        function showPage(pageName) {
            // Update menu
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.page === pageName) {
                    item.classList.add('active');
                }
            });

            // Update pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageName + 'Page').classList.add('active');

            // Update breadcrumb
            const pageNames = {
                'dashboard': '工作台',
                'camps': '训练营管理',
                'members': '会员管理',
                'checkins': '打卡管理',
                'payments': '支付映射',
                'refunds': '退款审核',
                'statistics': '统计报表',
                'system': '系统管理'
            };
            document.getElementById('currentPage').textContent = pageNames[pageName];

            // Reinit charts if needed
            if (pageName === 'statistics') {
                setTimeout(() => {
                    initStatisticsCharts();
                }, 100);
            }
        }

        // Initialize charts
        function initCharts() {
            // Income Chart
            const incomeChart = echarts.init(document.getElementById('incomeChart'));
            incomeChart.setOption({
                tooltip: { trigger: 'axis' },
                grid: { left: '3%', right: '4%', bottom: '3%', containLabel: true },
                xAxis: {
                    type: 'category',
                    data: ['1月1日', '1月2日', '1月3日', '1月4日', '1月5日', '1月6日', '1月7日'],
                    axisLine: { lineStyle: { color: '#30363d' } },
                    axisLabel: { color: '#8b949e' }
                },
                yAxis: {
                    type: 'value',
                    axisLine: { lineStyle: { color: '#30363d' } },
                    axisLabel: { color: '#8b949e' },
                    splitLine: { lineStyle: { color: '#21262d' } }
                },
                series: [
                    {
                        name: '收入',
                        type: 'bar',
                        data: [4200, 3800, 5100, 4600, 5800, 4900, 6200],
                        itemStyle: {
                            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                { offset: 0, color: '#58a6ff' },
                                { offset: 1, color: '#1e3a5f' }
                            ]),
                            borderRadius: [4, 4, 0, 0]
                        }
                    },
                    {
                        name: '退款',
                        type: 'bar',
                        data: [3200, 2900, 4100, 3600, 4500, 3800, 5000],
                        itemStyle: {
                            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                { offset: 0, color: '#a371f7' },
                                { offset: 1, color: '#3d2066' }
                            ]),
                            borderRadius: [4, 4, 0, 0]
                        }
                    }
                ]
            });

            // Completion Chart
            const completionChart = echarts.init(document.getElementById('completionChart'));
            completionChart.setOption({
                tooltip: { trigger: 'item' },
                legend: {
                    bottom: '5%',
                    textStyle: { color: '#8b949e' }
                },
                series: [
                    {
                        name: '完成率分布',
                        type: 'pie',
                        radius: ['40%', '70%'],
                        avoidLabelOverlap: false,
                        itemStyle: {
                            borderRadius: 10,
                            borderColor: '#161b22',
                            borderWidth: 2
                        },
                        label: {
                            show: false,
                            position: 'center'
                        },
                        emphasis: {
                            label: {
                                show: true,
                                fontSize: 20,
                                fontWeight: 'bold',
                                color: '#f0f6fc'
                            }
                        },
                        labelLine: { show: false },
                        data: [
                            { value: 735, name: '100%完成', itemStyle: { color: '#3fb950' } },
                            { value: 580, name: '80-99%', itemStyle: { color: '#58a6ff' } },
                            { value: 484, name: '60-79%', itemStyle: { color: '#d29922' } },
                            { value: 300, name: '60%以下', itemStyle: { color: '#f85149' } }
                        ]
                    }
                ]
            });

            // Resize handler
            window.addEventListener('resize', () => {
                incomeChart.resize();
                completionChart.resize();
            });
        }

        function initStatisticsCharts() {
            // Monthly Chart
            const monthlyChart = echarts.init(document.getElementById('monthlyChart'));
            monthlyChart.setOption({
                tooltip: { trigger: 'axis' },
                legend: {
                    data: ['押金收入', '退款金额', '净收入'],
                    textStyle: { color: '#8b949e' }
                },
                grid: { left: '3%', right: '4%', bottom: '3%', containLabel: true },
                xAxis: {
                    type: 'category',
                    data: ['10月', '11月', '12月', '1月'],
                    axisLine: { lineStyle: { color: '#30363d' } },
                    axisLabel: { color: '#8b949e' }
                },
                yAxis: {
                    type: 'value',
                    axisLine: { lineStyle: { color: '#30363d' } },
                    axisLabel: { color: '#8b949e' },
                    splitLine: { lineStyle: { color: '#21262d' } }
                },
                series: [
                    {
                        name: '押金收入',
                        type: 'line',
                        smooth: true,
                        data: [98000, 112000, 135000, 124344],
                        lineStyle: { color: '#58a6ff' },
                        itemStyle: { color: '#58a6ff' },
                        areaStyle: {
                            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                { offset: 0, color: 'rgba(88, 166, 255, 0.3)' },
                                { offset: 1, color: 'rgba(88, 166, 255, 0)' }
                            ])
                        }
                    },
                    {
                        name: '退款金额',
                        type: 'line',
                        smooth: true,
                        data: [76000, 87000, 105000, 96858],
                        lineStyle: { color: '#a371f7' },
                        itemStyle: { color: '#a371f7' }
                    },
                    {
                        name: '净收入',
                        type: 'line',
                        smooth: true,
                        data: [22000, 25000, 30000, 27486],
                        lineStyle: { color: '#3fb950' },
                        itemStyle: { color: '#3fb950' }
                    }
                ]
            });

            // Camp Compare Chart
            const campCompareChart = echarts.init(document.getElementById('campCompareChart'));
            campCompareChart.setOption({
                tooltip: { trigger: 'axis', axisPointer: { type: 'shadow' } },
                grid: { left: '3%', right: '4%', bottom: '3%', containLabel: true },
                xAxis: {
                    type: 'value',
                    axisLine: { lineStyle: { color: '#30363d' } },
                    axisLabel: { color: '#8b949e', formatter: '{value}%' },
                    splitLine: { lineStyle: { color: '#21262d' } }
                },
                yAxis: {
                    type: 'category',
                    data: ['21天早起训练营', '7天读书打卡营', '30天健身打卡营'],
                    axisLine: { lineStyle: { color: '#30363d' } },
                    axisLabel: { color: '#8b949e' }
                },
                series: [
                    {
                        name: '完成率',
                        type: 'bar',
                        data: [85, 78, 72],
                        itemStyle: {
                            color: function(params) {
                                const colors = ['#3fb950', '#58a6ff', '#d29922'];
                                return colors[params.dataIndex];
                            },
                            borderRadius: [0, 4, 4, 0]
                        },
                        label: {
                            show: true,
                            position: 'right',
                            color: '#8b949e',
                            formatter: '{c}%'
                        }
                    }
                ]
            });

            window.addEventListener('resize', () => {
                monthlyChart.resize();
                campCompareChart.resize();
            });
        }

        // ========== Create Camp Modal Functions ==========
        let currentStep = 1;
        const totalSteps = 3;

        function openCreateCampModal() {
            document.getElementById('createCampModal').classList.add('active');
            currentStep = 1;
            updateStepUI();
        }

        function closeCreateCampModal() {
            document.getElementById('createCampModal').classList.remove('active');
            // Reset form
            currentStep = 1;
            updateStepUI();
        }

        function nextStep() {
            if (currentStep < totalSteps) {
                currentStep++;
                updateStepUI();
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                updateStepUI();
            }
        }

        function updateStepUI() {
            // Update step indicators
            document.querySelectorAll('.step-item').forEach((item, index) => {
                item.classList.remove('active', 'completed');
                if (index + 1 < currentStep) {
                    item.classList.add('completed');
                } else if (index + 1 === currentStep) {
                    item.classList.add('active');
                }
            });

            // Update step content
            document.querySelectorAll('.form-step').forEach((step, index) => {
                step.classList.remove('active');
                if (index + 1 === currentStep) {
                    step.classList.add('active');
                }
            });

            // Update buttons
            document.getElementById('prevStepBtn').style.display = currentStep > 1 ? 'inline-flex' : 'none';
            document.getElementById('nextStepBtn').style.display = currentStep < totalSteps ? 'inline-flex' : 'none';
            document.getElementById('submitBtn').style.display = currentStep === totalSteps ? 'inline-flex' : 'none';
        }

        function selectRadio(element, groupName) {
            // Remove active from all items in group
            element.closest('.radio-group').querySelectorAll('.radio-item').forEach(item => {
                item.classList.remove('active');
            });
            // Add active to clicked item
            element.classList.add('active');
        }

        function toggleCheckbox(element) {
            element.classList.toggle('active');
        }

        function toggleConditional(elementId, show) {
            const element = document.getElementById(elementId);
            if (element) {
                element.classList.toggle('active', show);
            }
        }

        function generatePromoText() {
            const btn = event.target.closest('.ai-generate-btn');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<span class="sparkle">⏳</span> 生成中...';
            btn.disabled = true;

            // Simulate AI generation
            setTimeout(() => {
                const promoText = `🌟 21天早起训练营 🌟

每天早起，改变人生！

✨ 为什么要参加？
• 养成早起好习惯，提升生活质量
• 专业教练全程陪伴指导
• 社群互动，一起坚持更容易

📋 训练营规则：
• 21天内完成15天打卡即可获得全额退款
• 每日打卡时间：5:00-8:00
• 打卡内容：分享早起心得或计划

💰 押金制度：
• 支付押金 ¥99
• 完成打卡要求，3个工作日内全额退还
• 未达标押金用于奖励优秀学员

🎯 现在报名，开启你的早起之旅！`;

                document.getElementById('promoText').value = promoText;

                // Show preview
                document.getElementById('promoPreview').style.display = 'block';
                document.getElementById('promoPreviewContent').textContent = promoText;

                btn.innerHTML = originalText;
                btn.disabled = false;
            }, 1500);
        }

        function generatePoster() {
            const btn = event.target.closest('.ai-generate-btn');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<span class="sparkle">⏳</span> 生成中...';
            btn.disabled = true;

            // Simulate AI poster generation
            setTimeout(() => {
                const posterPreview = document.getElementById('posterPreview');
                posterPreview.classList.add('has-image');
                posterPreview.innerHTML = `
                    <div style="text-align: center; padding: 20px;">
                        <div style="font-size: 24px; font-weight: bold; margin-bottom: 10px;">21天早起训练营</div>
                        <div style="font-size: 14px; color: rgba(255,255,255,0.8); margin-bottom: 20px;">改变，从早起开始</div>
                        <div style="font-size: 48px; margin: 20px 0;">🌅</div>
                        <div style="font-size: 16px; margin-bottom: 10px;">押金 ¥99</div>
                        <div style="font-size: 12px; color: rgba(255,255,255,0.7);">完成打卡即退还</div>
                    </div>
                `;

                btn.innerHTML = originalText;
                btn.disabled = false;
            }, 2000);
        }

        function previewPoster(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const posterPreview = document.getElementById('posterPreview');
                    posterPreview.classList.add('has-image');
                    posterPreview.innerHTML = `<img src="${e.target.result}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 10px;">`;
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        function previewQRCode(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const qrcodePreview = document.getElementById('qrcodePreview');
                    qrcodePreview.classList.add('has-image');
                    qrcodePreview.innerHTML = `<img src="${e.target.result}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 10px;">`;
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        function submitCamp() {
            const btn = document.getElementById('submitBtn');
            const originalText = btn.innerHTML;
            btn.innerHTML = '创建中...';
            btn.disabled = true;

            // Simulate API call
            setTimeout(() => {
                alert('训练营创建成功！');
                closeCreateCampModal();
                btn.innerHTML = originalText;
                btn.disabled = false;
            }, 1000);
        }

        // Add form-step styles
        const style = document.createElement('style');
        style.textContent = `
            .form-step { display: none; }
            .form-step.active { display: block; }
            .detail-tab { display: none; }
            .detail-tab.active { display: block; }
        `;
        document.head.appendChild(style);

        // ========== Camp Detail Functions ==========
        let currentCampId = null;

        // Mock camp data
        const campData = {
            12345: {
                id: 12345,
                name: '21天早起训练营',
                deposit: 99,
                startDate: '2025-01-01',
                endDate: '2025-01-21',
                totalDays: 21,
                requiredDays: 15,
                status: 'ongoing',
                coaches: ['coach_zhang', 'coach_li'],
                enrollCount: 156,
                totalDeposit: 15444,
                avgCheckinRate: 85,
                refundedAmount: 13068
            },
            12346: {
                id: 12346,
                name: '7天读书打卡营',
                deposit: 49,
                startDate: '2025-01-15',
                endDate: '2025-01-22',
                totalDays: 7,
                requiredDays: 5,
                status: 'upcoming',
                coaches: ['coach_wang'],
                enrollCount: 89,
                totalDeposit: 4361,
                avgCheckinRate: 0,
                refundedAmount: 0
            },
            12344: {
                id: 12344,
                name: '30天健身打卡营',
                deposit: 199,
                startDate: '2024-12-01',
                endDate: '2024-12-30',
                totalDays: 30,
                requiredDays: 20,
                status: 'ended',
                coaches: ['coach_zhang'],
                enrollCount: 234,
                totalDeposit: 46566,
                avgCheckinRate: 72,
                refundedAmount: 33528
            }
        };

        function viewCampDetail(campId) {
            currentCampId = campId;
            const camp = campData[campId];
            if (!camp) {
                alert('训练营数据不存在');
                return;
            }

            // Update drawer content
            document.getElementById('campDetailTitle').textContent = camp.name + ' - 详情';
            document.getElementById('detailCampName').textContent = camp.name;
            document.getElementById('detailCampId').textContent = camp.id;

            // Reset to overview tab
            switchDetailTab(document.querySelector('#campDetailDrawer .page-nav-item'), 'overview');

            // Show drawer
            document.getElementById('campDetailDrawer').classList.add('active');

            // Update edit button visibility based on status
            const editBtn = document.getElementById('editCampBtn');
            if (camp.status === 'ended') {
                editBtn.style.display = 'none';
            } else {
                editBtn.style.display = 'inline-flex';
            }
        }

        function closeCampDetailDrawer() {
            document.getElementById('campDetailDrawer').classList.remove('active');
            currentCampId = null;
        }

        function switchDetailTab(element, tabName) {
            // Update tab nav
            document.querySelectorAll('#campDetailDrawer .page-nav-item').forEach(item => {
                item.classList.remove('active');
            });
            element.classList.add('active');

            // Update tab content
            document.querySelectorAll('.detail-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById('tab-' + tabName).classList.add('active');
        }

        function editCamp(campId) {
            const camp = campData[campId];
            if (!camp) {
                alert('训练营数据不存在');
                return;
            }

            if (camp.status === 'ended') {
                alert('已结束的训练营不能编辑');
                return;
            }

            if (camp.status === 'ongoing') {
                if (!confirm('进行中的训练营只能修改部分信息（不能修改日期、打卡要求等核心参数），是否继续？')) {
                    return;
                }
            }

            // Open create modal in edit mode
            currentCampId = campId;
            document.getElementById('createCampModal').classList.add('active');

            // Update modal title
            document.querySelector('#createCampModal .modal-title').textContent = '编辑训练营';
            document.getElementById('submitBtn').textContent = '保存修改';

            // Pre-fill form with camp data (simplified for prototype)
            currentStep = 1;
            updateStepUI();

            // You would typically pre-fill form fields here
            alert('编辑模式：训练营 "' + camp.name + '" (ID: ' + campId + ')');
        }

        function editCampFromDetail() {
            if (currentCampId) {
                closeCampDetailDrawer();
                editCamp(currentCampId);
            }
        }

        function copyLink() {
            const link = 'https://camp.example.com/enroll/' + (currentCampId || '12345');
            navigator.clipboard.writeText(link).then(() => {
                alert('链接已复制到剪贴板');
            }).catch(() => {
                alert('复制失败，请手动复制');
            });
        }

        function showQRCode() {
            alert('显示二维码弹窗（原型演示）');
        }

        // Override close modal to reset edit mode
        const originalCloseCreateCampModal = closeCreateCampModal;
        closeCreateCampModal = function() {
            originalCloseCreateCampModal();
            // Reset modal title
            document.querySelector('#createCampModal .modal-title').textContent = '创建训练营';
            document.getElementById('submitBtn').textContent = '创建训练营';
            currentCampId = null;
        };

        // ========== Checkin Management Functions ==========

        // Mock checkin data
        const checkinData = {
            '88455815': {
                memberId: '88455815',
                memberName: '球球的副业探索',
                campId: 12345,
                campName: '21天早起训练营',
                checkedDays: 16,
                requiredDays: 15,
                rate: 107,
                status: 'qualified',
                checkinDates: [1,2,4,5,6,7,8,9,10,11,12,13,14,15],
                missedDates: [3],
                records: [
                    { date: '01-15', day: '周三', time: '07:32', content: '今天早起感觉特别好，坚持就是胜利！' },
                    { date: '01-14', day: '周二', time: '06:58', content: '第14天，已经形成习惯了' },
                    { date: '01-13', day: '周一', time: '07:15', content: '新的一周开始，继续加油！' },
                    { date: '01-03', day: '周五', time: null, content: null }
                ]
            },
            '88123457': {
                memberId: '88123457',
                memberName: '学习达人小明',
                campId: 12345,
                campName: '21天早起训练营',
                checkedDays: 12,
                requiredDays: 15,
                rate: 80,
                status: 'ongoing',
                checkinDates: [1,2,4,5,7,8,9,11,12,14,15],
                missedDates: [3,6,10,13],
                records: []
            },
            '88123456': {
                memberId: '88123456',
                memberName: '努力工作的小红',
                campId: 12345,
                campName: '21天早起训练营',
                checkedDays: 8,
                requiredDays: 15,
                rate: 53,
                status: 'unqualified',
                checkinDates: [1,2,5,7,8,11,14,15],
                missedDates: [3,4,6,9,10,12,13],
                records: []
            }
        };

        // Switch between checkin tabs
        function switchCheckinTab(element, tabName) {
            // Update tab nav
            document.querySelectorAll('#checkinsPage .page-nav-item').forEach(item => {
                item.classList.remove('active');
            });
            element.classList.add('active');

            // Update tab content
            document.querySelectorAll('.checkin-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById('checkin-tab-' + tabName).classList.add('active');
        }

        // Sync checkin data from API
        function syncCheckinData() {
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '🔄 同步中...';
            btn.disabled = true;

            setTimeout(() => {
                alert('打卡数据同步完成！\n\n同步时间: ' + new Date().toLocaleString() + '\n同步记录数: 156');
                btn.innerHTML = originalText;
                btn.disabled = false;
            }, 1500);
        }

        // Filter checkin records
        function filterCheckinRecords() {
            const campFilter = document.getElementById('checkinCampFilter').value;
            const statusFilter = document.getElementById('checkinStatusFilter').value;
            const searchInput = document.getElementById('checkinSearchInput').value.toLowerCase();

            // In real app, this would filter the table data
            // For prototype, just show feedback
            console.log('Filtering:', { campFilter, statusFilter, searchInput });

            // Simulate filtering effect
            const rows = document.querySelectorAll('#checkinRecordsTable tr');
            rows.forEach(row => {
                row.style.opacity = '0.5';
            });

            setTimeout(() => {
                rows.forEach(row => {
                    row.style.opacity = '1';
                });
            }, 300);
        }

        // Reset checkin filters
        function resetCheckinFilters() {
            document.getElementById('checkinCampFilter').value = '';
            document.getElementById('checkinStatusFilter').value = '';
            document.getElementById('checkinSearchInput').value = '';

            // Reset table display
            const rows = document.querySelectorAll('#checkinRecordsTable tr');
            rows.forEach(row => {
                row.style.display = '';
            });
        }

        // View member checkin detail
        function viewCheckinDetail(memberId) {
            const data = checkinData[memberId];
            if (!data) {
                alert('会员打卡数据不存在');
                return;
            }

            // Update drawer content
            document.getElementById('checkinDetailTitle').textContent = data.memberName + ' - 打卡详情';
            document.getElementById('checkinDetailMemberName').textContent = data.memberName;
            document.getElementById('checkinDetailPlanetId').textContent = memberId;
            document.getElementById('checkinDetailCampName').textContent = data.campName;
            document.getElementById('checkinDetailCheckedDays').textContent = data.checkedDays;
            document.getElementById('checkinDetailRequiredDays').textContent = data.requiredDays;
            document.getElementById('checkinDetailRate').textContent = data.rate + '%';

            // Update status
            const statusEl = document.getElementById('checkinDetailStatus');
            if (data.status === 'qualified') {
                statusEl.innerHTML = '<span class="status-badge success">✓ 达标</span>';
            } else if (data.status === 'ongoing') {
                statusEl.innerHTML = '<span class="status-badge pending">⏳ 进行中</span>';
            } else {
                statusEl.innerHTML = '<span class="status-badge failed">✗ 未达标</span>';
            }

            // Update calendar (simplified for prototype)
            const calendar = document.getElementById('checkinDetailCalendar');
            let calendarHTML = '';
            for (let i = 1; i <= 21; i++) {
                let dayClass = 'checkin-day';
                if (data.checkinDates.includes(i)) {
                    dayClass += ' checked';
                } else if (data.missedDates.includes(i)) {
                    dayClass += ' missed';
                } else {
                    dayClass += ' future';
                }
                calendarHTML += `<div class="${dayClass}">${i}</div>`;
            }
            calendar.innerHTML = calendarHTML;

            // Show drawer
            document.getElementById('checkinDetailDrawer').classList.add('active');
        }

        // Close checkin detail drawer
        function closeCheckinDetailDrawer() {
            document.getElementById('checkinDetailDrawer').classList.remove('active');
        }

        // View day checkin list
        function viewDayCheckins(date) {
            document.getElementById('dayCheckinTitle').textContent = date + ' 打卡详情';

            // Mock data based on date
            const dayNum = parseInt(date.split('-')[2]);
            const checkinCount = 100 + Math.floor(Math.random() * 50);
            const totalCount = 156;
            const rate = Math.round((checkinCount / totalCount) * 100);

            document.getElementById('dayCheckinCount').textContent = checkinCount;
            document.getElementById('dayTotalCount').textContent = totalCount;
            document.getElementById('dayCheckinRate').textContent = rate + '%';

            document.getElementById('dayCheckinDrawer').classList.add('active');
        }

        // Close day checkin drawer
        function closeDayCheckinDrawer() {
            document.getElementById('dayCheckinDrawer').classList.remove('active');
        }

        // Update checkin statistics based on camp selection
        function updateCheckinStatistics() {
            const campId = document.getElementById('statisticsCampSelect').value;
            const camp = campData[campId];

            if (camp) {
                // Simulate updating statistics
                console.log('Updating statistics for camp:', camp.name);

                // Animation effect
                const statsCards = document.querySelectorAll('#checkin-tab-statistics .stat-card');
                statsCards.forEach(card => {
                    card.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        card.style.transform = 'scale(1)';
                    }, 200);
                });
            }
        }

        // Export checkin statistics
        function exportCheckinStats() {
            const campSelect = document.getElementById('statisticsCampSelect');
            const campName = campSelect.options[campSelect.selectedIndex].text;

            alert('导出打卡统计\n\n训练营: ' + campName + '\n格式: Excel (.xlsx)\n\n文件已开始下载...');
        }

        // Sort checkin ranking
        function sortCheckinRanking(order) {
            console.log('Sorting ranking:', order);

            // Animation effect for prototype
            const table = document.querySelector('#checkin-tab-statistics .data-table tbody');
            if (table) {
                table.style.opacity = '0.5';
                setTimeout(() => {
                    table.style.opacity = '1';
                }, 300);
            }
        }

        // ========== Member Management Functions ==========

        // Current member ID for detail view
        let currentMemberId = null;

        // Mock member data
        const memberData = {
            'M001': {
                id: 'M001',
                name: '球球的副业探索',
                planetId: '88455815',
                wechatName: '小球球',
                matchStatus: 'matched',
                confidence: 100,
                groupStatus: 'joined',
                camp: '21天早起训练营',
                payAmount: 99,
                payTime: '2025-01-01 10:30:25',
                payments: [
                    { time: '2025-01-01 10:30:25', camp: '21天早起训练营', amount: 99, orderNo: 'PAY20250101103025001', status: 'paid' },
                    { time: '2024-12-01 09:15:30', camp: '7天读书打卡营', amount: 49, orderNo: 'PAY20241201091530001', status: 'paid' }
                ],
                checkins: {
                    checkedDays: 16,
                    requiredDays: 15,
                    rate: 76,
                    qualified: true,
                    dates: [1,2,4,5,6,7,8,9,11,12,13,14,15,16]
                },
                refunds: [
                    { time: '2024-12-08 14:30:00', camp: '7天读书打卡营', amount: 49, status: 'refunded', operator: '管理员' }
                ]
            },
            'M002': {
                id: 'M002',
                name: '爱学习的小明',
                planetId: '88123457',
                wechatName: '小明同学',
                matchStatus: 'matched',
                confidence: 66,
                groupStatus: 'joined',
                camp: '21天早起训练营',
                payAmount: 99,
                payTime: '2025-01-02 14:20:10',
                payments: [
                    { time: '2025-01-02 14:20:10', camp: '21天早起训练营', amount: 99, orderNo: 'PAY20250102142010001', status: 'paid' }
                ],
                checkins: {
                    checkedDays: 14,
                    requiredDays: 15,
                    rate: 67,
                    qualified: false,
                    dates: [1,2,3,5,6,7,9,10,11,12,14,15]
                },
                refunds: []
            },
            'M003': {
                id: 'M003',
                name: '努力工作的小红',
                planetId: '88123456',
                wechatName: '小红',
                matchStatus: 'matched',
                confidence: 33,
                groupStatus: 'not_joined',
                camp: '21天早起训练营',
                payAmount: 99,
                payTime: '2025-01-03 09:45:33',
                payments: [
                    { time: '2025-01-03 09:45:33', camp: '21天早起训练营', amount: 99, orderNo: 'PAY20250103094533001', status: 'paid' }
                ],
                checkins: {
                    checkedDays: 10,
                    requiredDays: 15,
                    rate: 48,
                    qualified: false,
                    dates: [1,3,5,7,9,11,13,14,15]
                },
                refunds: []
            },
            'M004': {
                id: 'M004',
                name: '微信用户A',
                planetId: '',
                wechatName: '微信用户A',
                matchStatus: 'failed',
                confidence: 0,
                groupStatus: 'not_joined',
                camp: '21天早起训练营',
                payAmount: 99,
                payTime: '2025-01-04 16:30:00',
                payments: [
                    { time: '2025-01-04 16:30:00', camp: '21天早起训练营', amount: 99, orderNo: 'PAY20250104163000001', status: 'paid' }
                ],
                checkins: {
                    checkedDays: 0,
                    requiredDays: 15,
                    rate: 0,
                    qualified: false,
                    dates: []
                },
                refunds: []
            }
        };

        // Filter members
        function filterMembers() {
            const campFilter = document.getElementById('memberCampFilter').value;
            const statusFilter = document.getElementById('memberStatusFilter').value;
            const searchInput = document.getElementById('memberSearchInput').value.toLowerCase();

            console.log('Filtering members:', { campFilter, statusFilter, searchInput });

            // Get all table rows
            const rows = document.querySelectorAll('#membersPage .data-table tbody tr');
            let visibleCount = 0;

            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                const matchStatus = row.getAttribute('data-match-status') || '';

                let visible = true;

                // Filter by search text
                if (searchInput && !text.includes(searchInput)) {
                    visible = false;
                }

                // Filter by status
                if (statusFilter && statusFilter !== matchStatus) {
                    visible = false;
                }

                row.style.display = visible ? '' : 'none';
                if (visible) visibleCount++;
            });

            // Show feedback
            console.log('Visible members:', visibleCount);
        }

        // Reset member filters
        function resetMemberFilters() {
            document.getElementById('memberCampFilter').value = '';
            document.getElementById('memberStatusFilter').value = '';
            document.getElementById('memberSearchInput').value = '';

            // Show all rows
            const rows = document.querySelectorAll('#membersPage .data-table tbody tr');
            rows.forEach(row => {
                row.style.display = '';
            });
        }

        // View member detail
        function viewMemberDetail(memberId) {
            currentMemberId = memberId;
            const member = memberData[memberId];

            if (!member) {
                console.error('Member not found:', memberId);
                return;
            }

            // Update header info
            document.getElementById('memberDetailAvatar').textContent = member.name.charAt(0);
            document.getElementById('memberDetailName').textContent = member.name;
            document.getElementById('memberDetailPlanetId').textContent = member.planetId || '-';
            document.getElementById('memberDetailWechatName').textContent = member.wechatName;

            // Update status badges
            const matchStatusEl = document.getElementById('memberDetailMatchStatus');
            if (member.matchStatus === 'matched') {
                matchStatusEl.className = 'status-badge ' + (member.confidence === 100 ? 'success' : 'pending');
                matchStatusEl.textContent = '已匹配 ' + member.confidence + '%';
            } else {
                matchStatusEl.className = 'status-badge failed';
                matchStatusEl.textContent = '匹配失败';
            }

            const groupStatusEl = document.getElementById('memberDetailGroupStatus');
            if (member.groupStatus === 'joined') {
                groupStatusEl.className = 'status-badge success';
                groupStatusEl.textContent = '已进群';
            } else {
                groupStatusEl.className = 'status-badge failed';
                groupStatusEl.textContent = '未进群';
            }

            // Update checkin stats
            document.getElementById('memberCheckinCount').textContent = member.checkins.checkedDays;
            document.getElementById('memberRequiredDays').textContent = member.checkins.requiredDays;
            document.getElementById('memberCheckinRate').textContent = member.checkins.rate + '%';
            document.getElementById('memberQualifyStatus').textContent = member.checkins.qualified ? '✓' : '✗';
            document.getElementById('memberQualifyStatus').style.color = member.checkins.qualified ? 'var(--accent-green)' : 'var(--accent-red)';

            // Generate checkin calendar
            generateMemberCheckinCalendar(member.checkins.dates);

            // Reset tabs to payment tab
            switchMemberDetailTab(document.querySelector('#memberDetailDrawer .tab-btn'), 'payment');

            // Show drawer
            document.getElementById('memberDetailDrawer').classList.add('active');
        }

        // Close member detail drawer
        function closeMemberDetailDrawer() {
            document.getElementById('memberDetailDrawer').classList.remove('active');
            currentMemberId = null;
        }

        // Switch member detail tabs
        function switchMemberDetailTab(element, tabName) {
            // Update tab nav
            document.querySelectorAll('#memberDetailDrawer .tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            element.classList.add('active');

            // Update tab content
            document.querySelectorAll('.member-detail-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            const tabId = 'member' + tabName.charAt(0).toUpperCase() + tabName.slice(1) + 'Tab';
            document.getElementById(tabId).classList.add('active');
        }

        // Generate member checkin calendar
        function generateMemberCheckinCalendar(checkedDates) {
            const calendarEl = document.getElementById('memberCheckinCalendar');
            let html = '';

            for (let i = 1; i <= 21; i++) {
                const isChecked = checkedDates.includes(i);
                const isFuture = i > 15; // Assume current day is 15

                let className = 'checkin-day';
                let content = i;

                if (isFuture) {
                    className += ' future';
                } else if (isChecked) {
                    className += ' checked';
                    content = '✓';
                } else {
                    className += ' missed';
                    content = '✗';
                }

                html += `<div class="${className}" style="aspect-ratio: 1; display: flex; align-items: center; justify-content: center; font-size: 12px; border-radius: 4px; background: var(--bg-secondary);">${content}</div>`;
            }

            calendarEl.innerHTML = html;

            // Apply styles
            calendarEl.querySelectorAll('.checkin-day.checked').forEach(el => {
                el.style.background = 'var(--accent-green)';
                el.style.color = 'white';
            });
            calendarEl.querySelectorAll('.checkin-day.missed').forEach(el => {
                el.style.background = 'rgba(248, 81, 73, 0.2)';
                el.style.color = 'var(--accent-red)';
            });
            calendarEl.querySelectorAll('.checkin-day.future').forEach(el => {
                el.style.background = 'var(--bg-tertiary)';
                el.style.color = 'var(--text-muted)';
            });
        }

        // Filter member checkins by camp
        function filterMemberCheckins() {
            const campId = document.getElementById('memberCheckinCampFilter').value;
            console.log('Filtering member checkins by camp:', campId);
            // In real app, this would load different checkin data
        }

        // Toggle group status
        function toggleGroupStatus() {
            const member = memberData[currentMemberId];
            if (!member) return;

            const newStatus = member.groupStatus === 'joined' ? 'not_joined' : 'joined';
            member.groupStatus = newStatus;

            const groupStatusEl = document.getElementById('memberDetailGroupStatus');
            if (newStatus === 'joined') {
                groupStatusEl.className = 'status-badge success';
                groupStatusEl.textContent = '已进群';
                alert('已标记为"已进群"');
            } else {
                groupStatusEl.className = 'status-badge failed';
                groupStatusEl.textContent = '未进群';
                alert('已标记为"未进群"');
            }
        }

        // Open manual match modal
        function openManualMatchModal(memberId) {
            const member = memberData[memberId];
            if (!member) {
                console.error('Member not found:', memberId);
                return;
            }

            currentMemberId = memberId;

            // Update modal with member info
            document.getElementById('matchMemberAvatar').textContent = member.name.charAt(0);
            document.getElementById('matchMemberName').textContent = member.name;
            document.getElementById('matchMemberPlanetId').textContent = member.planetId || '-';
            document.getElementById('matchMemberWechatName').textContent = member.wechatName;

            // Clear previous selection
            clearSelectedUser();

            // Show modal
            document.getElementById('manualMatchModal').classList.add('active');
        }

        // Close manual match modal
        function closeManualMatchModal() {
            document.getElementById('manualMatchModal').classList.remove('active');
            clearSelectedUser();
        }

        // Search planet users
        function searchPlanetUsers() {
            const searchTerm = document.getElementById('matchSearchInput').value;
            console.log('Searching planet users:', searchTerm);

            // Show loading effect
            const resultsContainer = document.getElementById('matchSearchResults');
            resultsContainer.style.opacity = '0.5';

            setTimeout(() => {
                resultsContainer.style.opacity = '1';
                // In real app, this would call API and update results
                alert('搜索完成！\n\n关键词: ' + searchTerm + '\n找到 3 个匹配用户');
            }, 500);
        }

        // Select match user
        let selectedPlanetUserId = null;
        let selectedPlanetUserName = null;

        function selectMatchUser(userId, userName) {
            selectedPlanetUserId = userId;
            selectedPlanetUserName = userName;

            // Update UI
            document.getElementById('selectedUserAvatar').textContent = userName.charAt(0);
            document.getElementById('selectedUserName').textContent = userName;
            document.getElementById('selectedUserId').textContent = userId;
            document.getElementById('selectedMatchUser').style.display = 'block';

            // Enable confirm button
            document.getElementById('confirmMatchBtn').disabled = false;

            // Highlight selected item
            document.querySelectorAll('.match-user-item').forEach(item => {
                item.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
        }

        // Clear selected user
        function clearSelectedUser() {
            selectedPlanetUserId = null;
            selectedPlanetUserName = null;
            document.getElementById('selectedMatchUser').style.display = 'none';
            document.getElementById('confirmMatchBtn').disabled = true;

            // Remove highlight
            document.querySelectorAll('.match-user-item').forEach(item => {
                item.classList.remove('selected');
            });
        }

        // Confirm manual match
        function confirmManualMatch() {
            if (!selectedPlanetUserId || !currentMemberId) {
                alert('请先选择要匹配的知识星球用户');
                return;
            }

            const member = memberData[currentMemberId];
            if (!member) return;

            // Update member data
            member.planetId = selectedPlanetUserId;
            member.matchStatus = 'matched';
            member.confidence = 100;

            // Close modal and show success
            closeManualMatchModal();
            alert('匹配成功！\n\n会员: ' + member.name + '\n已匹配到: ' + selectedPlanetUserName + ' (ID: ' + selectedPlanetUserId + ')');

            // If detail drawer is open, refresh it
            if (document.getElementById('memberDetailDrawer').classList.contains('active')) {
                viewMemberDetail(currentMemberId);
            }
        }

        // Export member list
        function exportMemberList() {
            alert('导出会员列表\n\n格式: Excel (.xlsx)\n包含字段: 星球昵称、星球ID、微信昵称、训练营、支付金额、匹配状态、进群状态\n\n文件已开始下载...');
        }

        // ==========================================
        // Refund Management Functions
        // ==========================================

        // Mock refund data
        const refundData = {
            'R001': {
                id: 'R001',
                memberName: '球球的副业探索',
                planetId: '88455815',
                wechatName: '小球球',
                campName: '21天早起训练营',
                amount: 99,
                checkinDays: 16,
                requiredDays: 15,
                confidence: 100,
                judgment: 'qualified', // qualified, review, unqualified
                status: 'pending', // pending, approved, rejected, success, failed
                checkedDates: [1,2,4,5,6,7,8,9,11,12,13,14,15,16],
                logs: [
                    { icon: '📝', title: '创建退款审核记录', time: '2025-01-22 02:00:00', operator: '系统' },
                    { icon: '🔗', title: '自动匹配成功（置信度100%）', time: '2025-01-22 02:00:01', operator: '系统' },
                    { icon: '✅', title: '系统判断：符合退款条件', time: '2025-01-22 02:00:02', operator: '系统' }
                ]
            },
            'R002': {
                id: 'R002',
                memberName: '爱学习的小明',
                planetId: '88123457',
                wechatName: '学习小明',
                campName: '21天早起训练营',
                amount: 99,
                checkinDays: 14,
                requiredDays: 15,
                confidence: 66,
                judgment: 'review',
                status: 'pending',
                checkedDates: [1,2,3,4,5,6,7,8,9,10,11,12,13,14],
                logs: [
                    { icon: '📝', title: '创建退款审核记录', time: '2025-01-22 02:00:00', operator: '系统' },
                    { icon: '🔗', title: '自动匹配成功（置信度66%）', time: '2025-01-22 02:00:01', operator: '系统' },
                    { icon: '⚠️', title: '系统判断：需人工确认', time: '2025-01-22 02:00:02', operator: '系统' }
                ]
            },
            'R003': {
                id: 'R003',
                memberName: '坚持运动',
                planetId: '88654321',
                wechatName: '运动达人',
                campName: '21天早起训练营',
                amount: 99,
                checkinDays: 18,
                requiredDays: 15,
                confidence: 100,
                judgment: 'qualified',
                status: 'pending',
                checkedDates: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18],
                logs: [
                    { icon: '📝', title: '创建退款审核记录', time: '2025-01-22 02:00:00', operator: '系统' },
                    { icon: '🔗', title: '自动匹配成功（置信度100%）', time: '2025-01-22 02:00:01', operator: '系统' },
                    { icon: '✅', title: '系统判断：符合退款条件', time: '2025-01-22 02:00:02', operator: '系统' }
                ]
            },
            'R004': {
                id: 'R004',
                memberName: '努力工作',
                planetId: '88111222',
                wechatName: '工作狂',
                campName: '21天早起训练营',
                amount: 99,
                checkinDays: 10,
                requiredDays: 15,
                confidence: 100,
                judgment: 'unqualified',
                status: 'pending',
                checkedDates: [1,2,3,4,5,6,7,8,9,10],
                logs: [
                    { icon: '📝', title: '创建退款审核记录', time: '2025-01-22 02:00:00', operator: '系统' },
                    { icon: '🔗', title: '自动匹配成功（置信度100%）', time: '2025-01-22 02:00:01', operator: '系统' },
                    { icon: '❌', title: '系统判断：不符合退款条件', time: '2025-01-22 02:00:02', operator: '系统' }
                ]
            }
        };

        // Current refund ID for operations
        let currentRefundId = null;
        let selectedRefundIds = [];

        // Switch refund tab
        function switchRefundTab(element, tabName) {
            // Update tab buttons
            document.querySelectorAll('#refundsPage .page-nav-item').forEach(tab => {
                tab.classList.remove('active');
            });
            element.classList.add('active');

            // Update tab content
            document.querySelectorAll('.refund-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById('refund-tab-' + tabName).classList.add('active');
        }

        // Filter pending refunds
        function filterRefunds() {
            const campFilter = document.getElementById('refundCampFilter').value;
            const confidenceFilter = document.getElementById('refundConfidenceFilter').value;
            const judgmentFilter = document.getElementById('refundJudgmentFilter').value;

            const rows = document.querySelectorAll('#refundPendingBody tr');
            rows.forEach(row => {
                const judgment = row.dataset.judgment;

                let show = true;
                if (judgmentFilter && judgment !== judgmentFilter) show = false;

                row.style.display = show ? '' : 'none';
            });

            updateRefundSelection();
        }

        // Toggle select all refunds
        function toggleSelectAllRefunds() {
            const selectAll = document.getElementById('refundSelectAll');
            const checkboxes = document.querySelectorAll('#refundPendingBody input[type="checkbox"]');

            checkboxes.forEach(cb => {
                const row = cb.closest('tr');
                if (row.style.display !== 'none') {
                    cb.checked = selectAll.checked;
                }
            });

            updateRefundSelection();
        }

        // Update refund selection state
        function updateRefundSelection() {
            const checkboxes = document.querySelectorAll('#refundPendingBody input[type="checkbox"]:checked');
            selectedRefundIds = Array.from(checkboxes).map(cb => cb.value);

            // Update select all checkbox
            const allCheckboxes = document.querySelectorAll('#refundPendingBody input[type="checkbox"]');
            const visibleCheckboxes = Array.from(allCheckboxes).filter(cb => cb.closest('tr').style.display !== 'none');
            const checkedVisible = visibleCheckboxes.filter(cb => cb.checked);

            const selectAll = document.getElementById('refundSelectAll');
            selectAll.checked = visibleCheckboxes.length > 0 && checkedVisible.length === visibleCheckboxes.length;
            selectAll.indeterminate = checkedVisible.length > 0 && checkedVisible.length < visibleCheckboxes.length;
        }

        // Batch approve refunds
        function batchApproveRefunds() {
            if (selectedRefundIds.length === 0) {
                alert('请先选择要审核的退款记录');
                return;
            }

            if (!confirm(`确定批量通过 ${selectedRefundIds.length} 条退款申请吗？\n\n审核通过后将自动发起退款`)) {
                return;
            }

            // Show progress modal
            showBatchProgress('approve', selectedRefundIds.length);
        }

        // Batch reject refunds
        function batchRejectRefunds() {
            if (selectedRefundIds.length === 0) {
                alert('请先选择要拒绝的退款记录');
                return;
            }

            // Open reject modal for batch
            currentRefundId = 'batch';
            document.getElementById('rejectReasonModal').classList.add('active');
        }

        // Show batch progress
        function showBatchProgress(action, total) {
            const modal = document.getElementById('batchProgressModal');
            const icon = document.getElementById('batchProgressIcon');
            const title = document.getElementById('batchProgressTitle');
            const desc = document.getElementById('batchProgressDesc');
            const bar = document.getElementById('batchProgressBar');
            const current = document.getElementById('batchProgressCurrent');
            const totalEl = document.getElementById('batchProgressTotal');

            icon.textContent = '⏳';
            title.textContent = action === 'approve' ? '正在处理退款...' : '正在拒绝退款...';
            desc.textContent = '请稍候，正在逐条执行操作';
            bar.style.width = '0%';
            current.textContent = '0';
            totalEl.textContent = total;

            modal.classList.add('active');

            // Simulate progress
            let processed = 0;
            const interval = setInterval(() => {
                processed++;
                const percent = (processed / total) * 100;
                bar.style.width = percent + '%';
                current.textContent = processed;

                if (processed >= total) {
                    clearInterval(interval);
                    setTimeout(() => {
                        icon.textContent = '✅';
                        title.textContent = '处理完成！';
                        desc.textContent = `成功处理 ${total} 条退款记录`;

                        setTimeout(() => {
                            modal.classList.remove('active');
                            alert(`批量操作完成！\n\n成功: ${total} 条\n失败: 0 条`);
                            // Reset selection
                            document.getElementById('refundSelectAll').checked = false;
                            document.querySelectorAll('#refundPendingBody input[type="checkbox"]').forEach(cb => cb.checked = false);
                            updateRefundSelection();
                        }, 1500);
                    }, 500);
                }
            }, 300);
        }

        // Approve single refund
        function approveRefund(refundId) {
            if (!confirm('确定审核通过此退款申请吗？\n\n审核通过后将自动发起退款')) {
                return;
            }

            alert(`退款审核通过！\n\n退款ID: ${refundId}\n状态: 已提交退款\n预计到账: 1-3个工作日`);
            closeRefundDetailDrawer();
        }

        // Open reject modal
        function openRejectModal(refundId) {
            currentRefundId = refundId;
            document.getElementById('rejectReasonInput').value = '';
            document.getElementById('rejectReasonModal').classList.add('active');
        }

        // Close reject modal
        function closeRejectModal() {
            document.getElementById('rejectReasonModal').classList.remove('active');
            currentRefundId = null;
        }

        // Set reject reason from quick button
        function setRejectReason(reason) {
            document.getElementById('rejectReasonInput').value = reason;
        }

        // Confirm reject
        function confirmReject() {
            const reason = document.getElementById('rejectReasonInput').value.trim();
            if (!reason) {
                alert('请输入拒绝理由');
                return;
            }

            if (currentRefundId === 'batch') {
                // Batch reject
                closeRejectModal();
                showBatchProgress('reject', selectedRefundIds.length);
            } else {
                // Single reject
                alert(`退款已拒绝！\n\n退款ID: ${currentRefundId}\n拒绝理由: ${reason}`);
                closeRejectModal();
                closeRefundDetailDrawer();
            }
        }

        // View refund detail
        function viewRefundDetail(refundId) {
            currentRefundId = refundId;
            const refund = refundData[refundId];

            if (refund) {
                // Update member info
                document.getElementById('refundMemberAvatar').textContent = refund.memberName.charAt(0);
                document.getElementById('refundMemberName').textContent = refund.memberName;
                document.getElementById('refundMemberPlanetId').textContent = refund.planetId;
                document.getElementById('refundMemberWechatName').textContent = refund.wechatName;

                // Update confidence
                const confidenceEl = document.getElementById('refundMemberConfidence');
                confidenceEl.textContent = refund.confidence + '%';
                confidenceEl.className = refund.confidence === 100 ? 'confidence-high' :
                                        refund.confidence >= 66 ? 'confidence-medium' : 'confidence-low';

                // Update camp & checkin info
                document.getElementById('refundCampName').textContent = refund.campName;
                document.getElementById('refundAmount').textContent = '¥' + refund.amount.toFixed(2);
                document.getElementById('refundRequirement').textContent = `21天${refund.requiredDays}打卡`;
                document.getElementById('refundActualCheckin').textContent = refund.checkinDays + '天';

                // Update judgment box
                const judgmentBox = document.getElementById('refundJudgmentBox');
                const judgmentTitle = document.getElementById('refundJudgmentTitle');
                const judgmentDesc = document.getElementById('refundJudgmentDesc');

                if (refund.judgment === 'qualified') {
                    judgmentBox.style.background = 'rgba(63, 185, 80, 0.1)';
                    judgmentBox.style.borderColor = 'var(--accent-green)';
                    judgmentBox.querySelector('div:first-child').textContent = '✅';
                    judgmentTitle.style.color = 'var(--accent-green)';
                    judgmentTitle.textContent = '符合退款条件';
                    judgmentDesc.textContent = `打卡天数（${refund.checkinDays}天）≥ 要求天数（${refund.requiredDays}天），建议审核通过`;
                } else if (refund.judgment === 'review') {
                    judgmentBox.style.background = 'rgba(227, 179, 65, 0.1)';
                    judgmentBox.style.borderColor = 'var(--accent-orange)';
                    judgmentBox.querySelector('div:first-child').textContent = '⚠️';
                    judgmentTitle.style.color = 'var(--accent-orange)';
                    judgmentTitle.textContent = '需人工确认';
                    judgmentDesc.textContent = `打卡天数（${refund.checkinDays}天）接近要求天数（${refund.requiredDays}天），请人工核实`;
                } else {
                    judgmentBox.style.background = 'rgba(248, 81, 73, 0.1)';
                    judgmentBox.style.borderColor = 'var(--accent-red)';
                    judgmentBox.querySelector('div:first-child').textContent = '❌';
                    judgmentTitle.style.color = 'var(--accent-red)';
                    judgmentTitle.textContent = '不符合退款条件';
                    judgmentDesc.textContent = `打卡天数（${refund.checkinDays}天）< 要求天数（${refund.requiredDays}天），建议拒绝`;
                }

                // Update operation logs
                const logContainer = document.getElementById('refundOperationLog');
                logContainer.innerHTML = refund.logs.map(log => `
                    <div class="log-item">
                        <div class="log-icon">${log.icon}</div>
                        <div class="log-content">
                            <div class="log-title">${log.title}</div>
                            <div class="log-meta">${log.operator} · ${log.time}</div>
                        </div>
                    </div>
                `).join('');

                // Show/hide action buttons based on status
                const footer = document.getElementById('refundDetailFooter');
                const approveBtn = document.getElementById('refundApproveBtn');
                const rejectBtn = document.getElementById('refundRejectBtn');

                if (refund.status === 'pending') {
                    approveBtn.style.display = '';
                    rejectBtn.style.display = '';
                } else {
                    approveBtn.style.display = 'none';
                    rejectBtn.style.display = 'none';
                }
            }

            document.getElementById('refundDetailDrawer').classList.add('active');
        }

        // Close refund detail drawer
        function closeRefundDetailDrawer() {
            document.getElementById('refundDetailDrawer').classList.remove('active');
            currentRefundId = null;
        }

        // Filter refund records
        function filterRefundRecords() {
            const status = document.getElementById('recordStatusFilter').value;
            const rows = document.querySelectorAll('#refundRecordsBody tr');

            rows.forEach(row => {
                const rowStatus = row.dataset.status;
                const show = !status || rowStatus === status;
                row.style.display = show ? '' : 'none';
            });
        }

        // Reset record filters
        function resetRecordFilters() {
            document.getElementById('recordCampFilter').value = '';
            document.getElementById('recordStatusFilter').value = '';
            document.getElementById('recordStartDate').value = '';
            document.getElementById('recordEndDate').value = '';

            const rows = document.querySelectorAll('#refundRecordsBody tr');
            rows.forEach(row => row.style.display = '');
        }

        // Retry refund
        function retryRefund(recordId) {
            if (confirm(`确定重试退款吗？\n\n记录ID: ${recordId}\n系统将再次尝试发起退款`)) {
                alert(`重试退款已提交！\n\n记录ID: ${recordId}\n状态: 退款处理中\n\n请稍后刷新查看结果`);
            }
        }

        // View refund record detail
        function viewRefundRecordDetail(recordId) {
            alert(`查看退款记录详情\n\n记录ID: ${recordId}\n\n此功能与退款详情抽屉复用，显示完整的退款处理历史`);
        }

        // Export refund records
        function exportRefundRecords() {
            alert('导出退款记录\n\n格式: Excel (.xlsx)\n包含字段: 会员信息、训练营、退款金额、审核时间、审核人、退款状态\n\n文件已开始下载...');
        }

        // ==================== System Management Functions ====================

        // User data
        const userData = {
            'U001': { username: 'admin', role: 'super_admin', status: 'enabled', createdAt: '2024-01-01' },
            'U002': { username: 'manager01', role: 'admin', status: 'enabled', createdAt: '2024-03-15' },
            'U003': { username: 'coach_zhang', role: 'coach', status: 'enabled', createdAt: '2024-06-01' },
            'U004': { username: 'volunteer_li', role: 'volunteer', status: 'disabled', createdAt: '2024-09-01' },
            'U005': { username: 'coach_li', role: 'coach', status: 'enabled', createdAt: '2024-08-15' }
        };

        let currentEditUserId = null;
        let currentDeleteUserId = null;

        // Switch system tab
        function switchSystemTab(element, tabName) {
            // Update tab nav
            document.querySelectorAll('#systemPage .page-nav-item').forEach(item => {
                item.classList.remove('active');
            });
            element.classList.add('active');

            // Update tab content
            document.querySelectorAll('.system-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById('system-tab-' + tabName).classList.add('active');
        }

        // Open add user modal
        function openAddUserModal() {
            currentEditUserId = null;
            document.getElementById('userModalTitle').textContent = '添加用户';
            document.getElementById('userUsername').value = '';
            document.getElementById('userUsername').disabled = false;
            document.getElementById('userPassword').value = '';
            document.getElementById('userConfirmPassword').value = '';
            document.getElementById('userRole').value = '';
            document.getElementById('passwordField').style.display = 'block';
            document.getElementById('confirmPasswordField').style.display = 'block';

            // Reset radio buttons
            document.querySelectorAll('input[name="userStatus"]').forEach(radio => {
                radio.checked = radio.value === 'enabled';
            });
            document.querySelectorAll('#userModal .radio-item').forEach(item => {
                item.classList.toggle('active', item.querySelector('input').checked);
            });

            document.getElementById('userModal').classList.add('active');
        }

        // Open edit user modal
        function openEditUserModal(userId) {
            currentEditUserId = userId;
            const user = userData[userId];

            document.getElementById('userModalTitle').textContent = '编辑用户';
            document.getElementById('userUsername').value = user.username;
            document.getElementById('userUsername').disabled = true;
            document.getElementById('userRole').value = user.role === 'super_admin' ? '' : user.role;
            document.getElementById('passwordField').style.display = 'none';
            document.getElementById('confirmPasswordField').style.display = 'none';

            // Set status radio
            document.querySelectorAll('input[name="userStatus"]').forEach(radio => {
                radio.checked = radio.value === user.status;
            });
            document.querySelectorAll('#userModal .radio-item').forEach(item => {
                item.classList.toggle('active', item.querySelector('input').checked);
            });

            // Disable role selection for super admin
            document.getElementById('userRole').disabled = user.role === 'super_admin';

            document.getElementById('userModal').classList.add('active');
        }

        // Close user modal
        function closeUserModal() {
            document.getElementById('userModal').classList.remove('active');
            currentEditUserId = null;
        }

        // Save user
        function saveUser() {
            const username = document.getElementById('userUsername').value.trim();
            const role = document.getElementById('userRole').value;
            const status = document.querySelector('input[name="userStatus"]:checked').value;

            if (!currentEditUserId) {
                // Creating new user
                const password = document.getElementById('userPassword').value;
                const confirmPassword = document.getElementById('userConfirmPassword').value;

                if (!username) {
                    alert('请输入用户名');
                    return;
                }
                if (!password || password.length < 6) {
                    alert('密码长度至少6位');
                    return;
                }
                if (password !== confirmPassword) {
                    alert('两次输入的密码不一致');
                    return;
                }
                if (!role) {
                    alert('请选择角色');
                    return;
                }

                alert(`创建用户成功！\n\n用户名: ${username}\n角色: ${getRoleName(role)}\n状态: ${status === 'enabled' ? '启用' : '禁用'}`);
            } else {
                // Editing existing user
                const user = userData[currentEditUserId];
                alert(`更新用户成功！\n\n用户名: ${user.username}\n角色: ${getRoleName(role || user.role)}\n状态: ${status === 'enabled' ? '启用' : '禁用'}`);
            }

            closeUserModal();
        }

        // Get role display name
        function getRoleName(role) {
            const roleNames = {
                'super_admin': '超级管理员',
                'admin': '管理员',
                'coach': '教练',
                'volunteer': '志愿者'
            };
            return roleNames[role] || role;
        }

        // Toggle user status
        function toggleUserStatus(userId, action) {
            const user = userData[userId];
            const newStatus = action === 'enable' ? '启用' : '禁用';

            if (confirm(`确定要${newStatus}用户 ${user.username} 吗？`)) {
                alert(`用户 ${user.username} 已${newStatus}`);
                // In real implementation, would update the table row
            }
        }

        // Delete user
        function deleteUser(userId) {
            currentDeleteUserId = userId;
            const user = userData[userId];
            document.getElementById('deleteUsername').textContent = user.username;
            document.getElementById('deleteConfirmModal').classList.add('active');
        }

        // Close delete confirm modal
        function closeDeleteConfirmModal() {
            document.getElementById('deleteConfirmModal').classList.remove('active');
            currentDeleteUserId = null;
        }

        // Confirm delete user
        function confirmDeleteUser() {
            if (currentDeleteUserId) {
                const user = userData[currentDeleteUserId];
                alert(`用户 ${user.username} 已删除`);
                closeDeleteConfirmModal();
            }
        }

        // Reset password
        function resetUserPassword(userId) {
            const user = userData[userId];
            const newPassword = generateRandomPassword();

            document.getElementById('resetPasswordUsername').textContent = user.username;
            document.getElementById('newPasswordDisplay').textContent = newPassword;
            document.getElementById('resetPasswordModal').classList.add('active');
        }

        // Generate random password
        function generateRandomPassword() {
            const chars = 'ABCDEFGHJKMNPQRSTUVWXYZabcdefghjkmnpqrstuvwxyz23456789';
            let password = '';
            for (let i = 0; i < 8; i++) {
                password += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return password;
        }

        // Close reset password modal
        function closeResetPasswordModal() {
            document.getElementById('resetPasswordModal').classList.remove('active');
        }

        // Copy new password
        function copyNewPassword() {
            const password = document.getElementById('newPasswordDisplay').textContent;
            navigator.clipboard.writeText(password).then(() => {
                alert('密码已复制到剪贴板');
            }).catch(() => {
                alert('复制失败，请手动复制');
            });
        }

        // Toggle password visibility
        function togglePasswordVisibility(inputId, button) {
            const input = document.getElementById(inputId);
            if (input.type === 'password') {
                input.type = 'text';
                button.textContent = '隐藏';
            } else {
                input.type = 'password';
                button.textContent = '显示';
            }
        }

        // Copy to clipboard
        function copyToClipboard(inputId) {
            const input = document.getElementById(inputId);
            navigator.clipboard.writeText(input.value).then(() => {
                alert('已复制到剪贴板');
            }).catch(() => {
                alert('复制失败');
            });
        }

        // Test ZSXQ connection
        function testZsxqConnection() {
            showApiTestModal('知识星球 API 测试');

            // Simulate API test
            setTimeout(() => {
                updateApiTestResult(true, {
                    time: '156ms',
                    endpoint: 'https://api.zsxq.com/v2/groups/...',
                    data: '{"succeeded": true, "resp_data": {"name": "知识星球训练营"}}'
                });
            }, 1500);
        }

        // Test WeChat connection
        function testWechatConnection() {
            showApiTestModal('企业微信 API 测试');

            // Simulate API test
            setTimeout(() => {
                updateApiTestResult(true, {
                    time: '89ms',
                    endpoint: 'https://qyapi.weixin.qq.com/cgi-bin/...',
                    data: '{"errcode": 0, "errmsg": "ok"}'
                });
            }, 1200);
        }

        // Show API test modal
        function showApiTestModal(title) {
            document.getElementById('apiTestTitle').textContent = title;
            document.getElementById('apiTestIcon').textContent = '⏳';
            document.getElementById('apiTestStatus').textContent = '正在测试...';
            document.getElementById('apiTestMessage').textContent = '请稍候，正在连接API服务';
            document.getElementById('apiTestDetails').style.display = 'none';
            document.getElementById('apiTestModal').classList.add('active');
        }

        // Update API test result
        function updateApiTestResult(success, details) {
            if (success) {
                document.getElementById('apiTestIcon').textContent = '✅';
                document.getElementById('apiTestStatus').textContent = '连接成功';
                document.getElementById('apiTestStatus').style.color = 'var(--accent-green)';
                document.getElementById('apiTestMessage').textContent = 'API服务正常运行';
            } else {
                document.getElementById('apiTestIcon').textContent = '❌';
                document.getElementById('apiTestStatus').textContent = '连接失败';
                document.getElementById('apiTestStatus').style.color = 'var(--accent-red)';
                document.getElementById('apiTestMessage').textContent = details.error || '无法连接到API服务';
            }

            if (details) {
                document.getElementById('apiTestTime').textContent = details.time || '-';
                document.getElementById('apiTestEndpoint').textContent = details.endpoint || '-';
                document.getElementById('apiTestData').textContent = details.data || '-';
                document.getElementById('apiTestDetails').style.display = 'block';
            }
        }

        // Close API test modal
        function closeApiTestModal() {
            document.getElementById('apiTestModal').classList.remove('active');
            document.getElementById('apiTestStatus').style.color = '';
        }

        // Save ZSXQ config
        function saveZsxqConfig() {
            const groupId = document.getElementById('zsxqGroupId').value;
            const cookie = document.getElementById('zsxqCookie').value;

            if (!groupId || !cookie) {
                alert('请填写必填项');
                return;
            }

            alert('知识星球配置已保存');
        }

        // Save WeChat config
        function saveWechatConfig() {
            const corpId = document.getElementById('wechatCorpId').value;
            const secret = document.getElementById('wechatSecret').value;
            const mchId = document.getElementById('wechatMchId').value;
            const payKey = document.getElementById('wechatPayKey').value;

            if (!corpId || !secret || !mchId || !payKey) {
                alert('请填写必填项');
                return;
            }

            alert('企业微信配置已保存');
        }

        // Toggle notify setting
        function toggleNotifySetting(type) {
            const checkbox = document.getElementById(type === 'appMsg' ? 'notifyAppMsg' : 'notifyGroupBot');
            const status = checkbox.checked ? '已开启' : '已关闭';
            const name = type === 'appMsg' ? '企业微信应用消息' : '群机器人通知';
            console.log(`${name} ${status}`);
        }

        // Test notification
        function testNotification() {
            alert('测试消息已发送！\n\n请检查企业微信是否收到测试通知\n\n消息内容：【系统测试】这是一条测试消息，用于验证通知功能是否正常');
        }

        // Save notify config
        function saveNotifyConfig() {
            alert('通知配置已保存');
        }

        // Save other config
        function saveOtherConfig() {
            const graceDays = document.getElementById('graceDays').value;
            const dataRetention = document.getElementById('dataRetention').value;

            alert(`其他设置已保存\n\n打卡宽限天数: ${graceDays}天\n数据保留期限: ${dataRetention}天`);
        }

        // Filter operation logs
        function filterOperationLogs() {
            const userFilter = document.getElementById('logUserFilter').value;
            const typeFilter = document.getElementById('logTypeFilter').value;
            const keyword = document.getElementById('logKeyword').value.toLowerCase();

            const rows = document.querySelectorAll('#logTableBody tr');

            rows.forEach(row => {
                const user = row.dataset.user;
                const type = row.dataset.type;
                const content = row.textContent.toLowerCase();

                const matchUser = !userFilter || user === userFilter;
                const matchType = !typeFilter || type === typeFilter;
                const matchKeyword = !keyword || content.includes(keyword);

                row.style.display = (matchUser && matchType && matchKeyword) ? '' : 'none';
            });
        }

        // Reset log filters
        function resetLogFilters() {
            document.getElementById('logUserFilter').value = '';
            document.getElementById('logTypeFilter').value = '';
            document.getElementById('logStartDate').value = '';
            document.getElementById('logEndDate').value = '';
            document.getElementById('logKeyword').value = '';

            const rows = document.querySelectorAll('#logTableBody tr');
            rows.forEach(row => row.style.display = '');
        }

        // Export operation logs
        function exportOperationLogs() {
            alert('导出操作日志\n\n格式: Excel (.xlsx)\n包含字段: 操作时间、操作人、操作类型、操作内容、IP地址\n\n文件已开始下载...');
        }
    </script>
</body>
</html>
