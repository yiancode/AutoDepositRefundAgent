# v1 版本开发前准备清单

**创建时间**: 2025-11-02
**版本**: v1.0 完整生产级系统
**预计开发周期**: 30 天（1 个月）

---

## 📋 清单概览

| 类别 | 项目数 | 优先级 | 预计准备时间 |
|------|--------|--------|-------------|
| 🔐 微信支付配置 | 3 项 | ⭐⭐⭐ 必须 | 30 分钟 |
| 🌐 服务器环境 | 5 项 | ⭐⭐⭐ 必须 | 1-2 天（购买+配置） |
| 💾 数据库环境 | 2 项 | ⭐⭐⭐ 必须 | 1 小时 |
| 🔧 开发工具 | 4 项 | ⭐⭐⭐ 必须 | 2 小时 |
| 📦 第三方服务 | 3 项 | ⭐⭐ 推荐 | 1 小时 |
| 📝 业务数据 | 2 项 | ⭐⭐ 推荐 | 提前准备 |
| 🎨 UI资源 | 3 项 | ⭐ 可选 | 1-2 天（设计） |

**总计准备时间**: 3-5 天（含服务器采购和设计资源）

---

## 🔐 一、微信支付配置（必须，30分钟）

### ✅ 您已确认拥有的信息

根据您提供的商户平台截图，您已经有：
- ✅ 正式微信支付商户号
- ✅ 已开通 JSAPI 支付、Native 支付
- ✅ 有 API 安全配置权限

### 📦 需要获取的 3 项配置

#### 1.1 商户号 (MCHID)

**获取路径**:
```
登录 https://pay.weixin.qq.com
→ 账户中心 → 商户信息
→ 复制"商户号"（10位数字）
```

**示例**: `1234567890`

**用途**: 所有微信支付 API 调用的身份标识

---

#### 1.2 API 证书（重要！）

**获取路径**:
```
登录 https://pay.weixin.qq.com
→ 账户中心 → API安全 → 申请API证书
→ 下载"证书工具"（Windows/Mac）
→ 输入商户号 → 扫码验证
→ 自动生成 3 个文件
```

**需要的文件**:
- `apiclient_cert.pem` - 商户 API 证书（公钥）
- `apiclient_key.pem` - 商户私钥（⚠️ 极其重要）
- 证书序列号 - 配置时需要填写（工具会显示）

**存储位置**:
- 开发环境: `backend/src/main/resources/certs/`
- 生产环境: 服务器 `/opt/camp/certs/`（权限 600）

**安全提醒**:
- ❌ 绝对不能提交到 Git
- ❌ 不能通过邮件/聊天发送
- ✅ 使用加密压缩包传输
- ✅ 服务器文件权限设为 600

---

#### 1.3 API v3 密钥

**获取路径**:
```
登录 https://pay.weixin.qq.com
→ 账户中心 → API安全 → 设置APIv3密钥
→ 输入 32 位字符串（自定义）
→ 保存（⚠️ 只显示一次！）
```

**生成方式**:
```bash
# macOS/Linux 命令行生成
openssl rand -base64 32 | head -c 32

# 或使用在线工具
https://www.random.org/strings/
```

**示例**: `a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6`

**用途**: API 请求签名和响应解密

---

### ✅ 准备完成检查

- [ ] 商户号: `___________` 已复制
- [ ] API 证书: `apiclient_cert.pem` 和 `apiclient_key.pem` 已下载
- [ ] 证书序列号: `___________` 已复制
- [ ] API v3 密钥: 已设置 32 位密钥

---

## 🌐 二、服务器环境（必须，1-2天）

### 2.1 服务器配置推荐

#### 方案 A: 单服务器部署（小规模，推荐起步）

**配置**:
- CPU: 2 核
- 内存: 4 GB
- 硬盘: 40 GB SSD
- 带宽: 3 Mbps
- 操作系统: Ubuntu 22.04 LTS / CentOS 8

**适用场景**:
- 同时在线用户 < 100 人
- 训练营数量 < 10 个
- 日交易量 < 500 笔

**成本**: 约 ¥100-150/月（阿里云/腾讯云轻量服务器）

**服务部署**:
```
同一台服务器：
- Java 应用（Spring Boot）
- PostgreSQL 数据库
- Redis 缓存
- Nginx 反向代理
```

---

#### 方案 B: 分布式部署（中大规模）

**配置**:
- **应用服务器**: 2核4GB × 1台（可扩展）
- **数据库服务器**: 2核4GB × 1台（或使用云数据库）
- **Redis服务器**: 1核2GB × 1台（或使用云 Redis）
- **对象存储**: 腾讯云 COS / 阿里云 OSS

**适用场景**:
- 同时在线用户 > 100 人
- 训练营数量 > 10 个
- 高可用要求

**成本**: 约 ¥400-600/月

---

### 2.2 域名和 SSL 证书

#### 2.2.1 域名（必须）

**用途**:
- H5 会员端: `https://camp.yourdomain.com`
- 管理后台: `https://admin-camp.yourdomain.com`
- API 接口: `https://api-camp.yourdomain.com`

**购买渠道**: 阿里云/腾讯云/GoDaddy

**成本**: 约 ¥50-100/年（.com 域名）

**备案**:
- ⚠️ 服务器在中国大陆必须备案
- ⚠️ 备案时间约 10-20 天
- ✅ 如不备案，可选择香港/海外服务器

---

#### 2.2.2 SSL 证书（必须）

**用途**: HTTPS 加密（微信支付强制要求 HTTPS）

**获取方式**:
- **免费**: Let's Encrypt（有效期 90 天，可自动续期）
- **付费**: 阿里云/腾讯云 SSL 证书（约 ¥1000/年）

**推荐**: 使用 Let's Encrypt + Certbot 自动续期

---

### 2.3 服务器软件环境

#### 需要安装的软件

| 软件 | 版本 | 用途 |
|------|------|------|
| **Java JDK** | 17+ | 运行 Spring Boot |
| **Maven** | 3.8+ | 构建项目 |
| **PostgreSQL** | 15+ | 数据库 |
| **Redis** | 7.x | 缓存和会话管理 |
| **Nginx** | 1.24+ | 反向代理和静态资源 |
| **Git** | 2.x | 代码管理 |
| **Node.js** | 18+ | 前端构建（可选，本地构建后上传） |

#### 安装命令（Ubuntu）

```bash
# 更新系统
sudo apt update && sudo apt upgrade -y

# 安装 Java 17
sudo apt install openjdk-17-jdk -y
java -version

# 安装 Maven
sudo apt install maven -y
mvn -version

# 安装 PostgreSQL
sudo apt install postgresql postgresql-contrib -y
sudo systemctl enable postgresql
sudo systemctl start postgresql

# 安装 Redis
sudo apt install redis-server -y
sudo systemctl enable redis-server
sudo systemctl start redis-server

# 安装 Nginx
sudo apt install nginx -y
sudo systemctl enable nginx
sudo systemctl start nginx

# 安装 Git
sudo apt install git -y
```

---

### ✅ 准备完成检查

- [ ] 服务器已购买（配置: ___核___GB）
- [ ] 操作系统: ___________ 已安装
- [ ] 域名已购买: ___________
- [ ] 域名已备案（或选择海外服务器）
- [ ] SSL 证书已获取
- [ ] Java、PostgreSQL、Redis、Nginx 已安装

---

## 💾 三、数据库环境（必须，1小时）

### 3.1 PostgreSQL 数据库

#### 3.1.1 创建数据库

```bash
# 切换到 postgres 用户
sudo -i -u postgres

# 创建数据库
createdb camp_db

# 创建用户并设置密码
psql
CREATE USER camp_user WITH PASSWORD 'your_strong_password';
GRANT ALL PRIVILEGES ON DATABASE camp_db TO camp_user;
ALTER DATABASE camp_db OWNER TO camp_user;
\q
exit
```

#### 3.1.2 配置远程访问（可选）

```bash
# 编辑 PostgreSQL 配置
sudo nano /etc/postgresql/15/main/postgresql.conf

# 修改监听地址
listen_addresses = '*'

# 编辑访问控制
sudo nano /etc/postgresql/15/main/pg_hba.conf

# 添加远程访问规则
host    all             all             0.0.0.0/0            md5

# 重启 PostgreSQL
sudo systemctl restart postgresql
```

#### 3.1.3 导入初始化 SQL

```bash
# 导入数据库结构（开发阶段由 MyBatis Plus 自动创建）
psql -U camp_user -d camp_db -f /path/to/init-database.sql
```

---

### 3.2 Redis 配置

#### 3.2.1 配置密码

```bash
# 编辑 Redis 配置
sudo nano /etc/redis/redis.conf

# 设置密码
requirepass your_redis_password

# 重启 Redis
sudo systemctl restart redis-server
```

#### 3.2.2 测试连接

```bash
redis-cli
AUTH your_redis_password
PING
# 应返回 PONG
```

---

### ✅ 准备完成检查

- [ ] PostgreSQL 数据库 `camp_db` 已创建
- [ ] 数据库用户 `camp_user` 已创建，密码: ___________
- [ ] Redis 已配置密码: ___________
- [ ] 数据库连接测试通过

---

## 🔧 四、开发工具（必须，2小时）

### 4.1 后端开发工具

| 工具 | 版本 | 用途 |
|------|------|------|
| **IntelliJ IDEA** | 2023.3+ | Java 开发（推荐 Ultimate 版） |
| **Maven** | 3.8+ | 依赖管理 |
| **Postman** | 最新版 | API 测试 |
| **DBeaver** | 最新版 | 数据库管理 |

**IntelliJ IDEA 插件推荐**:
- Lombok
- MyBatis Plus
- Alibaba Java Coding Guidelines
- GitToolBox

---

### 4.2 前端开发工具

| 工具 | 版本 | 用途 |
|------|------|------|
| **Node.js** | 18+ | 运行环境 |
| **pnpm** | 8.x | 包管理器（推荐，比 npm 快） |
| **VS Code** | 最新版 | 前端开发 |

**VS Code 插件推荐**:
- Volar（Vue 3）
- ESLint
- Prettier
- Auto Rename Tag
- GitLens

---

### 4.3 安装命令

#### macOS

```bash
# 安装 Homebrew（如果没有）
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

# 安装 Java 17
brew install openjdk@17

# 安装 Maven
brew install maven

# 安装 Node.js
brew install node@18

# 安装 pnpm
npm install -g pnpm

# 安装 PostgreSQL（本地开发）
brew install postgresql@15
brew services start postgresql@15

# 安装 Redis（本地开发）
brew install redis
brew services start redis
```

#### Windows

```powershell
# 使用 Chocolatey 包管理器
# 安装 Java 17
choco install openjdk17

# 安装 Maven
choco install maven

# 安装 Node.js
choco install nodejs-lts

# 安装 pnpm
npm install -g pnpm

# 安装 PostgreSQL
choco install postgresql15

# 安装 Redis
choco install redis-64
```

---

### ✅ 准备完成检查

- [ ] IntelliJ IDEA 已安装
- [ ] Maven 已安装: `mvn -version`
- [ ] Node.js 已安装: `node -v` (v18+)
- [ ] pnpm 已安装: `pnpm -v`
- [ ] VS Code 已安装
- [ ] Postman 已安装
- [ ] DBeaver 已安装

---

## 📦 五、第三方服务（推荐，1小时）

### 5.1 对象存储（推荐）

**用途**: 存储训练营海报、群二维码、用户头像

**推荐服务**:
- 腾讯云 COS（按量付费）
- 阿里云 OSS（按量付费）

**成本**: 约 ¥5-20/月（1000 人训练营）

**配置**:
```yaml
# application.yml
cloud:
  storage:
    type: tencent-cos  # 或 aliyun-oss
    bucket: your-bucket-name
    region: ap-guangzhou
    secret-id: xxx
    secret-key: xxx
```

---

### 5.2 企业微信应用（可选）

**用途**:
- 发送打卡提醒
- 发送退款通知
- 群机器人消息

**申请流程**:
```
1. 登录企业微信管理后台
2. 应用管理 → 应用 → 创建应用
3. 获取 AgentId 和 Secret
4. 配置可信域名
```

---

### 5.3 短信服务（可选）

**用途**: 发送支付成功短信、打卡提醒短信

**推荐服务**: 阿里云短信 / 腾讯云短信

**成本**: 约 ¥0.03-0.05/条

---

### ✅ 准备完成检查

- [ ] 对象存储已开通（Bucket: ___________）
- [ ] 企业微信应用已创建（AgentId: ___________）（可选）
- [ ] 短信服务已开通（可选）

---

## 📝 六、业务数据准备（推荐，提前准备）

### 6.1 知识星球 API 配置

**需要信息**:
- 知识星球 Group ID
- 知识星球 Cookie（x-timestamp, authorization, x-signature）

**获取方式**:
```
1. 浏览器登录知识星球
2. 打开 DevTools → Network
3. 刷新页面，找到 checkins 请求
4. 复制 Request Headers
```

**配置到**:
```yaml
# application.yml
zsxq:
  group-id: 15555411412112
  x-timestamp: 1730000000
  authorization: Bearer xxx
  x-signature: xxx
```

---

### 6.2 初始训练营数据

**准备内容**:
- 训练营名称和简介
- 训练营海报（设计稿）
- 押金金额
- 打卡要求天数
- 训练营时长
- 群二维码

**示例 Excel**:

| 训练营名称 | 押金金额 | 打卡要求 | 时长 | 海报URL |
|-----------|---------|---------|------|---------|
| AI学习营第1期 | 99元 | 7天 | 21天 | https://... |
| 副业探索营第2期 | 199元 | 14天 | 30天 | https://... |

---

### ✅ 准备完成检查

- [ ] 知识星球 API 配置已获取
- [ ] 至少准备 1 个训练营的完整信息

---

## 🎨 七、UI 设计资源（可选，1-2天）

### 7.1 H5 会员端设计

**需要页面**:
1. 训练营列表页（首页）
2. 训练营详情页
3. 支付确认页
4. 支付成功页（显示群二维码）
5. 我的训练营页
6. 打卡进度页

**设计工具**: Figma / Sketch / 即时设计

**参考**: Vant UI 组件库风格

---

### 7.2 管理后台设计

**需要页面**:
1. 登录页
2. 仪表盘（数据概览）
3. 训练营管理页
4. 会员管理页
5. 退款审核页
6. 数据报表页

**设计工具**: Element Plus 组件库风格

**参考**: Vue Element Admin

---

### 7.3 素材准备

**需要资源**:
- Logo（应用图标）
- 训练营海报模板
- 群二维码
- 默认头像
- 空状态插图

---

### ✅ 准备完成检查

- [ ] UI 设计稿已完成（至少核心页面）
- [ ] 素材资源已准备

---

## 📊 八、准备情况总结

### 优先级分级

#### 🔴 P0 - 必须立即准备（开发前）

- [ ] 微信支付商户号配置（3项）
- [ ] API 证书下载
- [ ] 本地开发环境搭建（Java、PostgreSQL、Redis）
- [ ] IntelliJ IDEA / VS Code 安装

**预计时间**: 半天（4小时）

---

#### 🟡 P1 - 开发初期需要（第1周）

- [ ] 服务器购买和配置
- [ ] 域名购买和备案
- [ ] SSL 证书获取
- [ ] 数据库初始化
- [ ] 知识星球 API 配置

**预计时间**: 3-5 天（含备案等待期）

---

#### 🟢 P2 - 开发中期需要（第2-3周）

- [ ] 对象存储开通
- [ ] 企业微信应用配置
- [ ] 初始训练营数据准备
- [ ] UI 设计稿

**预计时间**: 1-2 天

---

## 🎯 开发时间线规划

### 阶段零：准备阶段（3-5天）

**Day 0-1**:
- ✅ 微信支付配置（30分钟）
- ✅ 本地开发环境（2小时）
- ✅ 服务器购买（1小时）

**Day 2-5**:
- ⏳ 域名备案（等待审核，10-20天）
- ✅ 服务器环境配置（1天）
- ✅ 数据库初始化（1小时）

---

### 阶段一：核心功能 MVP（Day 1-16）

**Week 1**:
- 后端框架搭建
- 数据库设计和建表
- 微信支付对接

**Week 2**:
- 知识星球 API 对接
- 会员管理功能
- 支付流程开发

**Week 3**:
- 退款审核功能
- H5 会员端开发

---

### 阶段二：数据统计（Day 17-23）

- 数据报表
- 统计分析
- 导出功能

---

### 阶段三：系统管理（Day 24-30）

- 权限管理
- 系统配置
- 部署上线

---

## 💰 成本预算

| 项目 | 成本 | 周期 |
|------|------|------|
| 服务器（单机） | ¥100-150/月 | 按月 |
| 域名 | ¥50-100/年 | 按年 |
| SSL 证书 | 免费（Let's Encrypt） | - |
| 对象存储 | ¥5-20/月 | 按量 |
| 短信服务 | ¥0.03-0.05/条 | 按量 |
| **总计（首月）** | **约 ¥200-300** | - |

---

## 📞 需要帮助？

如果在准备过程中遇到问题，请告诉我：

1. **服务器选型**: 阿里云还是腾讯云？单机还是分布式？
2. **域名备案**: 需要备案流程指导吗？
3. **数据库设计**: 需要查看完整的 SQL 建表语句吗？
4. **开发规划**: 需要详细的开发任务清单吗？

---

## ✅ 最终检查清单

在开始开发前，请确认：

### 核心配置（必须）

- [ ] 微信支付商户号: ___________
- [ ] API 证书: `apiclient_cert.pem` 和 `apiclient_key.pem`
- [ ] 证书序列号: ___________
- [ ] API v3 密钥: ___________

### 开发环境（必须）

- [ ] Java 17: `java -version`
- [ ] Maven: `mvn -version`
- [ ] PostgreSQL: `psql --version`
- [ ] Redis: `redis-cli ping`
- [ ] Node.js: `node -v`
- [ ] IntelliJ IDEA / VS Code

### 生产环境（P1）

- [ ] 服务器: _____（配置）
- [ ] 域名: ___________
- [ ] 备案状态: ___________
- [ ] SSL 证书: ___________

### 业务数据（P1）

- [ ] 知识星球 API 配置
- [ ] 初始训练营数据

---

**准备完成后，告诉我即可开始 v1 开发！** 🚀